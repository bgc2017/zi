新法算書卷八十明徐光啟等撰
交食表卷九
算時氣差簡法
治歷一書交食為最乃交食中諸法所難者尤在視差西史從天
儀圖以三角形算此常法也間有用表者亦云簡矣然就中所
列非一表所求非一端終不得為簡也刻白爾(第谷友也)反覆三差之
原總其理而撮其要依之作表力省功倍故名曰簡法
太陰距目等得極出地高黃道交地平限則氣差周亦皆等
云太陰則太陽五星同一理云極出地高因極高低不等
則天頂之距黃道人目之距日月五星本體遠近不一
視差無不因之有變云黃道交地平因黃道未定隨天
左旋時距頂遠時距頂近而日月五星從之雖距地心
同距目微有異亦得視差之變故以定黃道定極高求
七曜遠近則視差可得而
論矣如圖甲為地心以乙
丙丁為地面以丙為人目
所居故甲丙線上至戊為
天頂設丁正居黃極下則
乙丁為黃軸與己壬作垂線而己壬乃黃道也今使太
陰距天頂最近視度在己為丙目以丙己直線所望者
則因戊己為高弧而庚己高下視差以丙己辛角或己
丙庚角量之(兩角為平行線内相對角故等)故凡從丙出直線居己戊
癸過頂圈之平面與丙己相等者至己壬黃道周邊所
作角周亦等何也丙辛既為己壬之垂線則己壬黃道
于過頂圈相交之公界兩圈以直角交必丙辛線與諸
黃道平面上之線等為垂線其得丙辛己丙辛壬及諸
黃道面上線凡為丙辛所至之角安得不等為直角夫
使丙己周至黃道皆等(因太陰距目等故)則丙辛底同餘丙己
辛角之所周必等(幾何一卷八題)蓋本角原以戊己當高弧能
量高下視差今復以之當出黃極經圈于黃道上定氣
差則同一角也同一量也角周等得氣差無不等
太陰距地心等雖距目不等其氣差周略等
人目正居黃道下則月隨黃道圈行絶無氣差可求惟目
或居黃極下則以黃軸去地心太陰周距地心等必距
目亦等而氣差自等故目在黃圈黃極之中周視太陰
之行雖時近時遠而遠近之最差在正中處其距黃圈
黃極皆等彼此約有四十五度如圖太陰距地心以甲
己線一周等則距目以己乙線正前所謂居黃道下絶
無氣差者也然或以己丁線則目在黃極下矣得丁己
丁壬周距太陰線者皆等
而其不等之距必在丁乙
兩限之間最不等者在丙
即丁乙限之正中氣差之
有變易者此也今目在丙
欲求太陰將出地平與其至正午兩處差異同若干設
太陰距地心最近得地半徑五十四在黃道己或壬則
甲己較甲丁有五十四與一之比例(細算甲己作五四甲丁)
(即一)故丙乙四十五度查正弦七七一一為丙
辛必與丙癸等因而甲辛亦等甲己减甲辛餘五三二
九二八九為辛己甲壬加甲辛得五四七七一一為辛壬
先求丙己辛角(氣差角也)則辛己與辛丙若全數與本角之
切線算得四十五分三十八秒次求丙壬辛角則辛壬
與辛丙若全數與本角之切線算得四十四分二十六秒
兩角差止一分一十二秒第前設己角在正午而壬實與
之對則壬角必在子矣此不須論差惟以丙辛為底其上
立辛戊與甲丙辛平面為垂線自甲出甲戊與甲己等以
定其短長自丙出丙戊與甲戊等得丙戊辛甲戊辛兩角
亦等(甲辛與辛丙等甲辛戊及丙辛戊皆直角而辛戊又同故見幾何一卷八題)蓋因己辛戊為
直角設太陰在戊必去己正九十度出地平上而丙戊辛
角則能量氣差矣欲算之與前同丙戊與丙辛若全數
與本角得四十五分一秒較己角差三十七秒可見
太陰距地心等雖距目差地半徑所得氣差亦庶幾等
太陰距地心等雖距目不等而目視之若在視黃道
下得氣差實等
何云視黃道如圖甲丙為地半徑較真黃道天之遠絶無
比例故目在丙與在己壬線同而戊乙平行線亦可當
己壬線則己壬為真黃道而戊
乙其視黃道也今以丙目設太
陰居戊居乙其目必以丙戊丙
乙不等之線始能視之則因此在視黃道距地心以甲
戊甲乙兩直線皆等即本線至視黃道周所作角亦等
何也甲乙戊三角形因得兩腰等則戊乙底線兩端之
兩角亦無不等(幾何一卷五題)而周兩腰所作角自等則本角
因丙在黃極所出圈之平面皆當氣差可見氣差周等
時差變必以太陰距九十度限為主
如前圖甲乙丁過天頂圈之平面上立戊丙垂線得戊丙
甲戊丙己皆為直角又本面上于癸立戊癸直線則因
戊在己戊壬圈而己戊壬圈與本平面以直角相交(當竪)
(立之圈)必甲癸戊角為直角與甲癸己甲等太陰居戊甲
戊甲己相等而甲癸同則兩三角形内餘相當之腰及
餘角皆等必全甲癸戊三
角形能當全甲癸己三角
形因以本形顯氣差為甲
癸線所對而甲癸丙亦直
角則丙戊癸三角形内亦
顯氣差為戊角所量丙癸線所對也(甲癸以直角横黃道行丙癸順黃道)
(行故)苐前設戊丙甲為直角則戊庚相距九十度(此庚戊當高弧)
太陰居戊正在地平以丙戊癸形所顯即其最大時差
(癸丙為黃極距頂之正弦使其距度不變則其弧不異而時差亦同又使黃極距天頂或遠或近時差亦必依)
(之為大為小而大小皆太陰在地平是其最大時差也)今太陰或去地平遠所得
時差漸變又無高弧可測則不必以戊丙庚角而惟以
戊丙己角量其多寡可也蓋己癸壬視黃道圈以直角
交丁乙出黃極經圈(與庚己戊外圈同面此當倒圈)得九十度限在己
故太陰在戊就己愈近得戊丙己角愈小因而戊丙癸
三角形中餘丙角大則對角亦小雖丙癸線不異其時
差為戊角所量無不異矣(丙戊癸三角形以丙癸底線合己壬黃經上又以兩腰在)
(黃道圈同面上)至太陰正居限中則丙戊丙己及癸戊三線者
皆歸一直線絶無戊角亦絶無時差也
或問丙戊癸三角形全在視黃道平面上代辛戊甲在實
黃道面上三角形故甲戊線
較之癸戊線微長未免癸戊
丙角較之甲戊辛角略異即
時差何能真乎曰試以丙丁弧得半象弦為四十五度
此即差之極遠處(若丙目在乙則兩底線及兩角形全合為一若丙目在丁則兩腰歸一全)
(無時差可論)欲求兩差同異設太陰距地五十四地半徑為
甲己算(法同前)得甲己癸角為四十五分一秒因而癸
己線(與癸戊線同)五三九九五三二與丙癸底線(四十五度之正弦)
合算得丙戊癸角為四十五分若甲戊合甲辛同算得
甲戊辛角亦四十五分弱半秒又不待言矣
合論三差列表
因太陰距頂九十度在戊以戊丙甲為直角以甲戊丙得
其最大高下視差為甲丙則太陰距地與地半徑若全
數與本高視差又因甲癸
戊為直角而甲戊癸當氣
差必癸戊丙為時差欲求
戊氣差則太陰距地與九
十度限距頂之正弦若全數與本角之正弦欲求戊時
差則先求癸戊腰線全數與甲角之正弦若太陰距地
與本線乃癸戊線與丙餘角若丙癸底線與本戊角苐
最大時差為太陰近地平所得者則以甲丙癸三角形
求之全數與黃極距頂之正弦若最大高差與最大時
差今列表其上横兩行一地半徑數即從諸曜至太陰
止為七政距地數也一最大高下視差即諸曜近地平
為本圖甲戊丙角所推得也表右行書九十度即黃道
九十度限距天頂以查氣差者或本限距地平(限距地平與黃)
(極距天頂同)以查時差者故算表任用何距度大端都歸于
一假如九十度限距天頂五十度或限高五十度所推
分秒皆同試以太陰距地五十四地半徑得高下視差
六十三分則全數與六十三分若五十度之正弦與四
十八分一十六秒此分秒時當氣差時當時差因度限
距頂為五十度或反距地平亦五十度故也
或問本表既别求九十度限定其高度及距天頂若干然
後查求視差較諸法不甚大異今獨别之曰簡法此簡
之玅可得言乎曰常法或依三角形算或依表查若三
角形除九十度限及高度外須更算距子午圈日月高
弧黃道過高弧交角諸法乃敢求高氣時三視差查表
則須太陽距赤道表高弧表交角表又須各視差本表
種種推求亦綦繁𤨏顧有一開卷而三差俱備如是尚
不謂簡乎雖然算交食者因其當然求其所以然必多
方磨勘而其故始明其理始得尤不當以簡為定法
用法
未算視差先求定朔以兩曜實經及本食實時查黃道九
十度限表求本限距天頂若干餘度即為距地平高也
次求氣差則以限距天頂本度查右行以太陰距地心
查上第一横行(用視徑表内太陰距地數)其下得本距地太陰所應
最大高視差减太陽最大高視差(大陽行最高或近應一分行最庳應三分)
(在高庳之中應二分俱因此改)以餘數入表兩數相遇即得氣差次求
時差必兩次查表亦以限距頂之餘度從右以本高視
差從上至中得最大為本太陰距地之時差(近地平所生為最大)
又以太陰實經較限所躔宫度得其相距度則以最大
時差從上以限曜兩相距度從右查表至中格得所正
應時差若成數有竒零先以度查表得分秒又以分查
表得秒微或求氣差或求時差俱如此
假如崇禎七年甲戌歲三月朔日食定朔在巳正七分
四十九秒日月實會在降婁宫八度三十分以本度查
九十度限表得應時三十一分加巳正八分總得二十
二時三十九分(俱小時從午正起算)以此時復查九十度限表得
限距頂四十四度四分餘四十五度五十六分即限
距地平高度以太陰引數(七宫一十四度)查表得太陰距地五
十五地半徑又查本表得最大高視差六十二分减太
陽在中距最大高差二分餘六十分求氣差上以六
十分右以四十四度入表中得四十一分四十一秒
即食時所應得太陰氣差也(較以三角形所得止差一十七秒)上行又
以六十分右以四十五度查表得四十二分二十五秒
因而限距地平高度外尚有五十六分故又上行以六
十分右以五十六分查表得四十九秒四十四微與
前相加總最大時差四十三分一十五秒今太陰在降
婁宫八度三十分九十度限在降婁宫初度五十九
分(查本表得)相距七度三十一分則復查表以四十三分(最大)
(時差)從上以七度從右得五分一十五秒又以三十一分
(相距之零數)從右本四十三分以下得二十二秒次一十五
秒從上(最大時差之零數)七度從右得一秒五十微總為時
差五分三十九秒較三角形所算止差一十五秒他算
俱凖此
列表之法上兩横行一以地半徑從多數逓至少數一以
高下差從一逓至六十六每數各列五次旁以黃道九
十度距天頂及距地平數從九十逆書至一分五段焉
因上每一數通關旁之九十等數一二行不能盡書故
分為五段旁數既分五段上方自不得不各列五次而
中方之時氣差亦以五段列出用表時須會此意查之
新法算書卷八十
