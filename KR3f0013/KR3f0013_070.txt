新法算書卷七十明徐光啟等撰
交食歴指卷七
測食分
算食而不測食將何以攷其法非強天即自欺故必隨測
隨算了了於目了了於手則視差視徑時分俱凖而法
乃得矣
測太隂食分
常法全頼目力因分太陽徑為一十分太隂徑亦如之食
甚時則以所見不食之徑約略不能見之餘分設并見
失光之體庶幾所食有半者依此以測猶可此外則多
有謬焉何也太隂未食以前欲用器測全徑食甚時又
測光所存之餘徑此際甚難(其光微又無從定中線故)且不正合于
法今補此闕用太隂地景兩徑之比例及太隂見缺之
邊如圖地景心在丙得乙戊辛弧為邊太隂心在甲以
其乙丁辛邊弧入景中為所缺自乙
至辛作直線更一直線聯其兩心及
兩邊交切之界于乙或辛為甲乙乙
丙及甲丙而甲丙及乙辛以直角相交于己使太隂入
景之邊乙丁辛為六十度因半之于丁得乙丁對乙甲
己角為三十度必餘角甲乙己為六十度(甲己乙直角故)甲乙
割線二萬乙己止一萬則以甲乙與乙丙之比例(一與三是)
乙丙得六萬為丙乙己角之割線查八十度二十四分
本角之切線五九一二三六為丙己而甲己為甲乙己
角之切線一七三二五兩切線為甲丁及丙戊所减
(甲丁與甲乙丙戊與丙乙自相等)餘丁己二六七九五戊己八七六四
并之得三五五五九為甲乙二萬分比例之分因以推
太隂之食分盖設太隂半徑得一十六分與之相乘用
二萬除得食二分五十一秒(度數之分)即徑分止有五十三
秒以此測雖微有差所推徑分終近矣
測太陽食分
密室中對太陽開小圓孔以受其光因孔小出光之體大
則所正照之光必為角形其底在太陽其角在孔之中
夫光一入内又復展開為角形以致底所對之牆轉其
原形以上為下以左為右使牆與光直角相遇則底為
圓形不則為圓長形使孔不圓且小則光底在牆或彷
彿孔形而所像太陽之形大都不眞何也太陽孔牆三
者皆有遠近大小之比例盖孔距牆得其本徑數與太
陽所距本徑數等則光底在牆必像太陽圓形及孔之
多邊形各等為雜形若兩徑數不等而太陽距牆得徑
數多則光底失去原形轉隨孔形得徑數少則光底必
因之愈少故測食者恒設孔小而圓乃可遠近無差因
以牆上所缺之形徵太陽所食之分法以規器于紙上
先畫大小不等數圓圈各以徑分之其徑以十或更密
平分之臨測室中以圈受光不拘遠近任用大小圈全
以脗合于光為凖既合便轉紙使其圈徑横過餘光形
中平分兩角則光缺之界即所食分數方光與圈合時
遂以筆于光景間微識三四小點求心因之作圈略得
太隂掩太陽大小之比例如圖甲乙丙丁為太陽食外
之餘光正與甲乙丙圈界相合其心在
戊其徑與丁以直角交景而平分甲及
丙兩光角則得太陽食七分有竒更取
三點為甲丁丙以己為心(幾何三卷二十四題)以甲丁丙辛為太
隂乃以己丁較戊乙亦得日月兩徑大小之比例
日食射光之容
測日食以最微之孔對照之西土用綠色玻瓈僅見日周
俱掩去餘耀反照則用水盤欲細則以平面鏡所接之
光反射牆上可略得分明苐對照水中反照皆非實測
之法惟射光于牆略近然因尚容次光亂其景猶未足
故前以密室測食之分為本法今再全觧之欲光從外
入室内以其形正彷原形盡乎大小之比例倘孔非最
小(幾何稱無分點之小)而圓則太陽食照必略變其餘光之角形
為不彷原之一又太隂掩太陽其徑略小即失天上視
徑之比例為不彷原之二因徑小所食之分較天上之
眞分亦少為不彷原之三三者皆歸一緣盖接光之孔
稍廣則從中心攝太陽之形全顯于牆或紙亦併周孔
邊之每點全進焉乃每點所進射之形雖圓其出外與
孔之圓不平行而每點射形之公界
復與之平行且内抱中心所射之形
亦與之平行如圖乙丙丁界内為光
即太陽總形也其内圈壬庚癸為孔
之廣因圓故其受光至平面亦圓苐
太陽大不可比其光一入復寬為戊己辛形與内圈平
行以其中心甲與太陽正對故以遠近之比例可推本
形甲戊半徑與太陽視半徑大小之比例然庚内圈之
點射太陽形為丙己辛較于中圈更以戊丙徑線出外
(戊丙與甲庚孔之半徑等)而壬癸及餘點皆射圓形則外得乙丙丁
總圈其甲丙與太陽半徑無大小之比例以遠近可推
也又因原形入室内必借孔形以兩形合别為雜形今
測太陽設圓孔原形無從可變(除上為下左為右)而食之時其
自變形露角射于密室内又與孔之圓形不合因而損
其角似圓矣如圖太陽食之餘光實為甲乙丙丁乃從
甲孔之心射入以丙丁乙弧不異于孔形而丁甲乙角
形則異矣故本界四周以孔半徑展
開(甲戊丙己乙辛丁壬皆半徑)外得戊辛己壬為
總界與前圖所觧同則以辛己壬弧
元合于孔形而壬戊辛亦必彷之其
彷之之規必依孔半徑故丁乙各為心得壬癸及辛庚
弧皆變為圓角耳
室中測食日月兩徑有定差
依本食圖丁甲乙弧為太隂掩太陽之邊其心在癸從癸心出直
線至丁至甲至乙又乙丙丁中原形使之過庚為圈而從其甲
心引直線至壬至辛至己因甲乙丙丁為日食餘光之真形實
合于原則癸甲與甲丙或癸乙與甲乙癸丁與
甲丁(甲丙甲乙甲丁皆太陽半徑癸甲癸乙癸丁皆太隂半徑)得真大小之
比例亦與原視半徑全合今密室之中辛己壬
戊光形實以甲戊孔之半徑周展其界則太陽
亦展半徑自甲致之于壬于辛于己而甲辛與甲癸太陽半徑
之比例必過甲乙與本甲癸之比例太隂半徑亦然移癸甲為
癸戊其癸丁癸乙皆曲而小故甲乙與癸戊之比例又大于甲乙
與癸甲之比例而甲辛愈大(因甲辛大于甲乙故)可徵兩徑在光形密室之
中比于兩徑實在食時必依孔之廣狹變其大小未嘗正合焉
室内測食食之分有定差
依前圖總光界辛己壬弧以加壬丁辛弧作全圈則甲乙
元為食分與丙乙太陽全徑實得比例
今總光形之徑己丁較之丙乙長兩孔
之半徑(即己丙及乙丁)故本徑與食分變比例
因而甲乙比于己丁線不如比于丙乙
線得大小之理若丁戊(光形食之分)則既乙丁與甲戊等亦
自與甲乙相等可徵其大小之比例在光形有失矣
或問測食與算食分數不合而每每所測分數恒不及必
因食形假耳今欲改為真形從何法得曰以太隂半徑
加孔半徑于太陽餘光之内反减之各依本心光形内
作弧得甲庚丙癸原正形即從甲太陽形心及丁太隂
形心推定也
定食分及兩徑比例必係真光形
推算食分以定多寡法以兩曜視徑較于距度求之今欲
于所測對騐亦以日月兩徑以其兩心相距幾何即可
得矣但測時因太陽行速依前法于形中點號以求徑
並距孔時遠時近就景于先所畫圈亦不易故紙距孔
須定度(用窺管前開小孔後置白牌彼此以平行相照)可免多圈多量之煩受
景之底大小依遠近如圖外有己壬辛大圈為定周分
度數共作四象限(用以取食方向見下文)中有乙
戊丙丁小圈以甲為軸能轉動此乃受
光形之圈故以丁戊指太陽全徑以甲
心及孔之中心與太陽中心正對本圈
上安量尺即戊丁中空以兩旁與圈徑平行其尖銳直
至大圈以能指度為用量尺上仍有方尺為乙丙中開
一小陷道以合于下前後可任進退將用渾器對太陽
時便轉中圈令其徑平分餘光之角隨以方尺就之其
交徑之點必用號以識之有光無光之邊交徑點亦然
即以此定乙甲丙弧分食與不食之
形不須别點如二圖設乙丙丁戊為
太陽食形得心在甲丙戊為徑以方
尺(乙己丁)切光之鈍角(乙丁)交徑于己景
邊交于戊今依孔半徑得己庚作壬庚辛直線與方尺
平行而更作辛癸壬子即日食之真形何也使壬丁辛
乙各于方尺為垂線必自為平行線因而庚己亦于方
尺為垂線(因作法盖庚己為丙己徑之分)則庚己壬丁辛乙三線皆等
既等而庚己為孔之半徑則餘兩線亦各半徑可知壬
辛兩點當孔中心為真形之銳角則日月兩邊實于此
點相交而壬癸辛為太陽壬子辛即太隂兩弧中必食
分外則為所存光之真形也
或問真原形既定何以依之推兩徑之比例及太陽食之
分數曰孔與形相距之度與甲癸真形之半徑若全數
與原視半徑之切線查表得太陽視半徑試以全形為
一百分孔徑一十分相距萬分一百减一十餘癸丑為
九十半之得甲癸四十五以算終得一
十五分二十八秒(度數之分)論太隂半徑此
以庚辛中比例線求之蓋先以庚癸太
陽徑分求庚辛(見幾何三卷三十五題)次以庚子
與庚辛若庚辛復與庚寅得全子寅論食分則癸丑與
一十平分若子丑與食之分或若癸子與未食之分于
十分相减餘則為所食之
測日食細法
用方尺量食之形或景淡而景符無處可用欲以所測推
太隂視徑未免微差今更用一器愈凖愈易前所云受
光形之表中有軸能令小
輪轉動輪上定量尺隨以
同轉則因以載方尺而外
指度數矣此則兩尺俱不
用本小輪改為方形如圖甲為表中之軸亦為太陽景
心(先依太陽在本圈某宫度取視徑作圈)乙丙丁戊則大方形也轉以甲
軸以辛為表銳用銳以指外圈之度左右(大方形)開兩小
陷道能受小方形為己庚癸壬此中亦有小圈即掩太
陽之太隂也周圈先去孔半徑形(得圈大小不等預以引數取定或備數面)
(以待臨期更換亦可)其四圍(小方形)開空止存六小條與方相連以
支圈將測用大方置衡上(長方尺為衡其圖在下前所言窺管亦可)與孔以
定度相距小方貫入其前令中圈以邊合于景食甚時
見本圈上方餘光先至而左右尚未及必圈小宜換大
若左右先與光齊而上方未及則圈大宜换小總以正
合為凖萬歷二十九年辛丑冬至後兩日苐谷門人在
西土測日食用本器大方中圈設一百一十分小方圈
七十五分兩數總而半之得九十二分三十秒即初虧
時太隂與太陽以中心相距之分(任取無度數之分)故至食甚
時所見食之分(略得八分)此中必减去餘分乃兩心相距之
分苐先定太隂視徑因小方圈正食于景而設徑有七
十五分二十八秒以加孔徑一十六分三十秒總得
九十二分以此求度數之分得太隂在最高本徑三十
分三十秒若求食之分因當時形中得食八分(徑平一二分之)
(十分)以比例法算得七十四分(任取分之分)與兩心初虧相距
之分相减餘一十八分三十秒化為度數之分得六分
八秒(光形一百一十分减孔全徑一十六分三十秒餘分為法數太陽在最痺徑三十一分為實數)
(算得六分八秒)如圖甲丙太隂半徑减甲
乙兩心之距餘乙丙為九分七秒
加乙丁太陽半徑(一十五分三十秒)得丙丁
為二十四分三十七秒(度數之分)即月體
掩日之分故以三十一(全徑)為法以十二平分為實算得
九分三十二秒即太陽實食之分較于形中所見食多
一分三十二秒矣
或問測食常法因難分食與未食之徑不待言矣今室中
測食雖能明分之而所見食分非真食分所測徑非真
徑則古測又奚足用曰因分得日月兩徑大小之比例
及明暗之界即推真食分及真徑之根蓋古之定日月
兩徑多依此測不能無差今從而改之此外尚有測其
徑之多法(見月離歷指)
以真視徑比例推食之實分
測食者于室中任用器之長短孔之大小不必拘遠近之
比例而惟以先列視徑表定食分為止法以所測之光
形作圈以光景之界弧求心(幾何三卷二十五題)即太隂心亦作
圈必量兩圈徑(用比例尺或預分定數百平分之線)得各分數若干總而
半之即于兩曜視半徑并分數等何為分數等也日食
形内光與景各失其本然止以邊論則猶是若兩心相
距則非矣盖兩心相距與原形恒有比例因彼所張此
反損各半徑與原半徑不合而兩并與原并數則有合
焉故以此總(兩半徑量之分)與彼總(兩半徑度數之分)之比例各本分
(或日或月)推相應之半徑(形中非真半徑)與真半徑比較得差數因
以復推食分加于測食分即得所食之實分矣
假如萬歷十八年庚寅七月朔苐谷門人在西土測日食
見食六分正(依十二徑分大統亦能見推食五分有竒依十徑分)光景各半徑并
得四十七分太陽近最高得半徑一十五分二秒太
隂距最高四十餘度得半徑一十五分二十五秒兩半
徑并為三十分二十七秒即與前四十七分等故一
為法一為實求二十三分(太隂或景任取之分)相應度數之分若
干算得一十四分五十四秒比太隂視半徑差三十一
秒而差數或加或减于太陽半徑則以真半徑為法(當差)
(數加也)推得六分一十三秒(孔小故受景正而測之分比推算之分略近)為真
食之分
又一法用遠鏡或于密室或在室外但在外者必以紙殼
圍窺筩以掩餘耀若絶無次光者然而形始顯矣蓋玻
瓈原體厚能聚光使明分于周次光又以本形能易光
以小為大可用以細測(以小為大非前所云光形周散也因鏡後玻瓈得缺形光以斜)
(透其元形無不易之使大見遠鏡本論)然距鏡遠近無論止以平面與鏡
面平行開闔長短俱取乎正(光中現昏白若雲氣則長邊有藍色則短進管時須)
(開闔得正)餘法與前同崇禎四年辛未十月朔在于歷局測
日食用鏡二具一在室中一在露臺兩處所測食分俱
得一分半(徑分十分)先依順天府算以太陽引數三宫二十
七度取視半徑一十五分四十二秒以太隂引數五宫
一十九度取半徑一十七分五十八秒半徑俱悞用大
故并而减太隂當時視距度二十七分二十二秒餘六
分一十八秒因算得食二分試依新列表改之則太陽
得一十五分二十一秒太隂得一十七分一十七秒并
而復减視距度餘五分一十六秒算得一分四十三秒
為真食分必如鏡所測也夫鏡所測形為丁乙丙戊即
太陽食邊之下映者與實在天所食之形相反(大光過小孔之)
(故)依丁乙丙弧求己心即太隂
心設其半徑己乙為五十分甲
戊四十八分兩半徑并得九十
八分(皆比例之分)為法數兩半徑又
并作三十二分三十八秒(度數之分)為實數則以太隂五十
分推得一十六分三十九秒為己乙度數之分必較于
己壬真視半徑得差三十八秒為乙壬今論徑分(以十分分)
(之)以三十八秒算得一十二秒宜加所測之辛乙一分
三十秒總得辛壬為一分四十二秒正合于所算食分
矣
或問遠鏡前後有玻瓈在前者聚光漸小至一點乃在後
者受其光而復散于外則後玻瓈可當一點之孔何所
射之光形不真乎曰後玻瓈不正居聚光之點必略進
焉以接未全聚之光乃復開展可耳(見遠鏡本論)故謂此當
甚微之孔則可謂當無分點之孔則不可所以用鏡測
者縱或不真然較之不用鏡者不但能使所測之形大
而顯亦庶幾于真形不遠矣
測食方位
古多祿某以交食占驗欲定何州郡則以本食方位求法
近世以本方位立法因推太隂距太陽視經緯而以所
測定其視行也
測日食方位
太陽本食或正向南北東西則目力所及一見能决惟不
盡出於正而偏有所距則因以分别所偏若干定分數
多寡此必實見之測乃可得耳前論食分設兩輪盤并
在一平面上與太陽正對亦與外耳進光者平行其下
大盤不動分以過圈徑從徑左右邊分全
度數用以測食方向上小盤則能運轉載
量尺與下輪邊以對度數為主將測全器
對太陽下盤之徑線對高弧以光形之角
較本線或正或偏因推所向方位設兩輪
底方以直角安表衡上為甲乙與外耳戊
正對太陽毫不偏于左右則乙戊衡正居
過天頂及太陽圈之平面(前所云高弧也)而甲乙
直線自上至下亦當天上本圈徑之分外
有木矩架為丙丁己(全形見月離三卷)以丁己柱正立取地平
柱端作運軸使衡能上下轉以入架腰定丙乙太陽出
地平高度而全架則又周轉如轆轤也用法日食時表
衡對太陽以甲乙方之面正受其景則上下輪環轉而
方尺與餘光兩角或積或平行其量尺所指輪邊度分
即太陽本食所偏向高弧度分也又本衡末于架腰自
指太陽高度則得時分因得太陽及高弧距正東西以
加或减于日食之角偏去高弧度分終得食景偏去正
東西度分設衡下無架可分太陽高度則以别法求時
刻而于衡之末以直角加横平方其甲乙直線及渾衡
亦合于高弧圈之面若不用量方兩尺依前第二法用
兩方形有圈者以上方進入下方之中圈直至形前掩
景周圍與光齊而左右小條當方尺與兩餘光之角或
相積或平行其外銳亦指本景所向之方與前同如太
陽初虧測方向得偏高弧距三十度太陽出東地平高
四十一度三十四分躔降婁宫初度因得己時高弧距
正東四十八度四分(或查表或以三角形算)减食方向距高弧
度餘一十八度四分即初虧向西北度若太陽復圓
其方向高度時分皆如前則一十八度四分為復圓
向東南度又設方向距高弧過象限三十度(角上左旋)高度
時刻俱同前則與高弧距正東相加得七十八度四
分即初虧向東南復圓向西北度(初虧向東南復圓必不在西北此盖指前)
(後兩食論也)
或問所測方向距高弧線之度何以知其宜加與减于本
高弧距正東以得其自距正東之度曰日食時設有大
圈徑過日月兩曜中心左右至地平此即太陽失光及
未失光之面所向度分今本圈以直角交高弧則向位
距正東或正西之度與高弧距子午圈之度等(地平圈上算)
本圈合于高弧通為一圈則高弧至地平所指度亦為
本食所向度若夲圈斜交高弧則以下輪盤外圈因知
兩距度宜加與否(兩距度者過心圈距高弧高弧距子午圈者)盖午前過日
月兩心之線測得在右上象限或左下象限宜加餘象
限宜减午後則反是(不拘初虧復圓)或見日食餘光之上角在
高弧及子午圈線中則過心線之距加于高弧子午兩
線之距此在午前後共法設甲乙丙丁為下輪盤之外
圈分四象限各象限分九十度甲為天頂甲丙線當高
弧甲己甲戊皆子午線中小圈即太隂掩太陽者或食
甚或初虧復圓時在其東西南北及中
央皆一類(天上向位在西圖中反在東諸方皆如此)設庚為
太陽過兩心之線為庚乙因以直角交
甲丙線其至地平必兩相距正九十度
故丙距己(地平上算)乙距正東之度皆等又設辛為太陽則
過兩心線與甲丙同為一線故甲丙所至地平度亦為
太陽辛食所向之度也又設壬為太陽則以壬癸過兩
心線者得壬癸乙角加于丙甲己角减于丙甲戊角(因太)
(陽壬之上角在丙甲己内即午前在丙甲戊外即午後故)得總或餘角以定日食向
盖過兩心之圈恒指向位又恒隨高弧設高弧與子午
圈全合為一必過心圈以直角交者所指向位在正東
(食復圓時)或正西(食初虧時)若斜交則因角大小不等食形所向
度距東西遠近亦不等其高弧不正與子午圈合而相
距在其左右則過兩心圈雖以直角交猶隨高弧距正
東西左右若斜交則本圈更距東西不等盖以此兩故
求其距度直至與高弧合則惟高弧定距度也
以長圓形求日食方位
前論密室測日食分法以平面之方受景盖孔小而方又
正對太陽其景必圓今以斜對之平面亦在密室中受
景孔仍如前小則所得形必長圓(凡地平距黃道内者對太陽宜斜)其
長徑線可當高弧法用白紙置地平
上(任置何處宜與地平等)令受日景必自為長
圓形次于本形兩端各識數點又于
兩光缺角亦各識一點以便用規器
取食偏距高弧度設乙丙為長圓形
之大徑當高弧線求丁戊景缺偏距乙丙線若干則平
分徑于甲以甲為心丙為界作圈次與甲丙作垂線過
丁戊兩角至己至壬此己壬弧半之于辛作甲辛直線
則得丙甲辛角即日食偏距甲丙高弧之角設丙辛乙
半圈分一百八十度以規取丙辛弧定度分若干試依
先測之横徑(若未測以太陽高度求之)以甲為心作中小圈從兩光
缺角引直線與長徑平行至本圈之邊得庚癸弧其出
中心至外大圈甲辛直線者交于小圈之弧為兩平分
則知先所取丙辛食方向距高弧之度無謬也
因長圓形之心不正居光角形之樞線而横徑較光角形
之正底亦微過焉故欲求其正設角形中線至子以太
陽高度之餘推子乙子丙則于本高餘度加一十五分
(太陽半徑依引數取)又减一十五分得三不等度查各度切線以
相較得乙丙長徑之正度也如甲乙丙為光
角形至地平乙戊因斜遇為長圓形其長徑
為乙丙太陽在甲當高三十七度餘五十三
度角形樞線甲子則戊子為五十三度之切
線减一十五分餘五十二度四十五分其切
線戊丙反加一十五分得五十三度一十五分切線為
戊乙今戊乙减戊丙餘二四九為丙乙即形中長徑
也求横小徑則全數與太陽距天頂之割線若太陽半
徑之切線與横小徑算得一四八六(兩徑自較得一十與一十七之比例)
(欲各較于全數設全數為十萬)因此依前圖算設乙丙為大圈之徑則
以本比例得小圈作長圓形引丁己及戊壬垂線如法
半之終得辛甲丙角為二十二度三十分宜加或减于
高弧距子午圈以求其自距子午圈與前法同
測月食方位
治銅為一匾圈約寬二三寸許周分三百六十度其圈内
俱開空止留四線如十字交羅中心交羅處安量尺方
尺其尺徑較圈徑略長皆能旋動與前測食分器同將
測時從初度取上下正對太隂以垂線取凖地平轉其
方尺令對兩餘光角則量尺抵邊所指度分即本食向
方距高弧度也盖密室月景不顯必室外測乃可若用
地平經緯儀上置前圈以象限載之轉中線對高弧須
凖與地平合可免算高弧距正午度
又簡法以界尺對兩角令其或取恒星或五星同居一直
線上加太隂高差(以高度于本表取)得其向恒星若干免以高
弧復求别距度何也因切兩角之線其過景邊交月邊
處必俱以直角交過月景兩心之線故得角與星居一
直線則從此相距九十度遠者必為本食所向之方矣
太陽初虧能向東復圓能向西否太隂初虧能向西復
圓亦能向東否
從來論日食者俱以初虧向正西或西南或西北復圓即
向正東或東南或東北月食初虧向東復圓即向西或
偏東偏西此定法也今細考之殊多不然盖初虧復圓
兩向相反者此非一食可有之事必兩食而日月體不
全食或有之先以月食論如圖以甲為心即地景之中
心以其半徑為界作圈從上至下引乙丙直線可當高
弧横作丁戊當黃道斜入西地平下得乙甲丁為其兩
圈之交角又作己辛直線與黃道線
以直角交于甲心設太隂本心在己
或在辛此為定望故甲己甲辛各為
月景各半徑并與距度等又己為隂
歷漸小必己庚(白道)距黃道漸近辛為
陽歷漸大必辛壬(白道)距黃道漸遠此太隂未及辛先與
甲近彼太隂過己後漸與甲近兩者未免微有食(距度比甲)
(己甲辛兩半徑并較少故)其所食大則從甲心出直線至白道以直
角所交之點下為癸上為子是也試以甲癸或甲子當
五十八分較甲辛甲己略少(兩半徑并共六十分)則五度(最大距度)之
割線與全數若五十八分與兩心之距(月心地景心)得五十
七分四十七秒餘二分一十三秒變為食分即四十四
秒故依圖一食之初虧在己他食之復圓在辛而復圓
向東初虧向西者此耳可遂守為一定不易之成說哉
若東地平黃道斜升其上亦與前同設癸子為黃道乙甲
子為黃道交高弧之角則丁戊線以直角交黃道者上
有丁為隂歷漸小而壬丁白道與黃道漸近下有戊為
陽歷漸大而戊庚白道距黃道漸遠必
辛一食之初虧向西丙他食之復圓向
東萬歷四十一年癸卯十月十六夜大
統歷官報月食四分四十八秒初虧子
正三刻復圓丑正三刻西土第谷門人
測三分強總時得八刻弱與大統略合但先後兩處不
能不異盖此(中土)太隂初虧略過子午圈彼(西土)出東地平
高未及二十度因行陽歷而距正東去北其初虧向正
西復圓偏西南
論日食其方向之變不但以黃道斜升故即視差亦有之
盖降婁東出必黃道交地平角漸大至鶉首出則愈大
故太隂在地平上不論何宫度其隨宗動往北甚多以
本行去南反少氣差亦少而太陽夲食距赤道南午後
其初虧可向東距赤道北午前復圓可向西又壽星出
則至降婁為半周本角漸小太隂去南較其本行回北
己多必氣差更大而太陽距赤道北午前初虧可向東
距赤道南復圓反可向西今試以黃道斜升之故設太
陽在降婁一十五度出東地平高一十度北極高四
十度當此有食則太隂在陽歷距南二
十分(視距度分)雖不全食約有三分之一
如圖丁壬為地平丁庚為黃道兩圈斜
交于丁則戊為正東壬為正午庚癸過
九十度限之弧高有三十度太陽在甲
高一十度太隂在乙初虧距黃道二十分得甲乙丙
直角三角形甲乙兩心之距當三十一分(日月各半徑并)求甲
角以定甲乙過兩心之線至地平何度即本食之向位
盖甲乙線與乙丙線若全數與甲角之正弦得甲角為
四十一度四十八分餘對角乙甲丁一百三十八度一
十一分今甲戊丁三角形内戊為直角庚丁癸角三十
度必餘丁甲戊角六十度而戊甲乙七十八度一十二
分故甲戊己三角形内求戊己地平限定本食向何度
則全數與甲戊高弧之正弦若甲角之切線與戊己弧
之切線(圖中設為直線天上實為弧)得戊己為三十九度四十四分
因高弧于此至正東則戊壬為九十度减戊己弧餘五
十度一十六分即所向偏東南過子午圈東之度若設
隂歷太陽復圓皆同度則太隂在辛而己辛弧又北過
子午圈向西北亦距北之西五十餘度
若氣差變向之故則如萬歷二十七年己亥七月朔苐谷
測太陽東北出地平(日躔鶉火初度故)其本體之頂有缺則必
西南為所食向方又太隂雖行中交因黃道交地平角
甚大本行已近北必得氣差少則復圓尚居太陽西而
本食方位已不可轉而東矣又萬歷十六年戊子正月
朔太陽躔娵訾七度有食初虧在午後六刻第谷測其
過日月兩心之圈距高弧偏西七十二度有竒復圓在
未正三刻半又測得本交角尚有一十二度(兩弧相距)可徵
尚未向東而初虧食甚復圓皆以西為方向矣如圖甲
乙當高弧丙丁為黃道太陽在己太隂在戊過兩心之
弧己戊求其距甲己若干以太陽食
時躔度及北極高度(五十五度五十五分)先定
甲己丙高弧交黃道角為五十四度
二十四分則餘對角一百二十五度
因太陽半徑一十五分二十秒太隂半徑一十五分五
十八秒并得三十一分一十八秒為己戊線太隂距北
一度八分减氣差四十三分五秒餘二十四分五
十五秒為丁戊線因而丁為直角故丁己戊三角形内
求己角得五十二度四十五分與甲己丁角相减餘七
十二度五十一分為初虧距高弧向西北度論復圓則
甲己丙交角有四十四度四十四分
太隂距度一度五分减氣差三十
八分四十四秒餘二十六分一十六
秒為丁戊線其己戊同前推得丁己
戊角五十七度三分减甲己丁角餘一十二度一十
九分為戊己距甲己高弧即復圓向西之度當時太陽
初虧鶉火宫二度復圓本宫一十五度出東地平故黃
道高太陽近北氣差漸少令太隂距太陽不能復過東
矣假使北極更低必得黃道愈高太隂往北减氣差愈
多因知復圓距東更遠萬歷二十三年乙未八月朔第
谷門人在東西兩處測驗或得食二分半或得食三分
蓋在西者測太陽初虧微過正午故高弧與子午圈略
同而向位距本圈偏東尚有九度在東者測太陽後一
刻有竒得其初虧正向天頂則地平北子午圈之東是
其向位也從是知初虧向西即復圓向東非定論也且
初虧不盡向西復圓不盡向東又已彰明較著有如是
也成法悞人可勝浩歎
以方位算太隂視經緯
萬歷二十六年戊戌二月朔西土己正二十七分初虧後
測食約有一分(十五分一刻十二分一徑)太陽徑線三十分三十
五秒太隂三十二分四十四秒各依本引數所定其本
食所向過兩心線交高弧者測得九十度正為直角如
圖甲乙丙為子午圈丁為赤極高依本地四十七度
二分丙為天頂太陽在己以丙己為高弧
丁己定距度弧太隂在壬因日月各半徑
并得三十一分四十秒减二分三十三
秒(即所食一分化為度數分)餘二十九分七秒為己
壬日月兩心相距之分又丙己壬角測九十度因推壬
辛即太隂距甲辛黃道視緯度辛己即太隂距太陽視
經度先求九十度限距天頂即甲丙庚三角形内丙庚
邊也盖太陽躔娵訾一十六度四十三分得升度三百
四十七度四十七分减測時距午所應升二十三度一
十五分餘升度三百二十四度三十二分應黃道居天
之中玄枵宫二十二度一十分乃距赤道一十四度
一十一分為甲乙弧加乙丙赤道距天
頂與北極依本地出地平高等得甲丙
為六十一度一十三分此時出地平黃
道度為實沈宫二十二度三十一分則
娵訾宫二十二度三十一分當九十度限為庚而甲庚弧
三十度二十一分因而甲庚丙角恒為直角則本三
角形内以甲庚及甲丙兩邊求庚丙第三邊(于甲丙弧割線加五)
(空位以甲庚弧割線除之)得五十六度四分即九十度限距天頂之
弧欲免算則以太陽躔度及測時刻依法查本表即得
九十度距天頂也以己庚丙直角三角形因得庚丙邊(五十)
(六度四分)庚己邊(太陽在己即娵訾宫一十六度四十三分九十度限在庚即本宫二十二度三十)
(一分相减餘五度四十八分為庚己也)于庚丙弧切線加
五空位以庚己正弦除之餘庚己丙交
角為八十六度七分對甲己丙角必
為九十三度五十三分(此太隂初虧在太陽之西比子)
(午圈略近所居)第測壬己丙角正為九十度餘壬己辛角止三
度五十三分因求太隂視經緯度則于壬己辛
小三角形内(因小可當直線三角形)以壬己邊(日月兩心之距)及
先所得諸角(辛為直角因算己角得三度五十三分壬即餘角)算得壬
辛視緯度距北一分五十七秒己辛視經度距
太陽前二十九分二秒即此可見測食方位
之用有如此
測交食變形之時
交食形者乃日月食起復之間光為景所損而變
遷其態以相示者也但受損之光初少漸多多
而復少今欲逐時逐刻以密求之其形無數且
可不必大都初虧食甚復圓為太陽太隂所共
而食既生光則太隂所獨此五限測法須先求
時對食分及食所向方位與距恒星度分乃可
一一得矣
測太隂食之時
常法測恒星高度若未見星先測太隂自高度乃
以升度求時(見高弧用法)苐谷用自鳴鐘或刻漏將
渾天紀限等儀屢測太隂餘光邊距恒星若干
或太隂恒星至正午俱以刻漏識之若太隂正
在黃道九十度限則從恒星之近者起算為易
得其本心及地景心升度可知恒星距太陽度
因以取凖時刻有用界尺測太隂兩角或對地
平圈平行或對恒星居一直線上或尺線過兩
角之中對月景兩心皆以求太隂視處定其經
緯以推時刻萬歷三十一年癸卯四月西土月
食苐谷門人測之預備刻漏取其能細指時至
分秒者試以數日令遲速脗與天合于太隂未
食之前測大角星在正午考時得亥初三刻八
分三十秒刻漏指亥初一十二分三十秒亥正
一十分(即亥正三刻四分)木星居正午高二十四度
三十二分(極高五十度)亥正一十八分(亥正三刻一十四分)初
虧向位在東南距高弧自徑線下起算四十五
度三十分亥正二十三分(子初四分)向位距四十
二度前此太隂未食約四刻時與心宿大星同
高弧此已離去距西蓋因視差故亥正二十九
分半(子初一十分)向位距三十九度三十分從土星
對月景兩心得一直線過亥正四十二分(子初一刻)
(九分)周星(天市垣者)至正午向位三十三度三十分食
四分一十秒先所過土星今反距其下矣亥
正五十一分(子初二刻二分)向位距二十八度稍遲得
食五分子初二分半(子初二刻七分)土星在正午高
二十一度四十七分子初九分(子初三刻四分)缺太
隂圈之半周子初一十九分(子正一分)太隂心至
正午其餘光邊高一十九度七分子初二十
四分(子正六分)向位距一十五度子初四十三分
(子正一刻一十分)餘光兩角正垂下距地平等食六分
三十秒子正二分(子正二刻一十四分)兩角與木星皆居
一直線其一角略高向西因知食甚已過子正
二十三分(丑初五分)向位偏西距高弧下一十八
度三十分子正四十七分(丑初二刻)向位距三十度
丑初三分(丑初三刻)距西三十二度丑初一十四分
(丑初三刻一十一分)尚距三十二度將復圓其邊有次景
因用土星測向位然必定土星之經緯乃無遺
漏當測時其本星距氐宿北星一十七度二十
二分距天江北第六星一十三度二十分因
是知其過子午高得躔柝木宫初度四十五分
三十秒距北二度一十分三十秒
萬歷四十四年丙辰八月去順天西一百度四
十五分(西邏瑪京都)親測月食以星高度及自鳴鐘
推得時刻初虧河鼓中星過西高二十一度得
一十三時四十四分三十秒(時為小時從午正起算即丑初三刻)
(十五分作一刻後倣此)左肩在東高一十一度得一十三
時四十四分二十秒畢宿大星高三十一度得
一十三時四十一分一十二秒當時鐘有一時
九分(從子正起算後同此)盖鐘所指時分每後太陽三
十四分先後兩日試驗俱如一即一十三時四
十三分食既織女大星距子午圈西高一十五
度得時一十五時三分一十二秒右肩二十
六度推得一十五時五分乃鐘指二時三十
七分即一十五時一十一分生光織女高一十
一度得一十五時三十一分四十五秒右肩高
三十一度推得一十五時三十三分四十五秒
鐘得三時三十五分復圓測天津第四星西高
一十九度得一十七時四分一十二秒乃鐘
有四時二十二分即一十六時五十六分又同
都一人另居一地測有四十六次所得時刻初
虧復圓與前測同惟食既少得五分生光少二
分耳今以新法推算復圓全與此合其餘限雖
微有參差然亦不遠三四分矣
測太陽食之時
太陽出東地平左旋漸高至午正則最高過午復
漸低至西則没此太陽自行一晝之時刻也故
得其高度即可求時其初虧食甚復圓等限惟
以此為常測法苐非密室中不可故又仍用前
器架上之衡及矩架俱如前而方架之式之用
見月離三卷各細分度數下方為地平從正東
正西至子午圈諸弧之切線衡為太陽距天頂
之割線矩架之股又為太陽距頂之切線此三度所以
全本器之用也測時將方架置几上以中線對南北一
手轉矩架隨太陽行並動其衡使之上下以受光一手
對輪盤上之尺纔一對景即于衡矩架下方架各識以
號(號宜同如一二等數是)而以號所對各器之度加輪盤所測之
景因推太陽食時及向位食分諸用萬歷庚子歲六月
朔刻白爾距順天府西九十九度一十五分用本器在
密室中測本食共測一十五次作號一二等如左
號一二三四五六七八九(一一一一一二三)(一一四五)
其下方架東西邊所分各當二千分自後至中左右各
當一千二百分先安置與子午圈對(以太陽距正午左右相等之高度或)
(先一日或測後攷對得架偏必差度或加或减于推測之度得地平正弧)然後測得地平弧
以推時刻今依一十五號列所測分及相應之地平弧
號一二三四五六七八九十(一一一一一一二三四五)如左
測(七一一一一一一八八七六六五四四一八六三)首一及二號所
分(五七三一七七七二四七三二七三一一三四五三四八五八七四四一)對測分在方架
度(二三三三四四五五五五六六六六七三六一八三五八二六八)北自中起數至
分(三二一三五二一三二二一五一五九八九七六四二二五七五)東餘轉東北角
往南其度分則架上平分所推即目正午漸去西太陽
所對地平弧也以測分推度分法二千與測分若全數
與地平弧之切線假如甲乙丙丁為下方甲丁乙丙每
邊分二千戊丁戊丙各一千二百分戊壬正對子午圈
亦二千當測得戊己即七五一
平分求戊辛弧則壬戊與戊己
線若壬辛全數與戊辛弧之切
線算得三七五五查表得二
十度三十五分若景過丁角在甲丁邊上遇庚則甲
庚為戊庚弧之餘切線故壬甲與甲庚線若全數與戊
庚弧之餘切線(壬甲與戊丁等)刻白爾轉矩架時下架悞隨之
動使地平弧略有差故以矩架求高弧以高弧攷正地
號一二三四五六七八九十(一一一一一一二三四五)平弧因推時
(五五五五五五六六六六六六六六六六六七七八九一一二三四六八九)刻如左
弦(七四一五一一六六六四九五六四九六三七二六六九四二四)矩架之立柱
(二二二二二三三三三三三四四四四四六六七八一二四五七八三六七)當句其數宜
股(五一七五九七六六三二九一九三九五七六三五八七三三四三五七)作五四
句(五五五五五五五五五五五五五五五)今則少異欲
依之算亦無
謬而矩架之
底為股上衡
為弦其長短
隨太陽高低
時時不等故
數亦不等此
求太陽距天
頂或以股或以弦皆同法而句與弦與股若全數與太
陽距天頂之切線次以高度(日距天頂之餘)求地平弧則全數與
極出地高之割線若太陽高度之割線與先得之數(為)
(待用之數)次北極太陽兩高差度之餘弦與太陽距赤道度
之正弦相减餘次得數則兩數(先得與次得)為實全數又為
法算得地平餘弧之矢依測本食之地極高四十七度
二分其割線一四六七一九太陽距天頂之餘六七四
度四分其割線二二八六六三算得三三五四九一
為先得數兩高度差一十七度二分查餘弦九五六
一三為减太陽當時距度(二十二度一十六分)之正弦三七八九
二餘五七七二一即次得數算得一九三六四八為矢
故减首位以所餘查八線表得六十九度二十八分即
從正西起地平弧餘二十度三十二分即對太陽過正
午地平之弧以此求時則乙丙丁斜角三角形内得乙
丁為極高之餘得乙丙為太陽距赤道之餘得乙丁丙
角為對地平(此二十度一十八分)至半周餘弧之
角求丁乙丙即對赤道弧之角以定相
應之時欲依直角三角形必丙丁引至
甲得甲直角則先求甲乙丁角(可用十設算見測量全義七卷本角得七十四)
(度五十一分一十八秒)次求甲乙線甲乙丙三角形内因得甲乙
乙丙兩線以甲直角推甲乙丙角(此八十四度一十九分一十八秒)則
乙總角减甲乙丁角餘丁乙丙角為所求(此餘九度二十七分四十)
(六秒化為時得三十七分五十秒過正午)測本食之復圓上衡微有阻碍
不及受太陽全景故以高弧推時較地平所推差四分
宜半之借此補彼則得二時五十七分三十秒為正
時
新法算書卷七十
