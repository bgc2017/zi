新法算書卷七十二徐光啟等撰
交食表卷一
算交食諸表法
交食有本表有借用表大都算交會交食分數及視徑視
差食既復圓諸用者為本表蓋原為會食設數列表則
止以算食鮮及他用也若算日躔月離及渾天儀等項
諸表亦可用以算交食此為借用之表也今所論列表
獨交食所用餘通用者各見本歷指無不詳明其法
歷元後二百恒年五行表(算法)
二百恒年五行表者太陽及太隂當此時或為自相較所
行或與定處較所行宫度分也何謂自相較乃首朔為
每年歷元後第一平朔而餘行皆以隨合之為準(歷元為冬)
(至後第一子時昔朔即本時之後第一朔)何謂與定處較乃日月引數彼為
太陽當時從最庳自行此為太隂當時從最高亦自行
及太陽經度乃其從冬至平行而交周度即太隂當時
所過羅㬋宫度也欲算首朔則恒于原根或加太隂年
或減通閏法(見交食歷指二卷新歷平歲三百六十五日減十二朔實餘數為通閏因與大統略)
(異)
假如崇禎元年戊辰首朔為一十四日加太隂年即十
二朔實得日數三百六十九于太陽平歲相減只餘四
日若復加太隂年日數少太陽平歲無可減故與己巳
之根四日等數加一十三朔實而總數乃能減之至壬
申年為閏則總數三百六十六日皆全減去是以其根
無日止得十六時等數也用減法則戊辰年通閏可減
而次己巳年不可復減因根數少故必先加一朔實而
後減也至壬申年因閏一日故前數宜減一十一日而
無餘日也
算太陽太隂引數及交周與太陽經度表法皆相同或
以加則用其十二朔實之行(見交食歷指二卷)或以減則全
周三百六十度減太陽十二朔實之自行餘數(一十度)
(四十三分五十二秒)為本年之根所減得次年之根但首朔有
加朔實之處此必用全周減十三朔實自行之餘數
(為一十一宫一十一度三十七分三十一秒)與前根相減乃得次年之根
耳假如戊辰年有根為九度二十一分二十二秒因
首朔加太隂年十二朔實此依加法亦加是年間太
陽及太隂之自行交周及太陽之平行其太陽自行
總數為一十一宫二十八度三十七分三十秒即
己巳次年之根也又本年首朔因加十三月此亦加
十三月間太陽自行得一十六度五十九分五十九
秒為庚午之根至壬申宜閏雖首朔多減一日此不
須論也依減法戊辰年論太陽引數減一十度等
數而次年減一十一宫等數是因本己巳年首朔根
借一朔實故餘皆倣此
用法
表首行書首朔者天正冬至後第一子正後之首平朔也
以求日月平會次太陽太隂引數者平朔日所當日月
之自行度也以求均度而推定朔次交周度者以求距
度次太陽經度者以求視時此四行皆平行皆與首平
朔日時相當列表每年最上書紀年向下五行所列時
日宫度分秒皆從本年天正冬至後第一子正起算最
下書宿書紀日皆用數為本年天正冬至後第一日所
得宿及干支也推交食上得年中得首平朔及同時四
種平行下得宿滿二十八去之餘為所用又得日滿六
十去之餘為所用
歷元前總甲子表(算法)
前表紀首朔即歷元後第一經朔此則不然乃用以冬至相
近者為首朔不拘在先與後也試以太陽經度對六十六
甲子首朔得在冬至及歷元之中盖太陽經行只一分
五秒化為時得其過冬至止二十六分首朔減二十六
分餘三時一十八分為冬至在本戊午日之時與首朔先
後差二十六分矣算表先求六十年五行之總數蓋首朔
以通閏為第一年之根恒以加通閏得次年及後年之諸
根滿朔實減之每四年閏一日餘四行用太隂年間本行
為首根而復加之恒如此得諸年之根遇首朔減一朔實
之處此加一朔實間之行而不論閏日六十年總行已有
定法(兩甲子相隨之數相减餘數即六十年之行數表中查之以此為恒法)則上推首朔恒
用加推餘行恒用減滿一朔實彼此共去之(俱交食歷指二卷)
用法
總甲子者第一甲子為唐堯八十一年第六十六甲子則
天啟四年也凡欲上推往古則用此表先查所求年在
第幾甲子次查本年為本紀中第幾零年餘法與歷元
後二百恒年表同
六十零年散用五行表(算法)
朔實減通閏餘數(一十八日二十一時三十二分四十一秒)為太隂一太陽平歲
所欠以滿十三朔實者或十三朔實減太陽平歲所餘與
上同故本數能定次年之首朔即表中起首之數也第太
陽平歲必餘有數時漸滿一日為閏日乃朔實内所先減
去得一十七日等時為首數以後凡隔四年多減一日若
餘數少于通閏無可減必借加一朔實然後可減矣太陽
引數等行恒以加十二朔實之行為表其首數必應合與
日數即十三朔實先除全周之行也日數凡加朔實而減
者亦加當時之行以更加十二朔實之行滿周恒除之故
不用閏日也
用法與歷元後二百恒年表同
十三月表用法
十三月表不論首朔以朔實為主每以一朔實加首朔
即得次朔如是逓加可求本年諸平朔也凡五表第一
上紀日時分秒右首行紀月數次各行為朔實每加一
朔實則加一月如三月則朔實八十八日有奇也後四
表上紀宫度分秒右首行皆紀月次各行皆本行之宫
度分與所求各月相當之數下紀望策以加首朔則得
首平望次依本月數先加朔實次加一望策得本年諸
平望餘四表下皆列本望策加法同
加減度表(算法)
加減度表有太陽均度從最庳起為初宫初度有太隂均
度從其本輪最高而起最高或最庳左右之數雖皆同
(盈初與縮末盈末與縮初)上下相對之數反異(縮初與盈初縮末與盈末)故表中
以兩曜本輪之初度對末度從初宫起順數從六宫起
逆數則表中于上下所應數無不合矣欲算表先求自
行為引數則太陽以本圈半徑及兩心之差(夫本圈心與地中心)
太隂以兩輪(小輪及次輪)及本輪之半徑皆依三角形可得
第本表及次四行時表皆為借用之表必查本歷指乃
得其詳法而算之
用法
加減度表以太陽太隂之引數查均度以均度或相加
或相減于平行得二曜實經度其首行所書太陽太隂
各加減者順加逆則減順減逆則加故各項下俱有加
減而上則總以順逆各貫下也次行是其各度分秒上
下各一横行上為順數下為逆數所記宫度者乃太陽
太隂公用之引數湏照各宫順逆字號順逆查也各直
行所當太陽太隂或加或減者均度也兩引數相較有
分秒兩均度相較則有較分以其較分依中比例法可
得細引數之細均度也
四行時表用法
平朔望或在定朔望之前或在其後若在前則以所差
不及時刻加于平而得定若在後則以所差過時刻減
于平而得定也四行表者皆所用以加減前後時刻也
上書時自一至六十亦可當分亦可當秒其法先查時
次查分查秒依表得數總計之為所求若無時止有分
秒其法同也四行第一數為月距日度分秒第二為太
隂引數第三為交周度第四數為太陽平行亦為其自
行一日之間二行所差甚少故也表右行度數亦當分
亦當秒以時查得度以分得分以秒得秒惟太陽行遲
數時間無過分秒故不列度數
加減時表(算法)
算加減時表必較太陽所躔宫度與赤道升度(可以用升度表)兩
度惟在二分二至則相同此外漸有差數自二分右行
黃道度多升度少自二至亦右行升度反多躔度為少
其最差之數在分至折中略得二度二十九分法以兩
道升度之差化為時分所得最差遠之處止九分假如
降婁一十度對赤道升有九度一十一分二秒差四
十八分五十八秒化為時得三分一十六秒因在春分
後夏至前躔度大過升度故用加若在夏至後躔度不及
升度時分則用減如鶉首宫三十度對升度一百二十二
度一十一分五十三秒所過躔度得二度等零數化時
為八分四十七秒表中號為減以平時求定時必依表
上下所書加減之號若以定時反求平時則易加為減
易減為加如測太陽在降婁宫十度為正午時乃躔升
兩度差五時三分一十六秒應減得太陽在本宫度之
平時
用法
求視時以太陽之實度本表查分秒得太陽所躔宫在
上順數用所求分秒依號加于實時得視時若太陽所
躔宫在下逆數用所求分秒依號減于實時得視時左
右書太陽所躔實度横入表至太陽所躔宫下相值者
即所求數
加減時表上半
加減時表下半
十二宫距宿鈐
此出恒星歷指定各宿距星躔度皆于崇禎元年應合故
去數年相遠求食在何宿何度以得其在分秒之内必
先或加或減是中積年恒星之本行則可得也(每年五十一秒)
(以後推算宜加以前反減)
用法
以太隂當食時所躔之度減前少宿度者餘度為日月食
在本宿黃經度如太隂在大火宫二十四度三十三分
二十四秒因氐宿距星躔本宫九度五十四分此乃前
少數為太隂躔度所減餘一十四度三十九分二十四
秒即氐宿太隂食時所躔之度再設太隂食時在大火宫
正二度則前少數為壽星宫二十九度一十四分亢宿
距星所居故大火宫二度借前一宫而減二十九度一十
四分餘二度四十六分乃本亢宿太隂食時所躔之度
也
十二宫距宿鈐(依黃道)
宫次宿距星在其度分宫次宿距星在其度分
星紀斗五三鶉首井八
牛二八五四鶉火鬼三三
玄枵女六三五柳五九
虛一八一四星二二九
危二八一三鶉尾張三二
娵訾室一八二翼一八三六
降婁壁四一壽星軫五三六
宫次宿距星在其度分宫次宿距星在其度分
降婁奎一七一七壽星角一八三九
婁二八四六亢二九一四
大梁胃一一四六大火氐九五四
昴二四四七房二七四八
實沈畢三一六析木心二三四
參一七一四尾一七
觜一八三五箕二五四三
十二宫距宿鈐(依赤道)
宫次宿距星在其度分宫次宿距星在其度分
星紀斗五三九鶉首井七
玄枵牛三鶉火鬼二五六
女六五三柳五一七
虛一八星一七二一
危二六四一張二三九
娵訾室一一三四鶉尾翼一二八
壁二八三四軫二九六
宫次宿距星在其度分宫次宿距星在其度分
降婁奎九二五壽星角一六二六
婁二三三二亢二八一
大梁胃五三六大火氐七二九
昴二一二一房二四一
實沈畢一四五心二九三八
參一八一九析木尾五四七
觜一八四三箕二五五
升度表用法
日月皆依黃道行故止以當食所躔度徑求相應宿黃經
度依前表用法則可若欲以日月黃道度求相應宿赤
經度必先定黃赤二道相望同升之度分令日月與星
皆同歸一道後依前表用法以日月赤經求宿赤經則
可矣用表必日食時以太陽實度月食時以太隂實度
查初行本宫下方内所對度分乃為日月當食時赤經
度分即以之查前表距宿赤道度焉推算表法具在測
量全義中
新法算書卷七十二
