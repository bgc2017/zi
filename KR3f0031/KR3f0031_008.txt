欽定四庫全書
數學卷八
婺源江永撰
算賸
(勿菴先生論算極詳觀玩之餘有得輒筆之此為賸義云爾)
正弧三角會通
弧三角以正者為宗舉要第二卷論正弧其法散出有見於求餘角法者有見於第四卷次形法者又有現於塹堵測量環中黍尺二書者今為薈萃總計求角求邊凡若干正法别法附之臚列分明學者庶易會焉
甲為正角乙酉春分角丙為交角乙
甲猶赤道乙丙猶黃道丙甲猶距緯
正弧隨處有之不止黃赤道而以黃
赤為喻諸法皆以甲乙丙為鈐記
求丙甲邊法
半徑與乙角正弦若乙丙正弦與丙甲正弦(中二率相乘為實首
率為法除實得四率)
半徑與乙角正切若乙甲正弦與丙甲正切
丙角正切與半徑若乙甲正切與丙甲正弦
若欲用半徑為首率以省除則為半徑與丙角餘切
若乙甲正切與丙甲正弦
半徑與丙角餘弦若乙丙正切與丙甲正切
又法丙角餘弦與半徑若乙丙餘切與丙甲餘切
乙甲餘弦與半徑若乙丙餘弦與丙甲餘弦
若欲用半徑為首率以省除則為半徑與乙甲正割
若乙丙餘弦與丙甲餘弦
又法半徑與乙甲餘弦若乙丙正割與丙甲正割
又法乙丙餘弦與半徑若乙甲餘弦與丙甲正割
又法乙丙正割與半徑若乙甲正割與丙甲餘弦
丙角正弦與半徑若乙角餘弦與丙甲餘弦
半徑與丙角餘割若乙角餘弦與丙甲餘弦
又法不用四率但以加減法取初數即得丙甲正弦
法為乙角度與乙丙邊度相併為總弧相減為存弧
各取餘弦如法相加減(總弧過象限則兩餘弦相加不過象限則相減)折半
為初數即為丙甲正弦
求乙丙邊法
乙角正弦與半徑若丙甲正弦與乙丙正弦
若欲用半徑為首率以省除則為半徑與乙角餘割
若丙甲正弦與乙丙正弦
乙角餘弦與半徑若乙甲正切與乙丙正切
若欲用半徑為首率以省除則為半徑與乙角正割
若乙甲正切與乙丙正切
丙角正弦與半徑若乙甲正弦與乙丙正弦
若欲用半徑為首率以省除則為半徑與兩角餘割
若乙甲正弦與乙丙正弦
丙角餘弦與半徑若丙甲正切與乙丙正切
若欲用半徑為首率以省除則為半徑與丙角正割
若丙甲正切與乙丙正切
半徑與丙甲餘弦若乙甲餘弦與乙丙餘弦
又法乙甲餘弦與半徑若丙甲正割與乙丙正割
又法丙甲正割與半徑若乙甲餘弦與乙丙餘弦
又法半徑與乙甲正割若丙甲正割與乙丙正割
又法乙甲正割與半徑若丙甲餘弦與乙丙餘弦
又法丙甲餘弦與半徑若乙甲正割與乙丙正割
乙角正切與半徑若丙角餘切與乙丙餘弦
半徑與乙角餘切若丙角餘切與乙丙餘弦
求乙甲邊法
乙角正切與半徑若丙甲正切與乙甲正弦
若欲用半徑為首率以省除則為半徑與乙角餘切
若丙甲正切與乙甲正弦
又法乙角正弦與乙角餘弦若丙甲正切與乙甲正
弦
半徑與乙角餘弦若乙丙正切與乙甲正切
又法乙角正割與半徑若乙丙正切與乙甲正切
半徑與丙角正弦若乙丙正弦與乙甲正弦
半徑與丙角正切若丙甲正弦與乙甲正切
甲丙餘弦與半徑若乙丙餘弦與乙甲餘弦
又法乙丙正割與半徑若丙甲正割與乙甲餘弦
又法半徑與丙甲正割若乙丙餘弦與乙甲餘弦
又法乙丙餘弦與半徑若丙甲餘弦與乙甲正割
又法半徑與乙丙正割若丙甲餘弦與乙甲正割
又法丙甲正割與半徑若乙丙正割與乙甲正割
乙角正弦與半徑若丙角餘弦與乙甲餘弦
半徑與乙角餘割若丙角餘弦與乙甲餘弦
求乙角法
乙丙正弦與半徑若丙甲正弦與乙角正弦
若欲用半徑為首率以省除則為半徑與乙丙餘割
若丙甲正弦與乙角正弦
又法丙甲正弦與半徑若乙丙正弦與乙角正割
又法半徑與丙甲餘割若乙丙正弦與乙角正割
又法乙丙正弦與丙甲正弦若乙角正割與乙角正
切
乙甲正弦與半徑若丙甲正切與乙角正切
若欲用半徑為首率以省除則為半徑與乙甲餘割
若丙甲正切與乙角正切
又法丙甲正切與半徑若乙甲正弦與乙角餘切
乙丙正切與半徑若乙甲正切與乙角餘弦
若欲用半徑為首率以省除則為半徑與乙丙餘切
若乙甲正切與乙角餘弦
又法乙甲正切與半徑若乙丙正切與乙角正割
又法半徑與乙甲餘切若乙丙正切與乙角正割
半徑與丙甲餘弦若丙角正弦與乙角餘弦(永補)
乙甲餘弦與半徑若丙角餘弦與乙角正弦(永補)
半徑與乙甲正割若丙角餘弦與乙角正弦(永補)
乙丙餘弦與半徑若丙角餘切與乙角正切(永補)
半徑與乙丙正割若丙角餘切與乙角正切
求丙角法
乙丙正弦與半徑若乙甲正弦與丙角正弦
若欲用半徑為首率以省除則為半徑與乙丙餘割
若乙甲正弦與丙角正弦
又法半徑與乙丙正割若乙角餘切與丙角正切
又法乙甲正弦與半徑若乙丙正弦與丙角餘割(永補)
丙甲正弦與半徑若乙甲正切與丙角正切
若欲用半徑為首率以省除則為半徑與丙甲餘割
若乙甲正切與丙角正切
又法乙甲正切與半徑若丙甲正弦與丙角餘切(永補)
乙丙正切與半徑若丙甲正切與丙角餘弦
若欲用半徑為首率以省除則為半徑與乙丙餘切
若丙甲正切與丙角餘弦
又法丙甲正切與半徑若乙丙正切與丙角正割(永補)
丙甲餘弦與半徑若乙角餘弦與丙角正弦(永補)
半徑與丙甲正割若乙角餘弦與丙角正弦
半徑與乙角正弦若乙甲餘弦與丙角餘弦(永補)
半徑與乙角正切若乙丙餘弦與丙角餘切(永補)
已上求邊求角諸法具足有未備者永為補之一種有數法擇用一焉可也(永所補者亦因他法隅反非臆測也用之可勿疑)垂弧法趨捷
舉要第三卷論垂弧但言可求某邊某角不詳其求之之法以有正弧三角法可攷也然算以捷為貴有可省者徑省之諸形中各求捷法以趨簡易
形内垂弧第一支
(甲乙丙形有丙銳角有角旁相連之乙丙甲丙二邊求對邊及餘兩角)
作垂弧乙丁丁為正角按兩邊夾
一角求對角之邊有環中黍尺專書
備論可不作垂弧欲以垂弧算之第
四卷有捷法但求丁丙邊(半徑與丙角餘弦若)
(乙丙正切與丁丙正切)分甲丁邊(丙丁之餘為甲丁)即用兩分之兩邊以徑得乙甲(丁丙餘弦與乙丙餘弦若丁甲餘弦與乙甲餘弦)甚捷也得乙甲則二角(乙甲)可求矣若按次求之先求丁丙次求乙丁次求丁乙丙分角次求乙甲次求甲角及丁乙甲分角末以兩乙角并之成乙角較為煩曲
形内垂弧第二支(甲乙丙形有丙銳角有角旁相連之乙丙邊及與各相對之乙甲邊求餘兩角一邊)
此當先求甲角(乙甲正弦與丙角正弦若乙丙正弦與甲
角正弦)次求丁丙(半徑與丙角餘弦若乙丙正切與丁丙正切)甲丁(半徑與甲角餘弦若乙甲正切與甲丁正切)分邊併
得甲丙則乙角可得不必求垂弧與
分角
形内垂弧第三支(甲乙丙形有乙丙二角有乙丙邊求甲角及餘邊)
邊在兩角之間斜弧三角之難求者
也若以垂弧法求之當求乙丁邊(半徑
與丙角正弦若乙丙正弦與乙丁正弦)丁乙丙分角(乙丙
餘弦與半徑若丙角餘切與乙角正切)原設乙角内減
丁乙丙得丁乙甲分角次求甲角(半徑與乙分角正弦若乙丁餘弦與甲角餘弦)乙甲邊(甲角正弦與半徑若乙丁正弦與乙甲正弦)甲丙邊(甲角正弦與乙丙正弦若原設乙角正弦與甲丙正弦)此不得不求垂弧與分角者也按次形法三角求邊以角易為邊邊易為角此形雖止兩角亦可弧角相易以次形求之蓋在本形為兩角夾一邊次形即為兩邊夾一角在本形為求對邊之角在次形即為求對角之邊徑用環中黍尺加減捷法以求之一求而甲角可得矣此理隱於次形篇中永於三角求邊悟得之
形内垂弧第四支(甲乙丙形有丙甲二角有乙甲邊求乙角及餘二邊)
此當先求乙丙邊(丙角正弦與甲角正弦若乙甲正弦
與乙丙正弦)次求丙丁(半徑與丙角餘弦若乙丙正切與丙
丁正切)丁甲(半徑與甲角餘弦若乙甲正切與丁甲正切)分
邊併得丙甲而乙角可得
形内垂弧第五支(係二邊相同求三角此形易求略之)
形外垂弧第一支(甲乙丙形有丙銳角有夾角之兩邊求乙甲邊及餘兩角)
自乙角作垂弧於形外補成正角(丁角)本法須求丙乙丁角(乙丙餘弦與半徑若丙角餘切與乙角正切)乙丁邊(半徑與乙丙正弦若丙角正弦與乙丁正
弦)丁丙邊(半徑與乙丙正弦若乙角正弦與丁丙正弦)乃
可求乙甲邊(丁丙内減丙甲得甲丁半徑與甲丁餘弦若乙
丁餘弦與乙甲餘弦)甲角(乙甲正弦與半徑若乙丁正弦與甲角正
弦)及甲乙丁虚角(乙甲正弦與半徑若甲丁正弦與虚)
(乙角正弦末以甲角減半周得原設甲角以甲乙丁虚角減丙乙丁角得原設丙乙甲角)若用環中黍尺加減捷法則不用作垂弧一求可得乙甲邊而甲乙兩角皆可求矣
形外垂弧第二支(甲乙丙形有甲鈍角有角旁之二邊求乙丙邊及餘二角)
本法亦作垂弧於形外補成正角先
求虚邊虚角而後可求形内之邊角
今按此亦可用環中黍尺法角求對
邊(鈍角用大矢)徑得乙丙因以求二角則
不必作垂弧
形外垂弧第三支(甲乙丙形有丙銳角有角旁之乙丙邊有對角之乙甲邊求丙甲邊及餘二角)
本法先求虚邊虚角今按此可求甲
角(乙甲正弦與乙丙正弦若丙角正弦與甲角正弦)乃求丁
丙邊(半徑與丙角餘弦若乙丙正切與丁丙正切)與甲丁
邊(半徑與甲外角餘弦若乙甲正切與甲丁正切)於丁丙内
減甲丁得丙甲而乙角可求
形外垂弧第四支(乙甲丙形有甲鈍角有角旁之甲丙邊及對角之乙丙邊求乙甲邊及餘二角)
本法亦先算虚形今按此亦可倣第
三支先求乙角次求乙戊邊與甲戊
邊於乙戊内減甲戊得乙甲因以求
丙角
形外垂弧第五支(乙甲丙形有丙甲二角一銳一鈍有丙甲邊在兩角之中求一角)
本法作垂弧先算虚邊虚角今按兩
角夾一邊求對邊之角猶之兩邊夾
一角求對角之邊徑易角為邊易邊
為角用加減捷法可得對丙甲邊之
乙角
形外垂弧第六支(乙甲丙形有乙甲二角乙銳甲鈍有丙甲邊與乙銳角相對鈍角相連)
此當先求乙丙邊(有本形弧角比例)次求乙
戊虚邊(半徑與乙角餘弦若乙丙正切與乙戊正切)次求
甲戊虚邊(半徑與甲外角餘弦若丙甲正切與甲戊正切)於
乙戊内減甲戊得乙甲(因以求丙角)
形外垂弧第七支(乙甲丙形有乙銳角甲鈍角有丙乙邊與甲鈍角相對銳角相連)
此當先求丙甲邊餘如六支之法
垂弧又法第一支(乙甲丙形有乙丙邊在兩角之間而兩角並鈍求餘二邊及甲角)
法引丙甲至己引乙甲至戊各滿半
周作戊己邊與乙丙等而己與戊並
乙丙之外角成甲戊己次形依法作
垂弧於次形之内(如己丁)分為兩形本
法求乙甲邊以己丁戊分形求到丁戊(半徑與戊角餘弦若己戊正切與丁戊正切)以己丁甲形求到甲丁(先於己丁戊形求得己角以減原有之巳角餘為丁己甲分角又求得己丁垂弧乃求甲丁法為半徑與己分角正切若己丁正弦與甲丁正切)合之成甲戊以減半周得乙甲求丙甲邊以己丁甲分形求到己甲(丁己甲角餘弦與半徑若己丁正切與己甲正切)以減半周得丙甲乃以己丁甲分形求到甲交角(己甲正弦與半徑若己丁正弦與甲角正弦)按此殊多曲折徑易角為邊易邊為角(或用本形之乙丙兩鈍角易為邊以乙丙邊為角取矢或用次形之己戊兩銳角易為邊取己戊矢皆可)用加減捷法求之即可得甲角(因以求二邊)
垂弧又法第二支(乙甲丙形有丙甲二角有乙甲邊與丙角相對而兩角俱鈍求乙角及餘邊)
如法引甲乙丙乙俱滿半周會於己
成丙甲己次形作己丁垂弧於次形
内分次形為兩本法求乙角惟求分
形兩己角合之為次形己角與乙對
角等又求分形甲丁丁丙并之為甲丙以求到次形己丙減半周為乙丙今按此形當先求乙丙邊(丙角正弦與乙甲正弦若甲角正弦與乙丙正弦)減半周餘為己丙虚邊次求甲丁(乙甲減半周得甲己半徑與甲外角餘弦若甲己正切與甲丁正切)丁丙(半徑與丙外角餘弦若己丙正切與丁丙正切)并得甲丙因以求乙角(有弧角比例)稍為直捷若欲先知乙角如本法可矣(乙甲餘弧與半徑若甲外角餘切與甲己丁分角正切又半徑與甲己正弦若甲外角正弦與丁己正弦又丁己餘弦與半徑若丙外角餘弦與丁己丙角正弦合兩分形己角為次形己角即為本形乙角)
垂弧又法第三支(乙甲丙形有乙丙乙甲兩邊有乙角在兩邊之中)
本法用甲乙戊次形算之今按此亦可用加減捷法徑得丙甲
垂弧又法第四支(乙甲丙形有丙角有甲丙邊與角連有乙甲邊與角對)
法用甲己戊次形(甲己為甲乙減半周之餘甲戊為甲
丙減半周之餘戊角為丙之外角)作垂弧於内求乙
丙邊及餘兩角按此形當先求乙角
(乙甲正弦與丙角正弦若甲丙正弦與乙角正弦)因知己虚
角(己為乙之外角)次求丁己(半徑與己角餘弦若甲己正切與丁己正切)戊丁(半徑與戊角正切若甲戊正弦與戊丁正切)併得己戊即丙乙因以求甲角若欲先知甲角即於丁戊甲分形求之(半徑與戊角正切若甲戊餘弦與甲角餘切)因以求乙丙邊(丙角正弦與乙甲正弦若甲角正弦與乙丙正弦)
垂弧又法第五支(乙甲丙形有三邊内有乙甲丙甲二邊相同而皆為過弧求三角)
本法用次形作垂弧求之今按此亦
可用加減捷法用甲角角旁兩弧同
度則加減有變例檢環中黍尺五卷
補遺用
垂弧又法第六支(乙甲丙形有丙甲二鈍角有甲丙邊在兩角間)
本法引乙丙乙甲滿半周會于戊成
甲戊丙次形作垂弧於次形外以求
之今按此亦可易角為邊易邊為角
依加減捷法求之徑得乙角(因以求二邊)
垂弧又法第七支(乙甲丙形有乙甲二鈍角有甲丙邊與角對)
法引設邊成丙戊甲次形(戊為乙對角與乙角等)作垂弧於次形外此或先求乙丙(乙角正弦與甲丙正弦若甲角正弦與乙丙正弦)減半周得
丙戊或先求丙戊(戊角正弦與丙甲正弦若甲外角正
弦與丙戊正弦)減半周得乙丙次求丁甲(甲外
角餘弦與半徑若甲丙正切與甲丁正切)丁戊(戊外角正割與半徑
若丙戊正切與丁戊正切)以丁戊減丁甲餘為
戊甲以戊甲減半周餘為乙甲因以求丙角(若欲先知丙角先求甲丁對邊即可求得丙角)
垂弧又法第八支(乙甲丙形有丙鈍角有角旁之兩邊丙乙丙甲)
本法用甲戊丙次形作甲丁垂弧引
丙戊會于丁可求乙甲邊及甲乙二
角今按此亦可用加減捷法徑求乙
甲對邊以求二角
垂弧又法第九支(乙甲丙形有甲鈍角有乙丙邊與角對丙甲邊與角連)
法用丙戊甲次形自丙角作垂弧與
甲戊引長邊會于丁此當先求乙角
(本形有甲丙對邊比例)即戊角(對角等)次求丁甲
與丁戊(與第七支求法同)於丁甲内減丁戊
為甲戊即得乙甲(法同七支)因以求丙角
次形
斜弧三角求邊必弧角互易用次形求之圖與算例皆詳明矣然易角為邊有用本角度有用外角度恐易混淆今為釐定開例如左庶用之無誤
凡三角俱銳者在圓周之兩角用本角度其交角用外角度(凡三邊必有一邊就圓周凡三角必有兩角在圓周餘一角為交角)
凡三角俱鈍者皆用外角度
凡兩鈍一銳鈍在圓周銳在交角者亦猶三角俱鈍皆用外角度
凡兩鈍一銳銳在圓周者用本角度其兩鈍一在圓周者用外角度一在交角者用本角度
凡兩銳一鈍銳在圓周者用本角度鈍在交角者用外角度
凡兩銳一鈍銳在圓周者用本角度在交角者用外角度鈍在圓周者亦用外角度
方圓冪積比例補
勿菴先生有方圓冪積一卷凡方圓周徑面體比例
詳矣愚思之尚有方分圓分比例一法從來算家只
言冪積不言圓分而范蜀公論律云古者以竹為律
竹形本圓今以方分置算此律非是算法圓分謂之
徑圍方分謂之方斜今圓分而以方法算之此算數
非是圓分始見於此圓體用圓分置算亦有至理平
圓有平圓分立圓有立圓分得其方分圓分之比例
則有大小不等之渾圓欲得倍數之差但借立方算
之其得數甚真亦甚捷故為補此一法
先論圓方
算家命平方如棋局之罫者謂之冪合計之謂之積夫
有平冪亦當有平員之分合衆小員之分亦可謂平員
之積由是而為立員亦可謂立員分立員積矣夫所謂
員分者非若句股容員虚其四隅也非若方體圓體中
容得幾個圓球球間尚有空隙也大小相容全無隙罅
但有圓之數而無圓之形是所謂員分員積也(如以分作九復
碎丸成粉入大圓中謂此大員能容幾個粉丸)
平方平員
方徑一十冪積一百
員徑一十冪積七十八又五三九八一六
員積一百
方員有相應之理方員同徑員者刓其四角故冪積
七十八有竒若員中復容員必與同徑之方等積大
員與小員猶之大方與小方也此為渾員立方比例
之根
立方立員
立方徑一十立方面冪六百
立員徑一十立員面冪三百一十四又一五九二
六五
立員面員分六百
立員即渾員渾圓面冪與員徑上平冪若四與一故
四倍平員面冪(七八五三九八一六)而得三一四一五九二六五立
方有六面則有六百與渾員面冪若六與三一四一五
九二六五而渾員面上之員分則又與立方面冪等
立方徑一十立方積一千
立員徑一十立員積五百二十三又五九八七七五
立員員分積一千
立方立員同徑又刓去立方之八角則其積之比例
若六與三一四一五九二六五故立方積一立員積
五二三五九八七七五猶之立方面冪六而立員面
冪三一四一五九二六五也積與冪既同比例矣則
立員員分積亦必與立方積等猶之立員面員分與
立方面冪等也然則平冪面冪體積方與方員與員
其數皆等借立方可算立員而大小員球之差數睹
矣
借立方算立員
立方徑自乘又以徑乘之得積立員亦徑自乘又以
徑乘之得立員員分積
求大小員差幾倍數
大小員各算得積以積相較得差數若干倍
假如
今有大員徑三十六小員徑六徑之差六倍實體差若
干倍
答曰大員比小員差二百一十六倍
法以大員徑自乘再乘得積四萬六千六百五十
六小員徑自乘再乘得積二百一十六其差亦二
百一十六倍(小員徑自乘即大員徑故差數與積數等二百一十六自乘亦即四萬六
千六百五十六)
又法以兩徑差倍數自乘又以倍數乘之所得亦同
今有大員徑一十五萬小員徑八千徑之差十九倍弱
實體差若干倍
答曰大員比小員差六千五百九十倍竒
法以十五萬自乘再乘大數三三七五以八千自
乘再乘小數五一二大數為實小數為法除實得
六千五百九十餘實三三七四八幾盡故差六
千五百九十倍竒(大小數相差甚遠借十九倍數自乘再乘得六千有竒故知首
位是六千不用十九倍數算者不正得十九倍也)
此日月實體約略差數也利西泰云日大於月六千
五百三十八倍竒亦相近
今有大員徑十五萬小員徑二萬八千二百七十四徑
之差五倍有竒實體差若干倍
答曰大員比小員差一百四十九倍竒
法以小員自乘再乘得二二六二七七五為小
數大員大數如前以大數為實小數為法除實得
一百四十九幾盡故差一百四十九倍有竒
此日與地實體約略差數也利西泰云日大于地球
一百六十五倍竒盖利算日徑不啻十五萬里
今有大員徑二萬八千二百七十四小員徑八千徑之
差三倍半有竒實體差若干倍
答曰大員比小員差四十四倍竒
法以大員積二二六二七七五為實小員積五
一二為法除之得四十四除實二二五二八不盡
故差四十四倍竒
此地與月實體約略差數也利西泰云地大于月三十
八倍竒盖利算月徑不啻八千里
右法算渾圓大小相較之差徑捷如此是亦少廣之一
法不可缺也西人言日大于地五倍有竒又云一百六
十五倍有竒兩數甚相懸今為補此一法則日大于地
實體與圓徑迥殊不足詫異矣
授時弧矢割員論
勿菴先生員容方直簡法附授時歷弧矢割員圖又
附求黃赤内外度及黃赤道差法論之云割員之算
始于魏劉徽至劉宋祖冲之父子尤精其術唐宋以
算學設科古書猶未盡亡邢臺盖有所本又云郭法
用員容方直起算冬至西法用三角起算春分郭用
三乘方以先得矢西用八綫故先得弦又西專用角
而郭只用弧西兼用割切而郭只用弦種種各别而
不害其同有所以同者在耳且夫數者所以合理也
歷者所以順天也法有可采何論中西理所當明何
分新舊在善學者知其所以異又知其所以同去中
西之見以平心觀理則弧三角之詳明郭圖之簡括
皆足以資探索而啟深思務集衆長以觀其會通母
拘名相而取其精粹
永按員者徑一圍三古人之恒言算家之麤率精於算
者覺其未密因有割員之術劉祖二家各有其率盖欲
細求周徑之數以究平員之理未嘗剖之為度析之為
分一一紀其縱横之線以為測天之用也而算家相承
仍用粗疎之率立弧矢之法或欲以曲承直則用三乘
方法求矢或欲以直求曲則因矢以求半背弦差夫弧
背為曲線矢弦為直線亘古無相通之率不相通而強
求之其所求得之數必非真數也嘗讀唐荆川先生弧
矢論攷其求背弦差之法所得者猶是徑一圍三六邊
之周耳(古法求背弦差以矢自乘為實以徑為法除實得半背弦差倍之得全背弦差假令半徑五自
乘二十五徑十除之得二五倍之得五加於徑則半周十五又如徑十而矢一者通弦六餘通弦八餘矢二以
矢一自乘以徑除之得小數一倍之得二為背弦差又以餘矢二自乘以徑除之得小數四倍之得八為背弦
差合兩通弦十四加兩差一半周亦得十五皆徑一圍三之半周)又攷邢氏律歷考衍
三乘方求矢法迂曲煩難究其所得仍是圍三徑一耳
此繇八線表未傳不得不如此立算其得數之非真雖
前人亦未嘗覺也郭太史之求黃赤内外度也先用帶
從三乘方求各度矢則得矢不真矣其既得黃赤内外
半弧弦也又以矢度求半背弦差加入半弧弦得内外
半弧背則弧度亦非真其求黃赤差法以黃道矢求半
背弦差減黃道度得黃道半弧弦則得弦不真矣其既
得赤道半弧弦也又求半背弦差以加半弧弦得赤道
則赤道度亦非真夫表端者景正源潔者流清徑一圍
三其本先失而欲數之不謬也得乎八線之法至矣剖
析大員細至分秒無非真數以此測天絲毫莫能遁勿
菴先生與郭法相提而論謂種種各别不害其同有所
以同者在愚謂郭圖之弦矢猶八線之弦矢也其句股
皆八線所有之句股也究之郭法西法終莫能同有所
以不同者在耳先生謂當去中西之見平心以觀理夫
理有真亦有似使其似是而未真則與真者相提而論
雖欲比而同之不可得矣
先生於郭法各添註求黃道矢與弦則註云本法如此
原法如此(見前)求内外半弧背及赤道則註云原法如此
(見前)今省夫存其本法而不論其法之是與非豈不欲苛
求古人與原法所有而今省豈微覺其法之未善與愚
豈敢苛論古人哉亦謂理數精微不能兩是寧割愛於
古人耳
授時平立定三差辯
勿菴先生云授時歷於日躔盈縮月離遲疾並云以
算術垜積(一作叠)招差立算而今所傳九章諸書無此
術也豈古有而今逸耶載攷歷草並以盈縮日數離
為六段並以段目除其段之積度得數乃相減為一差一
差又相減為二差則其數齊同乃緣此以生定差及平
差立差定差者盈縮初日最大之差也於是以平差
立差減之則為每日之定差矣若其布立成法則直
以立差六因之以為每日平立合差之差此兩法者
若不相蒙而其術巧會從未有能言其故者余因李
世德孝廉之疑而試為思之其中原委亦自歷然爰
命孫㲄成衍為垜積之圖得書一卷
又云平立定差之法古無其術乃郭太史所創為以
求七政盈縮之度所以造立成之根本也據云依立
招差又云依垜疊立招差則似古算術中原有其法
而今採用之然不可攷矣愚因李問為之衍算頗覺
其用法之巧焉
永按郭太史時八線表未傳中土以三差法求七政盈
縮固巧矣愚竊謂其數之不真凡圓體參差截為數段
前後相較其畸零之數無時而盡今以段目除積度相
較至再而即齊同無是理也凡相差之尾數前後疎密
必不均用時有收有棄未有能截然齊一者今恒六因
立差以為每日平立合差之差則其差有常尾數不變
(如太陽盈初縮未限平立合差之尾數恒為八四六二其較以六縮初盈末限平立合差之尾數恒為二四
六八其較以二則盈縮加分盈縮積度之尾數皆有定率太陽如此其他可知)平圓中亦必
無此差率也以至圓之體而欲以平方立方之差求之
圓鑿方枘豈能相入哉或曰郭氏於七政各分段目測
之其數盖得之積候未可謂其無憑也曰凡以儀器測
天雖極精密亦及度分而止必不能得其秒微各段相
較至二差而齊同皆秒微之數則其積度畸零之小數
必有遷就於其間者矣觀太隂遲疾立成其損益積度
至於五度四二九三有竒較西法加減均數為贏而又
不知有二三均加減則其日逐測到之度豈盡與天密
合哉平圓中自然之差數八線表盡之矣使平立定三
差之法果符天運則八線亦可不立既有八線之精算
為一切測圓之凖繩則此外更無岐途别徑亦無取乎
三差之巧矣於古人之法深究其根存而勿用可也
數學卷八
