歴算全書卷四十六
宣城梅文鼎撰
句股闡微卷一
句股正義
首題
句股弦者横曰句縱曰股(亦可云勾縱股横)斜曰弦三線相聯
而成句股弦形也
如圖甲乙丙形甲乙為股乙丙為句甲
丙為弦亦可云(甲乙為句乙丙為股)也凡三角
形或三角俱銳或兩銳一鈍或兩銳一
正(銳鈍正說具三角形算法中)句股弦形者兩銳一正形也其句股
兩線縱横相遇而成者為正角如乙點句弦兩線及股
弦兩線相遇而成者為銳角如甲丙兩點此三線者
或三線俱不等其最大者必弦或兩線等其等者必句
股而無三線等何者以句股弦形一角正故也
一題
句股求弦
法曰句股各自乘併之開方得弦
如圖甲乙句自乘得乙丁方乙丙股自
乘得乙戊方兩方相併即甲巳方開之
得甲丙弦
論曰試移庚實形補辛虚形移丑實形補卯虚形移壬
實形補子虚形移卯午實形補壬辰虚形所移者恰盡
所補者恰足得乙丁與乙戊兩方併恰與甲巳方等
又論曰更以句與股相等之形觀之夫句與股既等則
句股各自乘固方也即句股互相乘亦
方也(凡句股不等則句股互相乘必是矩形)如丁戊大方
平分方邊於方形中縱横作線中分四
小方形必等又句與股既等則弦上方邊為句股各自
乘兩方之對角線亦為句股互相乘兩方之對角線如
於四小方形中作四對角線相聯而成一中方形也此
中方形者割小方形四之半即涵小方形二之全就此
圖觀之尤為明顯
又法曰句與股相乘倍之另以句股差自乘併入倍數
開方得弦
論曰甲乙股乙丙句相乘得乙丁矩形
中分為庚戊兩形夫庚形即辛形也倍
之者再加癸卯兩形也乙丙為句丙巳
為股乙巳為句股差自乘得乙子方併入倍數共成甲
壬方為甲丙弦上方也
又法曰句自乘倍股依長闊相差法求之得股弦差加
股為弦
論曰甲乙丙句股形甲丙弦也丁已亦弦也丁戊弦上
方也乙丙股也乙壬亦股也乙子股上
方也餘乙戊子磬折形即句自乘之數
也而已壬矩與乙丑矩等即丙戊矩亦
句自乘之數也此丙戊矩形中乙丙為股加乙壬為倍
股曰長闊相差者丙午為長午戊為闊與壬午等即壬
丙倍股為長闊之差也依法求之得壬午為股弦差
二題
句弦求股
法曰弦自乘内減句自乘餘開方得股
論曰一題句股求弦苐一法句股各自乘併之即弦自
乘數則弦自乘數中有句股各自乘之數也今於弦自
乘數中減去句自乘所存者即股自乘數矣就一題之
圖觀之自見
又法曰句弦相併得數相減得數兩數相乘得數開方
得股
如圖甲乙丙句股形乙丙句甲乙股甲
丙與乙丙相併即乙丁線相減即乙巳
線(乙巳與乙子等)兩線(乙丁乙子)相乘得子丁矩即
甲乙股上方
論曰己午方者已丙線上方即甲丙弦上方也内减子
午形為乙丙句上方所存卯巳未磬折形即甲乙股上
方矣而巳未矩又與丁卯矩等則丁子矩形即卯巳未
磬折形矣亦即甲乙股上方矣
又法曰句自乘倍弦依長闊相和法求之得股弦差用
減弦得股
論曰甲乙丙句股形甲丙弦也丁己亦
弦也丁戊弦上方也乙丙股也乙壬亦
股也乙子股上方也餘乙戊子磬折形
即甲乙句自乘之數也而己壬矩與乙丑矩等即丙戊
矩亦甲乙句自乘之數也此丙戊矩形中乙午為弦乙
丙併午戊為倍弦曰長闊相和者丙午為長午戊為闊
即丙午午戊併為長闊相和也依法求之得壬午為股
弦差
三題
股弦求句
法同二題句弦求股
附長闊相和法
如圖丁乙矩形積九百七十二尺丁甲
為長乙甲為闊兩邊之和共六十三尺
求甲丁甲乙二邊各若干法以和數
自乘得三千九百六十九尺次以積四倍之得三千八
百八十八尺與和自乘相減存八十一尺開方得九尺
(即丁甲乙甲二邊之較數)以與和(六十三尺)相併折半得三十六尺為甲
丁長邊又與和相減折半得二十七尺為甲乙矩邊
長闊相差法(圖同上)
丁乙矩形積九百七十二尺甲乙為闊戊乙為長丙戊
九尺(乙丙即甲乙)為長闊相差數甲乙戊乙二邊各若干
法以較數(九尺)自乘得八十一尺次以積四倍之得三千
八百八十八尺與較自乘相并得三千九百六十九尺
開方得六十三尺(即戊乙甲乙二邊之和數)以與較九尺相併折半
得三十六尺為戊乙長邊又與較(九尺)相減折半得二十
七尺為甲乙短邊
解曰甲午矩形作乙丙對角線成甲乙丙句股形甲丙
長句也甲乙闊股也丙丑長闊和也(甲丑即乙甲)自乘得丙
子大方四倍矩積也并大方内戊丁
庚辛四矩形之積(大方内所容四矩俱與元形等如丙)
(壬矩即甲午矩其八句股形亦俱等元形)相減存己壬小
方開方得巳未邊即甲乙甲丙二邊之較數也(卯亥即甲乙股)
(卯壬即甲丙句則壬亥為兩邊較數即長闊相差也)既得較數與所有和數相加
減得甲乙甲丙二邊矣
若長闊相差法是先有巳未較數故以上法反用之求
得丙丑和得丙丑亦得甲乙與甲丙矣
四題
弦與句股較求句股
法曰弦自乘倍之較自乘用減倍數餘開方得句股和
於是和加較半之得長股和減較半之得短句
論曰甲乙丙句股形甲乙句也乙丁句上方也乙丙股
也丙戊股上方也兩方併共為弦上方辛壬亦句上方
庚已亦股上方兩方併亦共為弦上
方此即弦自乘倍之之數也而兩句
方兩股方併為丙己大方則中間重
叠庚戊方矣此何方乎曰戊子即句股較也庚戊方即
較上方也減之而重叠者去矣所存者為句股和上方
矣故開之得丙丑為句股和也
又法曰弦自乘内減較自乘餘半之以較為長闊相差
法求之得短句加較得長股
論曰甲乙丙句股形甲丙弦也甲丁弦
上方也巳子較也己丑較上方也兩方
相減餘壬辛午未四形半之餘午未二
形而午形又即戊形則是餘未戊二形也此未戊二形
者句股矩内形也故以巳子較用長闊相差法求之得
子丙短句句加較得巳丙長股
五題
股與句弦較求句弦
法曰股自乘内減較自乘餘半之以較為法除之得句
句加較得弦
論曰甲乙丙句股形甲丙弦也甲丁弦
上方也甲巳較也甲戊較上方也庚甲
辛磬折形股自乘數也内減甲戊較上
方所餘丙戊戊壬兩形即為句與句弦較矩内形者二
矣取其一如丙戊形以戊己較除之得己丙句(或不用折半倍)
(較為法除之亦同)
又法曰股自乘以較為法除之得句弦和於是加較折
半得弦減較折半得句
論曰甲乙丙句股形甲丙弦也甲丁弦上方也丙己亦
句也丁戊句上方也所餘庚甲辛折形即股自乘數
也而壬辛形與戊丙形等即壬己矩形
亦股自乘數也以甲巳較除之得甲壬
為句弦和也
又法曰股自乘較自乘相併倍較為法除之得弦弦減
較得句
論曰甲乙丙句股形甲丙弦也甲丁弦
上方也丁己為句上方即戊甲辛磬折
形為股上方矣又己丙矩與庚壬矩等
即甲辛子磬折形亦股上方也加甲子較上方共得辛
丑矩形其庚辛邊即是倍較
六題
句與股弦較求股弦
法同五題
七題
弦與句股和求句股
法曰弦自乘倍之内減句股和自乘餘開方得句股較
於是較加和半之得長股較減和半之得短句
論曰甲乙丙句股形丙丁句股和也丁
子和上方也丁午未子兩句上方丙丑
壬巳兩股上方此即弦自乘倍之之數
也以較丁子和上方則其中重叠一壬丑方矣而此方
之邊即是句股較
又法曰句股和自乘内減弦自乘餘半之以句股和用
長闊相和法求之得句股
論曰丙丁為句股和丁巳為和上方午
乙壬磬折形即弦上方兩方相減餘午
丑壬磬折形分為午丑及丑壬兩形形
之兩邊即句股
八題
股與句弦和求句弦
法曰句弦和自乘内減股自乘餘半之
以句弦和除之得句用減句弦和得弦
(或不用折半倍句弦和除之亦同)
論曰甲乙丙句股形甲丁為句弦和甲巳為和上方又
甲午為弦上方甲子為句上方即未午壬磬折形為股
自乘而子丙矩與午辛矩等即戊辛矩形亦股自乘也
於和方中減之所存者為未丁及戊己兩矩形矣形之
一邊如甲丁即句弦和其一邊如甲未即句
又法曰股自乘得數以句弦和除之得句弦較於是用
加句弦和半之得弦用減句弦和半之得句
論曰甲乙丙句股形甲丁句弦和也甲
戊弦上方也戊己句上方也即午甲未
磬折形為股自乘矣而卯巳矩與午丁
矩等即甲子矩形亦股自乘矣形之甲丁邊即句弦和
丁子邊即句弦較
又法曰句弦和自乘股自乘相併倍和為法除之得弦
弦減和得句
論曰甲丁為句弦和甲戊為和自乘
戊丑為句今試依庚戊矩作丁卯矩
即卯甲丑磬折形亦和自乘矣又甲
巳為弦上方未壬為句上方即未己壬磬折形為股自
乘矣而壬子矩與子丑矩等即未丑矩亦股自乘矣然
此猶在和自乘數中也今另加一股自乘如丑卯矩併
前卯甲丑磬折形共成一庚癸矩形
即為兩自乘相併之數形之甲癸邊
即句弦和之倍形之甲庚邊即是弦
也
九題
句與股弦和求股弦
法同八題
十題
句弦較股弦較求句股弦
法曰先以兩較相減得即為句股較次以兩較各自乘
相併内減句股較自乘餘開方得弦和較(和句股和也)於是
加股弦較得句加句弦較得股以句弦較加句或以股
弦較加股得弦
論曰甲乙丙句股形甲丙弦也甲巳即股也巳丙股弦
較也甲壬即句也壬丙句弦較也壬己句股較也今試
引甲壬句至丁令甲丁為句股和即丙丁為弦和較也
次作甲戊為和上方午未為句弦較上方午子為股弦
較上方(即庚辰方)兩較上方相併共為午未辰磬折形内減
未子句股較上方餘辰午癸磬折形
即戊午弦和較上方何則試觀丑午
已磬折形句上方也子戊形亦句上
方也今於丑午已磬折形中減丑申及辛巳兩矩形即
是於子戊形中減卯子亥磬折形也然則所餘之辰午
癸磬折形非即戊午方乎
又法曰兩較相乘倍之開方亦得弦
和較以下同前法
論曰甲乙丙句股形試引甲丙至丁
得甲丁為句股和甲戊為和上方(甲未股未丁句)丁子己子句
也丁辛己壬弦也子辛子壬句弦較也未子亥子股也
未申亥卯弦也子申子卯股弦較也然則卯辛與申壬
兩矩形即是兩較相乘倍之之數也此兩矩形者即戊
午弦和較上方(丙丁為弦和較)何則未申亥磬折形句實也子
戊方形亦句實也今試於未午亥磬折形減辛丙庚亥
兩矩形(辛未及亥壬皆是弦和較)及子午方即是於戊子方中減癸
子丑磬折形也然則卯辛與申壬兩矩形非戊午方乎
十一題
句股較句弦較求句股弦(句短股長看此題)
法曰先以兩較相減得即為股弦較次以兩較各自乘
相減餘為實倍股弦較為法用長闊相差法求之得句
句加句股較得股句加句弦較得弦
論曰甲乙丙句股形丙乙股丙戊句
丙巳弦戊乙句股較戊己句弦較乙
巳股弦較乙丁亦為句丙丁為句股
和丙庚為和上方辛壬為句股較上方辛子為句弦較
上方兩較上方相減餘丑子午磬折形夫乙子卯磬折
形句實也壬庚方亦句實也今於壬庚方中作未庚未
申兩矩形與己丑寅卯兩矩形等即所餘壬申形與丑
子午磬折形等矣於是依壬申形作
壬亥形此形壬酉為長壬癸為闊與
壬辰等即辰未未酉為股弦較之倍
為長闊之差
按此法句股較句弦較相減得股弦較即三較皆備矣
十題第一法句弦較股弦較相減得句股較即三較亦
皆備矣既皆備三較則法可互用特以就題立法則法
固各有攸屬耳
十二題
句股較股弦較求句股弦(股短句長看此題)
法同十一題
十三題
句弦和股弦和求句股弦
法曰兩和各自乘相併兩和相減即為句股較自乘用
減相併數餘開方為弦和和(弦和弦也句股和也弦和和弦與句股和相併也)
於是内減句弦和得股内減股弦和得句内減句股得弦
論曰甲乙丙形甲乙股也丁乙股
弦和也乙午股弦和上方也乙丙
句也丙子句弦和也丙未句弦和
上方也甲丙弦也丙丑股也丑巳
句也甲己弦和和也甲壬弦和和
上方也乙午丙未兩方併較甲壬
方則兩方多一句股較自乘之數何則試觀甲壬方中
弦股句三方即乙午丙末兩方中弦句股三方也甲壬
方中股弦矩二句弦矩二即乙午丙未兩方中股弦矩
二句弦矩二也無或異也所異者惟甲壬方中餘句股
矩二與乙午丙未兩方中餘弦方一則弦方一與句股
矩二其較為句股較上方何則試
觀另圖甲丙弦也甲丁弦上方也
甲乙股也乙丙勾也甲乙丙形句
股矩形之半也而丙巳丁丁子丑
丑午甲三形皆與甲乙丙形等共
四形即得句股矩之二也中餘乙巳子午方即句股較
上方然則乙午丙未兩方併較甲壬方不多一句股較
上方乎故於兩方中減之即得甲壬方也
又法曰兩和相乘倍之開方得弦
和和以下同前法
論曰甲乙丙形乙丁股弦和也丁
午句弦和也乙午兩和矩内形也丙子句弦和也丙辛
股弦和也丙未兩和矩内形也甲丙弦也丙丑股也丑
巳句也甲己弦和和也甲壬弦和
和上方也乙午丙未兩矩形與甲
壬方形等者兩矩形中有兩弦方
甲壬形中有弦方一股方一句方
一亦即兩弦方也兩矩形中有股
弦矩二句弦矩二句股矩二甲壬形亦有股弦矩二句
弦矩二句股矩二也然則乙午丙未兩矩形不與甲壬
方形等乎
十四題
句股和句弦和求句股弦
法曰先以兩和相減得即為股弦較次以兩和各自乘
相減餘為實倍股弦較為法依長闊相差法求之得句
句減句股和得股句減句弦和得弦
論曰甲乙丙形甲丁句弦和也甲戊句
弦和上方也巳丁句股和也子戊句股
和上方也兩和之較為甲巳兩方之較
為壬甲丑磬折形此形中午甲未磬折形句實也癸戊
方形亦句實也夫癸戊方形與壬甲丑磬折形其餘為
辛未午丁兩矩形今試作癸寅寅申兩矩形與之等即
戊申矩形與壬甲丑磬折形等矣此戊申矩形戊庚為
闊即句與庚癸等癸卯卯申為倍數為長闊之差
十五題
句股和股弦和求句股弦
法同十四題
十六題
句股弦形中求容方
先論曰凡於句股形中依句股兩邊作方形或矩形則
作形之外所餘之角形二自相似亦與元形相似如圖
甲乙丙元形作壬丁乙子方形則此形之外所餘甲丁
壬及壬子丙兩角形自相似何則謂甲
丁與壬子相似丁壬與子丙相似也若
作壬丁乙子矩形亦然又此兩形之各兩邊與元形之
兩邊相似何則謂甲丁壬子兩邊與甲乙邊相似丁壬
子丙兩邊與乙丙邊相似也於是遂生求容方之法如
左(獨不能生求容矩之法者以容方則甲丁丁壬兩邊即甲乙邊壬子子丙)
(兩邊即乙丙邊也若容矩則否)
法曰句股相乘為實併句股為法除之得方邊
論曰甲乙股乙丙句相乘得甲丙矩即未午矩矩之甲
午邊甲乙股乙午即句乙子即方
邊何則甲丙弦為甲丙矩形之對
角線亦為甲壬壬丙矩形之對角線則甲乙丙與甲丑
丙甲丁壬與甲未壬壬子丙與壬亥丙各角形自相等
今於甲乙丙甲丑丙相等之兩形中各減去相等之角
形所餘之乙壬方與壬丑方必等次於兩方各加一同
用之子亥矩則乙亥矩與子丑矩亦必等而子午矩與
乙亥矩等亦即與子丑矩等然則甲丙矩不與未午矩
等乎
又法曰句自乘為實併句股為法除之得餘句用減句
餘即方邊
論曰甲乙丙句股形乙丙句自乘
得乙丁方即未已矩形形之戊丙
即股丙巳即句丙子即餘句乙子即方邊何則丑丁形
即子巳形也壬乙形即壬戊形也然則乙丁方即未巳
矩也
十七題
句股弦形中求容圓
法曰句股相乘倍之為實句股弦共為法除之得容圓
徑(或句股相乘為實句股弦共為法除之得容員之半徑或句股相乘半之為實句股弦併而半之為法)
(除之得容圓之半徑)
論曰試於形之三邊截取己子未
三點令乙子與乙巳等甲巳與甲
未等丙未與丙子等次於已子未
三點各作己丁未丁子丁三線為
形三邊之垂線必相遇於丁而相
等何則試先就己甲未丁四邊形論之甲巳甲未兩邊
等己未兩角皆正即巳丁未丁兩線必等依顯未丁與
子丁兩線子丁與巳丁兩線亦必各等然則丁即圓心
三線即圓之半徑矣果何術以求之乎曰試作甲丁丙
丁乙丁三對角線平分甲乙丙三角及丁角因平分三
个四邊形為六个三邊形各兩相等次引乙丙至壬令
丙壬與甲已等則乙壬線為甲乙丙三邊之半何則乙
子者乙子乙巳之半丙子者丙子丙未之半丙壬者甲
未甲巳之半然則乙壬者甲乙丙三邊之半矣次引長
巳丁線至亥令己亥與乙壬等必相與為平行次作壬
亥丙午兩線與子丁線等而相與為平行末作丙亥對
角線則乙亥矩形與甲乙丙元形等何則乙巳丁子方
形在元形之内丙子丁角形亦在元形之内丁午丙角
形雖不全在元形之内然即丙未丁形而倒置之凑合
丙子丁形而成子午矩形者也至於壬午矩形全在元
形之外然亦即甲巳丁甲未丁兩形顛倒凑合而成者
也然則乙亥矩形與甲乙丙元形等矣於是以句股相
乘半之得甲乙丙元形即乙亥矩形以乙壬三邊之半
分之得子丁為圓半徑或以三邊之全分元形之倍亦
得圓之半徑或三邊之全分元形
之四倍得全圓徑也
又法曰句弦股三邊半之内減弦
得圓之半徑(或倍弦用減三邊之全得全圓徑)
論曰甲乙丙元形之乙角既是正
角乙子丁乙已丁兩角又是正角即子丁己亦必正角
然則子丁己乙形必是正角方形而四邊等矣即乙巳
乙子兩邊必與丁己丁子圓之兩半徑等矣此乙已乙
子之兩邊果何術以求之乎依前論乙壬線為三邊之
半而丙壬即甲未也丙子即丙未也則子壬線即甲丙
弦也於是子壬弦減乙壬三邊之半得乙子即圓之半
徑若倍弦數用減三邊之全得全圓徑
又法曰句股併以弦減之得全圓徑
論曰如前圖乙丙句也丙壬與乙巳併即甲乙股也何
則以丙壬與甲巳等故也壬子即甲丙弦也何則以丙
壬與甲未等丙子與丙未等故也於是以子壬弦減壬
己句股併得子巳為圓之全徑何則以乙子與子丁等
乙巳又與乙子等故也
巳上十七題除求方求圓二題餘十五題已盡句股
弦之藴矣然論其題則不止於己上十五題也今反
覆推之凡得一百四十四題雖究其歸不出於己上
十五題之法要亦不可不備使習者得以按題而索之
逐類而通之也
勾股較勾股和句股較句弦和句股較股弦和
句弦較句弦和句弦較句股和句弦較股弦和
股弦較股弦和股弦較句股和股弦較句弦和
已上共九題
(句)和和
弦較較句較較股較較
弦和較句和較股和較
弦較和句較和股較和
巳上十則各以(股)三則配之得三十題
各以(股弦和)三則配之得三十題
各以(股弦較)三則配之得三十題
又巳上十則(股)和和為一則以下九則配之得九題
弦較較為一則以下八則配之得八題
句較較為一則以下七則配之得七題
股較較為一則以下六則配之得六題
弦和較為一則以下五則配之得五題
句和較為一則以下四則配之得四題
股和較為一則以下三則配之得三題
弦較和為一則以下二則配之得二題
句較和為一則以下一則配之得一題
已上共一百四十四題學者按題而索之逐類而通
之要不出於前所列之十五題也
又一題(後十四題盡句股之變)
容方與餘句求餘股與餘股求餘句因得全句全股
法曰方邊自乘以餘句除之得餘股以餘股除之得餘
句各以所得加方邊因得全句全股
論曰乙丁方邊也自乘得乙壬方
即壬丑矩(論詳前十六題)故以己壬(即丙未餘)
(句)除之得子壬(即甲丁餘股)以子壬除之得己壬因以己壬
加壬丁共已丁即句以子壬加壬未共子未即股
又法曰以餘句除方邊(餘句小于方邊)得數即用以乘方籩得
餘股或以方邊除餘股(餘股大于方邊)得數即用以除方邊得
餘句
論曰方邊為餘句餘股連比例之中率以前率餘句比
中率方邊則方邊為幾倍大即以中率方邊比後率餘
股則餘股亦必為幾倍大又以後率餘股比中率方邊
則方邊為幾倍小即以中率方邊
比前率餘句則餘句亦必為幾倍
小故得數者得其幾倍大幾倍小之數也大用乘小用除
又二題
餘句餘股求容方因得全句全股
法曰餘句股相乘開方得方邊各以餘句股加之得全
句股
論曰子壬即餘股也己壬即餘句
也丑壬矩即乙壬方也(論詳前十六題)因
以甲丁(餘股)丙未(餘句)加之得全股(甲乙)全句(乙丙)
又法曰以餘句除餘股(以小除大)得數開方得中率之比例
於是以中率之比例除餘股得方邊或以中率之比例
乘餘句亦得方邊
論曰餘句餘股之於方邊為連比例之前後率今以己
壬餘句比子壬餘股得子壬為幾倍大即是以己壬線
上方比己壬線與子壬線上矩得丑壬矩為幾倍大也
而丑壬矩又與乙壬方等開方得連比例之中率者以
方則邊等邊等則比例連故也既得連比例之中率則
方邊可得而知矣
右兩題宜附前十六題之後
又三題
句股弦形句股較求句股弦
法曰形四倍之另以較自乘相併開方得弦次依前四
題法求句股
論曰甲乙丙形四倍之即丁已甲子午丁
丙未子與甲乙丙四形也乙巳為句股較
乙午為較上方四形與一方相併成甲子方開方得甲
丙弦
又法曰形八倍之另以較自乘相併開方得句股和於
是和加較折半得股和減較折半得句
論曰甲乙丙形八倍之即甲丙丙丁丁
己己甲四矩形也乙子為句股較乙午
為較上方四矩形與一方併成丑未方開方得丑壬為
句股和
又法曰形倍之以句股較用長闊相差法求之得句句
加較得股
論曰甲乙丙句股弦形倍之得乙丁矩形甲乙股乙丙
句已甲較即乙已與乙丙句等丙巳為
句上方丁句為句與較矩内形今試商
得乙丙為句乙巳加已甲為股
又四題
句股弦形句股和求句股弦
法曰形四倍之另以句股和自乘相減開方得弦次依
前七題法求句股
論曰甲乙丙形四倍之者甲乙丙丙戊
丁丁己辛辛壬甲四形併也乙壬為句
股和乙巳為和上方内減四形併餘甲
辛丁丙方開方得甲丙弦
又法形八倍之另以句股和自乘相減開方得句股較
於是用加和折半為股用減和折半為句
論曰甲乙丙形八倍之者即甲丙丙丁
丁辛辛甲四矩形併也午戊為和戊壬
為和上方内減四矩形併餘子乙未丑
方開方得子乙為句股較
又法曰形倍之以句股和用長闊相和法求之得句句
減和得股
論曰甲乙丙句股弦形倍之得乙巳
矩形甲乙股乙丙句併之為和今試
商得乙丙為句用減和餘甲乙即股
又五題
句股形中求從直角(句股相聯處)至弦作垂線(與弦相交為直角)分
元形為兩句股形
法曰弦上方句上方併之内減股上方餘半之以弦除
之得數為弦上作垂線之處於是以所得數與句依句
弦求股法作垂線
論曰甲乙丙元形求從直角作乙午線為甲丙之垂線
甲丙弦也甲丑弦上方也乙丙句也乙己句上方也
甲乙股也乙辛股上方也夫乙辛方中之子未方乙午
線上方也乙巳方中之丁申方亦
乙午線上方也即兩方等矣又乙
辛方中之子辛未磬折形甲丑方
中之午壬方也今於甲丑乙巳兩
方中減乙辛方即於兩方中減丁申方與午壬方也兩
方中所存者為申巳丁磬折形午丑壬磬折形矣而申
巳丁磬折形又與丑卯方等半之即得午丑矩故以丙
丑弦除之得丙午(若乙辛方與甲丑方併内減乙巳方餘半之以弦除之得甲午同上論)
(按此法不但可施諸句股直角形凡銳角鈍角形俱可用此法求垂線)
又法曰句股相併得數相減得數兩得數相乘以弦除
之得數用減弦餘半之得數為弦上作垂線之處
如圖甲乙丙形甲乙股乙丙句相
加得甲丁相減得甲巳甲丁與甲
巳相乘得數以甲丙弦除之得甲
子用減弦餘丙子半之於午即午點為弦上作垂線之處
一論曰甲丁偕甲已矩内形及乙巳上
方形併與甲乙上方形等如圖壬丁矩
甲丁偕甲巳矩内形也(甲壬與甲巳等)辛甲未
磬折形即壬丁矩也(壬未矩與辛丁矩等)未辛方
乙巳上方也併之得甲戊方即甲乙上方
二論丁已甲線貫圜心於乙庚甲線切圜周於庚乙庚
甲為直角夫丁甲偕巳甲矩内形與甲庚線上方形等
何則乙庚庚甲兩線上方形與乙甲線上方等而丁甲
偕巳甲矩内形及乙已上方併亦與
乙甲線上方等(一論之圖可見)此兩率者每
減一相等之乙庚乙巳兩線上方則
甲丁偕甲巳矩内形與甲庚線上方形必等
三論曰丙甲線不貫圜心於乙庚甲
線切圜周於庚乙庚甲直角形乙午
甲亦直角形兩形合一乙甲弦則乙
庚庚甲兩線上方併與乙午午甲兩線上方併必等又
乙午子直角形則乙午午子兩線上方併與乙子線上
方等夫午甲上方形中原有(一論之圖可見)丙甲偕子甲矩内
形及午子上方形今於乙甲上方形
中減乙庚上方形即減去同乙庚之
乙子上方同乙子之乙午午子兩線
上方然則所餘之丙甲偕子甲矩形與甲庚上方形必等
四論曰前甲丁偕甲巳矩内形與庚甲上方等(二論之圖)甲
丙偕甲子矩内形與庚甲上方亦等(三論之圖)則兩矩形自
相等而等角㫄之各兩邊彼此互相
視何則試引戊子壬己兩線相遇於
丑而成甲丑形夫甲戊與甲丑兩形
同在戊丑丙己兩平行線内等高則兩形之比例若其
底甲丙與甲己之比例依顯甲壬與甲丑兩形之比例
亦若其底甲丁與甲子之比例夫甲戊與甲壬兩矩形
元等則甲戊形與甲丑形即甲壬形與甲丑形也即甲
丙與甲己之比例亦即甲丁與甲子之比例也更之則
甲丙與甲丁之比例亦若甲己與甲子之比例
於是以甲丙為一率甲丁為二率
甲己為三率二三率相乘一率除
之得四率甲子也既得甲子用減
甲丙餘丙子半之于午得午點為弦上作垂線之處何
則試作乙子線與乙丙同為圜之半徑即等而成乙丙
子兩邊等角形則午點折丙子之半必是直角(此法不但可施)
(諸句股形凡銳角鈍角形俱可用此法求垂線)
右既得乙午垂線即分甲乙丙原形為甲午乙乙午丙
兩句股形此兩形者自相似亦與元形相似
又六題
句股弦形中求依弦一邊容方
法曰先依又五題法求形中垂線次以弦與垂線相乘
得數併弦與垂線為法除之得方邊
論曰甲乙丙元形乙丁為垂線求依甲乙弦作方邊如
子丑而成子午方形夫甲乙丙元形與
己乙午分形相似何則以己午與甲丙
平行故也次觀己午與未丁等即乙未
與己午併是乙丁垂線也然則乙丁偕甲丙併而與甲
丙若乙未偕己午併(即乙丁垂線)而與己午
又法曰垂線自乘併弦與垂線為法除之得數用減垂
線得方邊
論曰乙丁偕甲丙併(一率)而與乙丁(二率)若乙未偕己午併
(三率即乙丁)而與乙未(四率)於是以乙未減乙丁餘未丁即方
邊(此法不但可施諸句股形凡銳角鈍角形俱可用)
又七題
句股形中求分作兩邊等三角形二
法曰弦半之即是兩邊等之一邊
論曰甲乙丙形半弦於丁於是以丁為
心甲丙為界作圜必切乙角得乙丁與
半弦等因成乙甲丁乙丙丁兩形皆兩邊等三角形也
又八題
斜三角形中求作中垂線分元形為兩句股形
法具又五題
又九題
斜三角形中求積
先分别是銳角形或是鈍角形(若是正角形法以句股相乘半之即得)法
曰大中小三邊用小中兩邊依句股求弦法求之若求
得數小於大邊即是銳角形大則是鈍角形
銳角形求積法曰任取一角依又五題求中垂線(銳角形求)
(中垂線任取一角皆在形内)分元形為兩句股形次以兩分形句與
股各相乘半之得積
論曰甲乙丙銳角形先求得乙丁中垂
線分為甲丁乙乙丁丙兩句股形次以
甲丁與丁乙丁乙與丁丙各相乘得丁戊與丁己兩矩
形各半之得甲乙丙形之積(或以乙丁因甲丙之半亦得或以甲丙因乙丁之半)
(亦得)鈍角形求積法(於鈍角至對邊作垂線則垂線在形内法同前)於銳角至對
邊作垂線則垂線在形外而引對邊出形外凑之曰大
邊上方内減中小兩邊上方餘半之以中邊除之得引
凑數與小邊為股弦求句得垂線(或以小邊除半數得引凑數與中邊為句)
(弦求股亦得垂線)既得垂線則與引凑數凑成一小句股形又
以垂線與引凑數偕元形之邊凑成一大句股形大小
兩句股形相減得所求
論曰甲乙丙鈍角形(乙為鈍角)求從丙銳角作丙丁垂線而
引乙丁線以凑之(從甲角作垂線亦在形外兹不備述)夫甲丙上方元包
丙丁與甲丁兩邊上方今於甲丙上
大方中減乙甲乙丙上兩方即是減
丙庚與子午兩方為乙丙上方減甲
子方為甲乙上方也而所存者為丁
子子辛兩矩形矣半之為子丁一矩
形以中邊乙子除之得乙丁為引數
也丙丁乙為小句股形丙丁甲為大
句股形兩形相減得甲乙丙斜三角形積
又法曰三邊數併而半之以每邊數各減之得三較數
三較連乘(任以二較相乘得數又以一較乘之)得數又以半數乘之得數
開方得積
如後圖甲乙丙元形求其積
一圖一論曰壬乙矩形與元形等
論同前十七題所論乙亥矩
形與甲乙丙元形等
二論曰丁心方與乙戊相乘又與乙戊相乘開方與乙
二圖壬矩形等如圖子壬二丑壬三相
乘得六為子丑矩形今以子壬二
自乘得四為子卯方即壬寅邊以
丑壬三乘之得十二為丑寅矩形又以三乘之得三十
六為辰寅矩形即午丑方形故開方得辰午六與子丑
三圖矩形等
三論曰丁心偕戊庚矩形與乙丁相乘
其所得數與丁心方偕乙戊相乘所得
數等何則乙丁心形與乙戊庚形相似之形也戊庚與
丁心若乙戊與乙丁則戊庚偕丁心矩形(即庚未矩形)與丁
心方(即己戊方形)亦若乙戊與乙丁也
四論曰丙丁偕丙戊矩形與丁心偕戊庚矩形等(就一圖觀)
(之)何則心丁丙形與丙戊庚形相似之形也夫庚乙線
平分丁乙甲角庚戊為丙戊之垂線則戊為直角次依
丙戊線截取丙卯線作卯庚線為丙卯之垂線則卯為
直角此庚乙庚戊庚卯三線必相交於庚點三線既相
交於庚點則丙庚線必平分
卯丙戊角而卯丙戊角又即
己心丁角因得心丁丙形與
丙戊庚形為相似之形也兩形既相似則丁心與丁丙
若丙戊與戊庚也
解庚乙庚卯庚戊三線必相交於庚點所以然之故
庚心乙界作圈次依甲乙丙形作丙丁辛形次引
乙丁線至癸引辛甲線至壬乙庚線平分丙乙甲角則
庚點必是圈心戊點折乙癸線之
半則戊點必直角卯點折壬辛
線之半則卯點必直角乙癸與
乙己等乙丙辛丙為大邊甲丙
丁丙為中邊甲壬丁癸即小邊
總論曰二論丁心方與乙戊相乘又與乙戊相乘所得
數開方與乙壬矩形等夫乙戊半數也亦既得之矣次
欲求丁心與乙戊相乘而丁心不可得三論丁心戊
庚矩形與乙丁相乘所得數與丁心方偕乙戊相乘所
得數等夫乙丁三較之一也則又得之矣次欲求丁心
與戊庚兩線而兩線又不可得四論丁丙偕丙戊矩
形與丁心偕戊庚矩形等夫丁丙丙戊三較之二也則
盡得之矣今法於四論用丁丙偕丙戊二較相乘於
三論用乙丁一較乘之於二論用乙戊半數乘之開方
得數與乙壬矩形等
又十題
斜三角形中求容圓
法曰先依又九題求積次取三邊數併而半之用除積
得員之半徑(或置二較連乘數以半數除之得開方亦得圓半徑)
論曰先依又九題求得乙壬矩
形為甲乙丙元形積次以乙戊
除之(即三邊數之半也)得丁心即圓之半徑(若以三邊之全除元形之倍亦得圓)
(半徑若以三邊之全除元形之四倍得圓全徑)
又十一題
斜三角形中求容方
法同又六題
又十二題
斜三角形有三和數求三邊
法曰三和數相減得三較數各置三較數各以非所較
之邊加減之各半之其加而半者得大邊或中邊減而
半者得小邊或中邊
如圖戊己庚為三和數(戊為大中兩和數己為大小兩和數庚為小中兩和數)甲
為戊庚兩和之較乙為己庚兩和之較丙為戊己兩和
之較於是置甲較數以己為非所較之邊加
而半之得大邊減而半之得小邊置乙較數
以戊為非所較之邊加而半之得大邊減而
半之得中邊置丙較數以庚為非所較之邊加而半之
得中邊減而半之得小邊
論曰戊者大中兩和數也加減用乙者乙為己庚兩和
之較庚者小中兩和數己者大小兩和數此兩和數中
皆有相等之小數而餘為大中兩數矣此乙所以爲大
中兩數之較也餘倣此
又十三題
句股測高(測遠測廣測深同法)
法曰先准地平(地平者必令所測地面自所測之處至高之根如水之平也)次立表
與地平為垂線退後立望竿令所測高表尖竿頭參相
直末自竿至高根量得若干遠然後以表竿差與遠相
乘而以表竿相去若干除之加竿長若干得所求之高
如圖丙乙高乙甲遠丁甲竿己戊表己子
為表竿差戊甲為表竿相去夫丁子己形
與丁辛丙形相似故丁子與己子若丁辛
與丙辛也
又十四題
句股重測高遠(測廣測深同法)
法曰若無高根之可量者則用重測法謂一次立表竿
令表竿與高參相直二次立表竿令表竿與高參相直
(兩表兩竿要各相等又要或前或後立成一直線)然後以表竿之較乘兩表相
去而以兩表竿相去之較除之加表高若干得所求之
高又以前表竿相去乘兩表相去而以兩表竿相去之
較除之加前表竿相去得所求之遠
如圖甲乙高乙丙遠各不知數用重
表測之丁子為前表己丙為望竿
子丙為表竿相去甲丁己三點參相
直午壬為後表丑辛為望竿壬辛為
表竿相去甲午丑三點參相直丁亥為表竿之較子壬
為兩表相去未辛為兩表竿相去之較己上用以測高
借丁卯(元是表竿相去)為表竿相差借卯己(元是表竿相差)為表竿
相去辰戊亦借為表竿相差戊癸亦借為表竿相去甲
辰癸三點亦參相直丁辰亦借為兩表相去與丁午等
即庚癸亦為兩表竿相去之較與辛未等以上用以測遠
解庚癸線與辛未線必等所以然之故
如圖甲乙矩内形甲乙為對角線丙丁及戊己兩線與
矩形之邊為平行而交角線
於庚次任作辛壬線亦交
角線於庚次截甲癸線與
甲辛線等作癸子線亦交角
線於庚則子乙線與壬乙線必等
論曰試作午丑及午未兩線與甲辛及甲癸相線為平
行夫庚甲辛及庚午丑兩角形相似之形也則庚甲與
庚午若甲辛與午丑依顯庚甲與庚午若甲癸與午未
然則甲辛與甲癸亦若午丑與午未夫午丑與午未如
是則子乙與乙壬亦如是矣
先論甲乙矩形此形甲己為對角線寅卯申亥兩線交
於角線上之丁點則卯申矩形與亥寅矩形等
次論甲丑矩形此形甲丑為對角
線寅酉房壬兩線交於角線之午
點則房酉矩形與寅心矩形等
末總論曰夫房酉矩形與寅心矩
形既等而午井形又與卯申形等即亦與亥寅形等然
則房酉矩形中所餘之井酉形與寅心矩形中所餘之
丁心形必等
於是以丁亥表竿相差乘丁午兩表相去得丁心矩形
即井酉形而以井女兩表竿相去之較除之得女酉加
酉辛表共女辛即甲乙高
先論甲己矩形同前
次論甲癸矩形此形甲癸為對角線申氐戊亢兩線交
於角線之辰點則亢氐矩形與戊申矩形等
末總論曰夫亢氐矩形與戊申矩形既等而辰牛形又
與亥寅形等即亦與卯申形等然則亢氐矩形中所餘
之牛氐形與戊申矩形中所餘之丁戊形必等
於是以丁卯表竿相差乘丁辰兩表相去得丁戊矩形
即牛氐形而以牛危兩表竿相去之較除之得危氐加
氐癸表竿差共危癸即乙丙遠也
求高又法既得危氐線即以亢牛乘之得牛辰形此
形即寅亥矩形亦即申卯矩形也故以丁卯除之得丁
申高
求遠又法既得女酉線即以房井乘之得井午矩形
此形即申夘矩形亦即寅亥矩形也故以丁亥除之得
丁寅遠
歴算全書卷四十六
