新法算書卷六十九明徐光啟等撰
交食歷指卷六
外三差
前論交食法有東西南北高庳三差皆生於地徑蓋以地
為太圜之心為此界以宗動天為彼界日月在兩界之
間因地徑之小於日大於月生彼界之視三差也今言
外三差者於三差之外復有三差不生於日月地之三
徑而生於氣氣有輕重有厚薄各因地因時而三光之
視度為之變易三者一曰清蒙高差是近於地平為地
面所出清蒙之氣變易高下也二曰清蒙徑差亦因地
上清蒙之氣而人目所見太陽本徑之大小為所變易
也三曰本氣徑差本氣者四行之一即内經素問所謂
大氣地面以上月天以下充塞太空者是也此比於地
上清蒙更為精微無形質而亦能變易太陽之光照使
目所見之視度隨地隨時小大不一也外三差之義振
古不聞西史第谷於萬歷年間殫精推測鈎深索隱歷
家推重以為冠絶古今而此秘未睹至其暮年方行萬
里乃始洞徹原委尚未及著書其門人述遵遺指撰集
論次然後交食之法於理為盡則近今十餘年事耳盖
歷學之難言如此
清蒙高差
歷家測騐日月及經緯諸星積累所得其光入人目往往
不依直線而至夫太隂太陽有地徑視差無怪其然也
恒星無地徑差人測之在地面與在地心不異宜所見
者必依直線若之何不然且兩星相距近於地平與其
相距近於天頂絶不同其各體之大小亦不同又太陽
太隂固有地徑差其視體偏下視高度宜少而所得者
忽復多定望時二曜正居天地徑之兩端以理論見一
不得見二或並見則半體而已今有時全見之何也古
度數家見直物入水中折成曲象空水之交則有鈍角
以此鈍角喻諸星射目之折線於理為允則近地面之
氣可比於水天體至清可比水晶光在有氣無氣之
交必成折角而能令諸曜之象升卑為高也若星距頂
愈遠所射光之折線角愈減其鈍而視高之去實高也愈
多蓋近地則濕氣愈厚故受蒙為甚而又實非雲霧
等有質之物且在地濁之上(歷言入濁言濁中近濁入則不見視此為異也)謂之
清蒙也因此凡測候兩星若距度線與地平平行者其
氣所升視之巳在赤道上迨太陽近午出蒙氣之外復
測之始以實行交於赤道為真春分秋分反是先以近
午之實行在赤道上為真秋分迨昏測之日巳入過赤
道而北矣視度乃復在赤道上自朝至中不能有兩春
分自中至夕不能有兩秋分則朝夕所見皆視度非實
度也則皆清蒙之高差也
問清蒙之氣能變易太陽太隂之實度是已其言隨地隨
時又各不同者何謂也曰第谷測定清蒙諸差太陽與
太隂大約相等而與諸星則不等其五星所得之差又
與恒星不等因此推知致差之因不在距地遠近其差
大小皆氣之所為也氣厚薄時之所為也距地遠近地
之所為也凡考七曜之蒙差皆候其高弧至於無蒙之
處得其實度而以較於有蒙之處得其視差幾何如第
谷所居北極高五十五度冬至日夏至夜皆甚短其測
候太陽之蒙差必於夏月太陽出蒙氣之上乃可得之
測恒星之蒙差又於冬月若夏測星冬測日則盡日盡
夜皆在蒙氣中無法可得而氣之厚薄冬與夏必有分
矣故所定氣差隨之異也若論地則山阜之上蒙氣為
在高之距與在庳之距必小有異若不與地平平行而
兩高弧各異者不論或正(與地平為直角)或斜(與地平為斜角)其在高之
距與在庳之距亦小有異總之星愈近於地兩距之
實度愈少遠則愈多矣第谷之本地北極高五十五度
有竒測定太陽太隂之蒙氣差大約相等自地平以上
至四十餘度高差漸少更高則無有而近地之最大差
得三十四分故太陽極近地平以地徑視差之偏庳三
分蒙氣差之視高三十四分相減得太陽高弧之視差
三十一分則目視太陽將入以下周至地平見謂在上
而其實體已全入於地太隂以最大之地徑視差六十
三分蒙氣差之視高三十三分相減餘三十分目視
之見謂全没而其實體猶全在地平上也多祿某以渾
天儀測太陽行春秋分積年所得皆以本日兩交於赤
道遂為千古不决之疑不知者意其差在儀器儀器果
差安得百無一合又安得悉在地平之上竟無差而在
下者乎至近世而後知為清蒙之差也第谷用器甚多
甚精諸器畢合不可謂有器差而其所得亦復如是所
以然者太陽臨春分論實度尚在赤道南晨測之為蒙
少平地乃多澤國尤多海濱更多蓋此氣周生於大地
之面外規之界距地心悉等而地面有高庳其距氣界
各各不等此為淺深厚薄之緣正如海底有坳突之勢
因有淺深若海水之面恒平而已然論其恒勢淺氣所
生之視差少深氣為多論其變淺氣或忽然增加少易
而多深氣乃鮮有變時也萬歷十八年庚寅夏六月西
歷記月食太陽以半體出地其太隂正相對尚高二度
入景中已多分及太隂半没而太陽已高二度出地平
之上若以恒理論之則太陽心方出地平景心宜同時
而入太隂之西周實入於地又當在景心入地之前今
太陽心出矣而景心尚高二度非蒙氣所為安得此乎
然此視高差可謂甚大則以本地近於大山之下大河
之濱其蒙氣為厚遇夜清氣上騰凌晨更甚故也若他
地他時未必盡同此數故治歷者當先定本地之諸曜
蒙差參以時令乃能立表推步其法須累測交食之多
寡早晏斟酌定之勿謂精於本法便可隨地隨時必無
舛戾也若立差旣定而臨食時氣候忽更此則難可豫
料然所失無幾矣此高差惟月食累遇之若日食則二
曜之蒙氣差大略相等高弧旣同鮮有變易徑可勿論
也
清蒙徑差
太陽全食晝晦星見恒事耳中史及西史皆數記之若太
隂全在日與人目之間而不能盡掩日體四周皆有餘
光歷家謂之金環或有闕如鈎或云依日月周徑本法
則不應有此何者凡此一視徑或大或等于彼一視徑
則以此體寘之人目與彼體之間無不全受掩蔽者今
止論太陽在其最庳全視徑為大得三十一分太隂在
其最高全視徑為小得三十分三十秒其較三十
秒為全徑六十分之一耳卽定朔果在此時日月以
兩心正會何因四周能見太陽之邊乎(或有時可見詳下文)此說是
也然而古今所記實見實測乃復多有之如隆慶元年
丁夘三月朔日太陽近於最高得全徑三十分太隂
在高庳之正中得全徑三十二分三十四秒則全掩太
陽之外尚餘二分三十四秒乃西土實侯至食甚時二
曜以心正會見有金環又萬歷二十六年戊戌二月朔
日太隂在最庳掩太陽復如是論地則此測在西國之
内地前測在海濱論北極則此測高五十度前測正高
四十二度論臨食時此測有雲前測無雲也(雲氣雖不掩日月亦)
(能變易光曜損益分秒)而第谷專精候騐多在北海之濱北極高
五十六度累年密測終不見太隂盡掩太陽晝晦星見
是則日光恒贏月魄恒縮又將疑掩之不盡為恒事矣
迨萬歷二十八年庚子六月朔於内地北極高五十度
測得日食五分有半依本地原推正應四分較多一分
有半則又日光縮月魄贏也又萬歷二十九年辛丑十
一月朔日全食第谷門人於本地北極高六十餘度測
得食甚時見金環四周皆廣一分有半(太陽徑十二分)萬歷三
十六年戊申七月朔日食西土内地北極高五十一度
測食甚時得二分正同時向北更四度論高視差宜減
一分猶宜見食一分而第谷門人密測乃不見食此兩
測者皆日先居贏且贏甚也而皆無雲綜其大都極出
地甚高近海或大澤食時多雲氣則日光贏測數少於
推數極出地迤庳居地平高去水澤遠食時無雲氣則
月魄贏推數少於測數展轉推求即清蒙之氣隨地隨
時有無厚薄不等能淺深受光於日而變易其照耀之
勢使人目所見或增或減迄無定限也再騐之海中有
小島其視體甚小於太陽之視徑日初出時正當其中
平分太陽之體則石之兩旁皆顯大光若不當其中而
石居太陽之左右則不能映蔽日光如兩相退讓而露
太陽之全體此為何故石之蔽日隱顯之間雖以一線
為界乃海中蒙氣極厚日之施光蒙氣受之故人目所
見日光能侵軼於本界之外也喻月魄於石體其理正
同故蒙氣盛者全食時如石當日之正中少食時如石
當日之左右即高弧至於午正人目見日無横斜之線
不能升卑為高乃地以上之蒙氣猶能承受日光使溢
界外而展小為大月不蔽日職是故矣如圖地心為甲
日心為丙太隂正當日目
之中為乙月景之最中人
目所在為己設太陽之邊
實為丁為戊其光下照所限月景之界宜為丁甲戊甲
兩線此限外之氣皆得最光也然因乙太隂隔太陽原
光於已目目所能正見者非丁戊乃是庚辛而作己辛
直線則目宜全不見日周之微光矣苐太陽正照之最
光下及於月景四周之外而外氣之近地者為次徹之
體則太陽之光借此體以侵入於月景本界之内别作
一界線曲而向内即人目所正見為癸而癸既切景較
遠景之處加有光焉(光愈正照愈明切景之光甚似垂線若正照然故比距遠之處加明)
(焉)故景之四周從癸至壬目所見皆成日光是為癸壬
金環癸壬所在實於空中非太陽之光果外溢至辛也
從下視之若在月之四周與太陽同天而太陽之原光
若丁戊以外更餘辛庚一環矣但癸壬之廣狹依氣厚
薄隨地隨時一一不同耳曾有人試以銅薄規為小圓
形依直角線寘長竿之末退後一丈又寘一規正對前
規與為平行後規之心開細孔以目切孔正覷前規之
心其前規之全徑較兩規相距之遠得一千分之十以
掩天上之弧得三十四分二十秒與本時太隂光滿
近最庳之全徑等則目視兩規與目視二曜大小遠近
之比例亦等次從後規視前規理宜全掩太隂之體乃
所見者四周皆顯大光更移後規向前二尺有竒以遠
近之比例論則前規可掩弧度四十一分然而尚有微
光也可見日月近地平固因蒙氣有視度之高庳差即
去地平遠猶有視徑之大小差矣
本氣徑差
金環又有二種一為虛環人目所見其内規(如上圖之癸)為最
光向外漸微至外規(如上圖之壬)則似次光此為地上清蒙
之氣所生上文所說是也一為實環若内若外悉是最
光此所見者必為太陽原光矣所以然者太隂在最高
太陽在最卑則太隂之視徑略小於太陽之視徑上文
所云六十分之一者是也但實環旣為原光在太陽之
周非復向之虛環從蒙氣中隱映而得者則人居月景
之中何自得見之即在景之偏際亦宜見左失右何自
得全見之曰此亦因太陽出光折照至於人目雖正在
景中猶得見之折照之繇即非地上清蒙之氣而在空
中之本氣前交食第一卷論月體當食顯赤色是氣景
所生此論地面當食而見光色是空中本氣所射其理
一也設甲為太陽其實邊乙丙太隂在癸其實邊丁戊
人居地面在己辛之間不能以直線見太陽所以得見
者太陽全輪旣受掩於月體為壬庚所餘庚乙實環皆
為原光而以庚壬内規之光正照丁戊月邊過丁戊則
折而内向以至於地面
己辛其所繇内折者欲
就於甲癸垂線也(詳本篇一)
(卷第五)己辛以内皆為月景得界丁辛及戊己成三角形
(戊丁為底圖未盡景末)又太陽乙丙外規之光正照太隂近處為
子丑過子丑又折入景中而相遇於寅(此折甚於前折者愈遠於垂線)
(愈欲急就之也)得寅己辛角形形以内為折入景中之重光人
目在重光之中從卯辰兩交得見光環意疑在丁丑旋
遶月輪其實則太陽之原光庚己也
問本篇首卷言凡象射次澈之體則成折線故本章言日
光過地面則折入於景為蒙氣故也空中本氣則甚澈
之體何能受光而折入於人目乎曰空中本氣為甚澈
之體此恒理也然亦有時而變如彗孛攙搶乃及客星
等皆在列宿天中非理所宜有難究其所生之緣而實
則恒有之今言日食有金環者大抵皆虛環也其實環
甚為希有萬一有之不得不究所從來故作此論蓋虛
環旣蒙氣所為無可疑者則實環之緣不得不在蒙氣
之上旣在其上不得不歸之空中本氣舍是别無可推
之理耳兹有蒙氣以上變易之徵聊足解此萬歷三十
三年乙己八月西國北極高四十度測太隂在最庳日
全食亦全掩原光而其四方尚餘赤光如火廣數度依
此地論必言蒙氣所生不足疑亦無待辯矣從此向西
北一國北極高五十餘度同時測日不全食未盡一分
三十餘秒日周以外太隂餘分甚多而此地尚見是大
光豈兩地相遠如此尚當言蒙氣相同之故乎縱使相
同而蒙氣距地面極高無過二百里此不全食之地其
交景之頂尚在二百里以上全出蒙氣本界之外則安
得有本地面
之蒙氣受照
為光且四周
皆見乎彼所見滿景四周之光旣不為蒙氣所生必為
空氣所生矣假如甲為太陽乙為太隂丙為地丁戊為
蒙氣界若全食則所生金環在丁戊之四周也今不全
食之地在己其交景之頂為子亦見光(此光非金環因在日周故其理)
(不二)而光中甚黑則非丁戊氣所能生矣蓋目從己視太
隂之下周庚必以己子庚線視其上周必從己壬至太
陽辛則太陽之辛癸原光正照己目及蒙氣之界面丁
壬丁壬之中絶無月景而丁壬等高之景全在己子庚
直線之下安所得生光之原乎可見日四周之光必生
於蒙氣以上必為空氣所生或近於月輪在庚子兩線
之中或在月輪之下不遠矣
日食晝晦星見
凡前史記日食晝晦必因全食若星則不全食而見者有
之如晨昏分中日己出己入矣明昧之交正似太陽未
全食之光也而大星已見也又或不全食而見者有之
故歷家下推將來雖得全食其見星與否未可豫定蓋
見星不見星之緣不盡在於食分多因蒙氣與隂晴耳
若食時遇氣甚清人目先見最光而習之忽爾失光雖
日不全食亦似向晦星乃可見如從大光中暫焉入室
見為甚闇也若食時遇氣甚厚或多雲霧則目先習是
次光後見失光不以為異又醲厚之氣受返照之光光
亦不能甚失日雖全食未及甚晦正如浮雲在天雖太
陽已没曚曨宜盡而尚有餘明星不可見矣自此之外
更有太陽正照斜照之緣如太陽當晨昏時斜照於地
上氣得其正照之光則能返照地面若此時以日食絶
正照於氣中則地無返照之光又本無正照之光安得
不為甚晦乎故午前日食初虧至食甚時加晦生光至
復圓時稍明午後食則反是蓋太陽愈庳愈能正照氣
中而地得其返照之光太陽愈高愈正照於地面而以
有食絶其正光惟四外反有從旁斜入之次光耳又或
太隂近最高其視徑不甚大於日之視徑則太陽四周
光曜散溢雖則全食地面之次光乃大於少食者亦多
有之又使日食切近地平太隂微高於日則地面所見
日下周之原光雖不盡如鈎而上氣乃與日月參相對
絶其正照即地面絶無返照之光此時亦變為甚晦也
推視會
交食第三卷求定望改實時為視時所以然者為有升度
差也今日食以地心之實會改為地面之視會所以然
者為有地半徑差也以地半徑差論實會視會不同上
章已詳之矣此求視會則依視差推算法先求日月高
弧以得高差又求高弧與黃道之交角因以得南北東
西差次求視會與實會之時差以加以減於實會之時
刻而得日月正視會之時刻其加減則以黃道九十度
為限(即黃平象限)
日月距地平高弧
視差有多有寡必依太陽出地平所得高度多寡(日月會合若同)
(高度或差一度以下其視差甚微故得太陽高度不必復求太隂高度必求細率則以太陽高度查太隂高差)
(先加於太陽高弧得太隂高真度也)欲求高度幾何則用定會(即定朔也)之實
時及本時之太陽躔度先以躔度推太陽距赤道之緯
度次以定會實時推其距子午圈若干(詳見下文用法中)得二
角形形有北極出地之餘弧有太陽距赤道之餘弧有
兩弧間角為太陽距子午圈弧之相當角算得本形之
第三弧為太陽出地高弧之餘弧也如圖甲乙丙為子
午圈甲丁丙為地平丁戊為黃道太陽在
庚則乙庚己為高弧壬庚為太陽距赤道
之餘弧因得乙壬(本地極高之餘弧)及壬庚(太陽距赤)
(道之餘弧)兩弧及乙壬庚角(太陽距子午之相當角)以推第三乙庚弧
得其餘弧庚己太陽出地平上之弧也次推高弧交黃
道之角先以升度求庚丁弧次以庚己高弧以庚丁黃
道弧以庚己丁直角推得庚丁己交角因以對角求南
北東西差法如次圖設庚癸為高差辛為黃道極則辛
癸大圈之弧以直角交黃道於壬為庚壬癸三角形先
己得壬庚癸角而庚癸壬為餘角則全數
與高差若壬庚癸角與壬癸南北差又全
數與高差若壬癸庚角與壬庚東西差或
用簡平儀求高弧可免算第其圖愈大所取太陽高度
分愈眞乃足推算視差如圖己戊辛為子午圈甲乙為
赤道北極在丙太陽距赤道北依丁戊線
行與行壬戊弧其理一也至戊為正午至
丁如復至壬午前與午後同所以然者戊
丁直線不可得度分數必用戊壬弧量度
為凖(戊壬與戊丁皆距等小圈兩弧皆小圈之弧即等試想戊壬圈置戊丁線上與戊丙圈縱横為直角)
(則得其理)如彼面之丁為己時至戊為午行至此面之丁為
未與壬為己至戊為午復轉至壬為未其理一也次作
丁庚直線與地平甲己線平行則得己庚弧為太陽在
己時或在未時出地平上之高弧也别有表以日食之
實時及太陽距赤道緯度查其出地平度而推兩曜高
差又有高弧交黃道角表以此三角形(前圖之己庚丁)推算法
用太陽高度於太陽距黃道九十度限表中查角(即庚角)
詳本表又有南北東西差表以太隂高差及高弧交黃
道角依直線三角形推算(因三差線小雖在天實為大圈之弧亦可以直線句股法)
(求之與三角形圓線法所求不異)
黃道九十度為東西差之中限
地半徑三差恒垂向下但高庳差線以天頂為宗下至地
平為直角南北差者變太隂距黃道之度以黃道極為
宗下至黃道為直角東西差則黃道上弧也故論天頂
則高庳差為正下南北差為斜下而東西差獨中限之
一線為正下一線以外或左或右皆斜下論黃道則南
北差恒為股東西差恒為句高庳差恒為弦至中限則
股弦為一線無句矣所謂中限者黃道出地平東西各
九十度之限也(黃平象限省曰度限)舊法以子午圈為中限新歷
以黃道出地之最高度為中限(東西各九十度則是最高)兩法皆於
中前減時差使視食先於實食皆於中後加時差使視
食後於實食第所主中限不同則有宜多而少宜少而
多或宜加反減宜減反加凡加時不得合天多緣於此
此限在正球之地距午不遠若北極漸高即有時去午
漸遠時在午東時在午西大都北極高二十三度三十
一分以上者(若高二十三度三十一分以下者則日月有時在天頂南有時在北三視差隨之今)
(未及論此)獨冬夏二至度限與子午圈相合為一從冬至迄
夏至半周恒在東居午前從夏至迄冬至半周恒在西
居午後
問日月諸星東出漸高至午為極高乃西下漸卑而沒
則午前午後之視差豈不分左分右漸次高庳以正午
為中限乎曰南北差東西差皆以視度與實度相較得
之而日月之實度皆依黃道視度因焉安得不并在黃
道從黃道論其初末以求中限乎推太隂之食分以其
實距黃道度為主推太陽之食分則以太隂之實距度
先改為視距度所改者亦黃道之距度也論實望實會
欲求其實時以黃道經度為主今求視會其所差度必
不離黃道經度而因度差多寡求其相當之時差以得
正視會理甚明矣若子午圈者赤道之中限也度限為
東西差有無多寡之限猶冬夏至為晝夜永短之限午
正時為日軌高庳之限也惟歲惟時自宗赤極不借黃
道之度中為限東西視差自宗黃極何乃借赤道之午
中為限耶昔之治歷者未能悉究三差之所從生徒見
午前食恒失於後天午後食恒失於先天故後者欲移
而前前者欲移而後又見所移者漸向日中漸以加少
遂疑極高至午中則無差不知黃道兩象限之自有其
高也亦自有其中也必如彼說以午正為東西差之中
限設太陽實食午正遂以為無時差遂以為定朔為食
甚倘此時之度限尚在西愈西則愈有西向之差法曰
中以東則宜減安得不見食於午前乎儻此時之度限
尚在東愈東則愈有東向之差法曰中以西則宜加安
得不見食於午後乎如萬歷二十四年丙申八月朔日
食依大綂法推得初虧己正三刻食甚與定朔無異皆
在午正初刻至期測得初虧己正一刻後天二刻此所
謂中東宜減見食於前者也今試依新法減時則推定
朔在午正初刻内四分四十九秒於時日月躔度在鶉
尾宫二十九度八分四十七秒黃道中限在本宫一十
三度一分距正午西一十八度五十九分距太陽躔
度一十六度八分太陽定朔之高尚有五十度查
得太隂高差三十八分先求高弧交黃道角為日距度
限弧之切線與本角若全數與高弧之切線得視差小
三角形内正對東西差邊之角二十度一十一分再
推本角之正弦與東西差若全數與高庳差得一十三
分四秒為此時之東西差因此求時差得太隂行一
十三分應為時二十四分二十六秒於法宜減故得食
甚在午初二刻一十分三十七秒在定朔之前也更
求初虧約用前四刻依法復求視差其時黃道度限在
鶉尾宫初度二十分即午後一十四度四十分距
太陽二十八度四十六分太陽高四十八度得太隂高
差四十分東西差二十四分求其視行度得四刻行
二十一分又以開方法得太陽自初虧至食甚行三十
一分今視行二十一分得四刻則三十一分應得五刻
一十三分五十四秒以減食甚時得初虧在己正一刻
内一十一分四十三秒與實測時刻密合
凡九十度限去子午圈不遠新舊兩歷所推之定朔不
遠則兩所得之時差亦不遠若相距遠而度限在東則
食在午前或在午後新歷所得時刻皆多於舊歷度限
在西食在午前午後新歷所得時刻皆少於舊歷如萬
歷三十八年庚戌十一月朔大綂歷推食甚在申初一
刻至期實測得申初四刻先天三刻於時度限距子午
圈二十一度四分在東距太陽五十九度四十七分
日月並高一十六度得太隂高差五十四分一十五秒
從是算得東西差二十八分三十一秒應時差四刻
一分三十五秒依法與實時相加而實時與大統歷算
小異在未正三刻四分得視時乃大異是繇度限在
東加數宜多而午正為限者加數則少安得不先天也
又萬歷三十一年癸卯四月朔日食九分二十秒大
綂歷推食甚在辰正初刻新歷推得在辰正三刻内此
時度限亦在東距午正一十五度四十二分較太陽距
正午為更近所得東西差止一十九分二十四秒應時
差四十七分四十六秒依法宜減則實時己初一刻
六分改視時為辰正二刻三分此兩食者皆所謂度
限在東則食在午前午後新歷所得時刻皆多於舊歷
者也又其甚者若日食在正午及度限之間則宜加者
反減之宜減者反加之所失更多如崇禎四年辛未十
月朔日食大綂推初虧未初一刻較新歷遲三刻有竒
食甚未正初刻新歷推未初一刻内至期實測果在本
刻内所以然者新歷以黃道九十度限為中所得時差
與實時相減則食甚後退故合大綂以午正為中所得
時差反加而前進去之逾遠矣蓋本日食甚實時日月
並已過午正一十七度二十九分一秒未至黃平象
限六度二十二分三十九秒則度限在午西二十三度
五十一分四秒算得東西差三分三十四秒應時差
五分為減而先推實會在未初八分四十秒因時
差退減為未初一刻内三分四十秒如是止矣若以
子午圈為中限則本時日月過午己十七度有竒在西
東西差既宜少而多時差又反減為加即多得時刻若
此者就用西法算兩曜高三十五度四十八分及其距
午正之度能生東西差一十一分一十三秒應得差二
十二分定朔在未初二刻五分相加亦不得不為未
正可見中限異同實為加時離合之根也
算視會必求黃道九十度限
交食以黃道出地之最高度為中限固矣但限内所應加
減者則有時差(日食在九十度西時差宜加在東宜減)此實食視食之所
繇以先後(詳見上篇)故算視會者必先求九十度限所向何
方乃可然求之之方不一或依常法定其宫度分或依
簡法止推兩曜當食之時居九十度東西何方而不必
問其宫度先以常法論設甲乙丁斜三角形甲為天頂
乙為黃道交子午圈日月俱在丁以
升度得乙丁弧以太陽距度得甲乙
弧查本表得其兩弧間之角以甲乙
丙三角形内因九十度限在丙必求甲丙為垂線指九
十度距甲頂若干更求乙丙為九十度限與子午相距
若干則丁丙乃日月距九十度所自有者而以先得
甲乙弧與乙丁弧及兩弧間之角因求得時差此本九
十度限表所繇起乃常法也第以此求之必先算日月
高弧及高弧交黃道角等未免太煩乃簡法則惟算黃
道何度分當九十度即此斜角三角形内徑求甲丁弧
為日月高弧之餘弧又求甲丁乙角即高弧交黃道之
角則視差小三角形内(見前五卷三題)以高弧得高差以本角
得交角及餘角而推所對之弧為南北東西差固已捷
若指掌矣再欲察日食在九十度限東若西亦得兩法
一以黃道在正午度推九十度距午左右何若則以定
朔所得太陽躔度較先所得在正午黃道度即得太陽
在九十度限東西何方如依甲乙丁斜三角形以升度
求乙丁弧必得何度在乙(子午圈交黃道之處)使星紀宫初度或
鶉首初度在乙乃為正九十度此外
則以食時按極出地度求之蓋北極
高過二十三度三十一分凡自星紀
初度至鶉首初度黃道度在午者必九十度偏東自鶉
首至星紀黃道度在午者反為九十度偏西而距午最
遠者則在大火宫或玄枵宫隨極高低不一亦隨宫度
各處不一也試以極高二十四度則九十度限距午最
遠特一十五度耳極高四十度則九十度限能距午二
十四度餘宫度在九十度限亦距午漸近因而推日
食在九十度之或東或西較較不爽也又一法以黃道交
高弧角求之更凖蓋本角向子午圈者在午前為銳角
午後為鈍角則食必在九十度之東若本角午前為鈍
角午後為銳角則食必在九十度之西如此可免再求
矣
求視會復算視差之故第三
日食與九十度相近則太隂之偏東西不多所得時差於
本食之實時不甚相遠可免復求東西差倘所食遠距
九十度之限則太隂偏左偏右(左右即東西)者必多而能變
其實行以為視行使不再三考求何從而知故必先算
太隂之視差化之為時差次求其視行與太陽實相距
若干則用以推東西差可得食甚至若初虧復圓總不
外太隂之視行而得之此推步日食者所以復算視差
求太隂視行
定太隂東西差須得其與太陽相會之實度應先(如在九十度東)
應後(在九十度西)乃使太隂實行即從自行可得則或二十
八分一小時或三十分或三十三分有竒(因最高最庳中距不)
(等故)以三率法推其度差則相應幾何時刻因與定朔加
減之其所得時亦可於真視會不遠但先後會之度差
必以太隂實行為主然因視差故每每移其本實行故
以實行求時差多謬而以視行求之乃凖矣法曰日食
在九十度東則較定朔前一小時食在九十度西則較
定朔後一小時復求東西差以兩差不等之分秒或加
或減於太隂一小時因以實行得其視行若次得之東
西差大於先得之東西差其兩差不等之數為減若次
得之差數小於先得數則兩差不等之數為加乃得太
隂一小時視行也或不用一小時先於定朔算東西差
而以實行化為時差或加或減於本時得視會又以視
會與定朔相去不拘若干惟於此時再求東西差兩差
不等之數依前法加減之必得太隂視行時差因以復
算真時差
假如崇禎四年辛未十月定朔在辛丑日未初八分四十
秒此時順天府得東西差三分五十秒太隂一小
時實行為三十三分二十秒以此算得六分五十四
秒為時差因食在九十度東故減得未初一分四十
六秒即相近視會時也次升度先在正午自春分起為
二百二十六度二十五分四十秒因時差宜減一度
四十三分則以餘升度查本表得躔度在正午者為大
火宫一十七度一十二分算得九十度在午西離二十
三度三十五分比日月距午更遠七度四十四分三十
八秒又以太陽高三十六度一十四分算得高弧交黃
道角八十四度一十七分則以餘角復得東西差四分
五十秒兩差不等之數為一分因後得之差大故
先得差内減一分實得二分五十秒為太隂過太
陽之視行也前時差六分五十四秒今以三率法依
本視行得前東西差三分五十秒應九分一十九
秒為真時差因減故算得視會在午正三刻一十四分
二十一秒(一十五分為一刻)
考真時差
眞時差者為太隂視行反覆推求再三加減脗與視會相
合者也欲更考其實須算太隂實距太陽幾何若所得
分數與太隂所當視會之東西差等則所得視會亦凖
若微有不等則以不等之分數化為時依兩曜實相距
之分數較之視差或大或小依法加減於前視會如距
度大日食在九十度東則時差為加食在九十度西則
時差為減如距度小則九十度東宜減九十度西宜加
分秒内可得其凖也因此再求東西差而以本視會時
復求九十度限與其距天頂及距太陽度因以本高弧
及高弧交黃道角復算視差如前假如得真時差九分
一十九秒何以知其然也因減時九十度略在前即夀
星宫二十三度六分距天頂五十三度四十分距
午二十三度三十一分較太陽復西去八度二十一
分算得高弧三十六度三十四分交角八十三度四十
五分推東西差五分一十三秒故以三率法用太隂
實行三十三分二十秒一小時以真時差得五分一
十秒為太隂實距太陽分數見其與纔得之東西差
相等則前時之時差亦凖若未等則求所差分數如前
東西差三分五十秒得九分一十九秒為時差此不
等之三秒亦得七秒依前法視會内應減實得午正三
刻一十四分一十四秒乃真視會也
求初虧復圓俱依視差算
凡算月食推初虧復圓先以開方求其自初虧至食甚所
行之度分若干又自食甚至復圓所行之度分亦若干
故所推食甚前後時刻大約相等算日食則不然雖太
隂在食甚前後所行度數相等而所應之時刻鮮有不
參差者蓋視差能變實行為視行有前得之時較後得
為多亦有後得之時較前得為多此中種種不一如圖
甲為太陽乙丙丁皆為太隂甲乙或甲丙為兩曜視半
徑甲丁為太隂食甚視距度則甲乙
線之方數減甲丁線之方數其餘數
開方得乙丁線為太隂自初虧至食
甚所行之度與丁丙至復圓數略相
等但太隂行過乙丙線時(除食甚正在九十度)
前後未嘗相等故求之之法必於前時以東西差求其
視行則得初虧距食甚之時又於後時復以東西差求
其視行乃得復圓與食甚相距之時然初虧與食甚或
皆在九十度東則因初時之東西差大于後時之東西
差其兩差不等之數減於太隂實行則得視行若初時
之東西差反小於後時之東西差其兩差不等之數則
加于太隂實行而得其視行或初虧與食甚皆在九十
度西而初時之東西差大後時之東西差小其兩差不
等之數用加如初時之東西差小後時之東西差大其
兩差不等之數用減與前法相反此較初虧與食甚若
較食甚與復圓皆為一理第其兩相比量俱以先東西
差與次東西為主故求初虧則食甚為後時而求復圓
則食甚又為前時也或前後兩時不同在九十度之一
邊如初虧在東食甚在西則求東西差必不止食甚前
後之兩次因九十度而中分之則一視行求其時之多
半又一視行求其時之餘乃合之為初時至後時太隂
視會所行度分矣
假如視會在鶉首宫初度午後正二刻距九十度西得東
西差五分設得視行二十二分則太隂自九十度至
本視會之度兩刻間視東行一十一分如前圖乙丁線
為二十八分減一十一分所餘一十七分為太隂在九
十度東自初虧至食甚時所行即因九十度前一小時
以東西差得太隂視行二十一分故其行一十七分必
須時三刻四分乃自初食至正午(此正午與九十度同故)為太
隂所行之時并午前後時總得五刻四分為太隂自
初虧至食甚過乙丁線所行時也
算日食復求太隂視距度之故第四
前以實會而不得其視會則所求者在東西差乃今視會
真矣然何以知其所食大小之分數及以月掩日所向
之方位乎曰此皆由於太隂視距度也故推步者必先
於食甚求視距度則得日應食幾何分又於初虧復圓
求視距度則得月掩日之光在何方
日食分數
凡推月食以太隂實距度較其半徑及地景半徑即得月
食之分今算日食法雖同然因視度為主則必以太隂
視距度與日月兩輪之半徑相較乃得日食分矣依法
於視徑本表查日月半徑并之減視距度為太隂掩日
之分(天度數之分)次以三率法求食之分(日徑分十分之分)因先於
食甚求太隂實距度則太隂視會及實會間之本行或
加或減于其交周度依時差加減得視會時太隂交周
度用算或查表即得距度
假如時差為三十五分二十一秒宜加此間太隂過太陽
行一十七分五十六秒太陽本行一分二十七秒相
加共得一十九分二十三秒為太隂本行今設交周實
度為五宫二十九度因時差應加則交周多得一十九
分二十三秒終得太隂食甚時實距北一分四十一秒
次以南北視差本實距度改為視距度故凡於三差
小三角形内考時差并求南北差乃所得為正視會若
太隂距黃道北人居夏至北則實距度恒減視差為視
距度若太陽距黃道南則視差反加於實距度為視距
度
假如萬歷二十四年丙申歲八月朔日食歷官報應食九
分八十六秒實測得八分強弱之間依新法算當食甚
時太陽高五十度五分得太隂高差三十八分因
九十度距太陽西一十六度八分算得高弧交黃道
角六十八度四十八分為南北差線其對角為南北差
得三十五分因當時太隂近交中在黃道北二十八分
五十秒與南北差相減得六分一十秒乃太隂
視距在黃道南矣又日月兩輪半徑并得三十二分
五秒減視距度得二十五分五十五秒以此求食分數
得八分二十九秒乃與所測適合也
日食圖說
新法以圖顯本食所向之方故上下書南北左右書東西
其繪圖則以太隂距度為主但食時先後太隂距度常
有變易或初虧距度多而復圓距度少或初虧距度少
而復圓距度多此其故蓋因食在交處前後之不一也
若前後離交相等則雖距度同而所向南北未免有不
同矣故日食前後求太隂視距度必以交周所應食甚
視距度減其自初虧至食甚所行徑度則得太隂初虧
視距度又以加於自食甚至復圓所行徑度則得其復
圓視距度也復求交周所應太隂食甚視距度惟查距
度表内上下左右則得交周度及其在交前後分數
假如前萬歷二十四年食甚得視距度六分一十秒即
交中後查本表右得一度一十二分其本表上則得
六宫乃所應視距度交周也又當時自初虧至食甚
太隂所行徑度三十一分七秒與交周相減得六宫
度四十一分五十一秒相加得六宫一度四十三
分五秒即初虧及復圓交周也依此交周復查表得
初虧視距度三分三十三秒而復圓得八分五十三
秒因此畫本食圖如乙丁及丙戊兩直線以直角在甲
相交指南北東西方乙丁為黃道甲心為太陽居其中
依前食論其太陽半徑得一十五分一十五秒較太隂
半徑略小甲戊線則并兩輪半徑為
三十二分五秒因太隂食甚在辛
甲辛乃當時視距度六分一十
秒初虧在壬即乙壬與甲己相等只
三分三十三秒復圓在庚得丁庚與
甲癸相等共八分五十三秒而壬辛
庚皆視距南也
新法算書卷六十九
