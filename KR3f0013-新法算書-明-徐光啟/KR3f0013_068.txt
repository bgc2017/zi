新法算書卷六十八明徐光啟等撰
交食歷指卷五
視差以人目為主第一四章
前言實會中會視時食限等皆日月食之公法也是皆凖
於地心今再論月食生於地景景生於日故天上之實
食即人所見之視食無二食也日食不然有天上之實
食有人所見之視食其食分之有無多寡加時之早晚
先後各各不同推步日食難於太隂者以此其推算視
食則依人目與地面為凖
視會
凡交會者必參相直不參直不相掩也日之有實食也地
心與月與日參居一線之上也其有視食也人目與月
與日參居一線之上也人目居地面之上與地心相距
之差為大地之半徑則所見日食與實食恒偏左偏右
分為兩直線各至於宗動天其所指不得同度分是生
視差而人目所參對之線不得為實會而特為視會
如圖甲為地心乙為地面丙為天頂若丁為日戊為月
即在甲丙一直線上則實會即為視會因地心與人目
無分線故也若日在辛必月在壬方與地面乙作一線
為視會矣若月至己與地心甲作一線
則實會也今言交食惟以目見為憑故
日食全論視會若所居地面不同即食
分多寡加時早晏亦随之異也又視會
實會在日月本天皆無度分可指而全依宗動天之黃
道圈度分則此實會線所指謂之實度視會線所指謂
之視度如圖甲辛線所指為黃道之庚則庚為太陽之
實度若乙目視辛日至黃道癸視己月至黃道午則癸
為太陽之視度午為太隂之視度也
日月目見之度非實度
譬之畫圖者作平圓形則一舉手一運規即得矣若欲為
螺旋線先須依法作識又依法作線乃成形焉測天之
法亦猶是耳今欲知日月纏離東西南北亦轉儀闚表
一覽可知若欲定其本行所在則非聊一寓目遽能得
之必先後累測度分展轉較勘乃可定也假令目居地
之中心(地之心即宗動天之心)極目所見則有恒星以當彼界兩
界中間有日月五星是名七曜七曜相視有遠有近無
有同者即論一曜亦各時遠時近無時同者是則目所
能見也然因目所見得其視度於彼界因以視度測其
與某恒星相距若干度分因以是度推其實與地相距
若干遠近則可謂即目所見遂得其實行能分别其去
地遠近則不可何者七政諸本天雖居恒星天之内乃
不見火木土等内天之星以本體能掩最外之恒星則
何從辯其内外遠近乎又目所見者太隂太陽二體相
若何從知其内外之相距絶遠二體之小大絶不相等
乎内天之兩星參對於外天之兩經星目見之能知外
者之兩相距甚遠内者之兩相距不甚遠乎是三者皆
目力難憑之效也或曰是則然矣測量之法皆憑目所
見也則可廢乎曰何可廢也惟測内天之星得彼界所
指之點以為即在恒星之天聊可得之矣何者凡用在
界之弧以測其輳心之角無弗真者目測恒星之天其
在地面與其在地心也無以異(地居恒星天中止當一點)若測内天
諸曜目雖不在地心相距亦不甚遠故測日月五星於
彼界上得點即與實度相近(曰聊可得之曰距不甚遠曰近其實度皆因有地半)
(徑視差故)但恒星有時不見或與内天諸曜不相值故歷家
以地平代恒星更用遠視之噐以助目力得日月五星
之視度分依法推步乃正得其實度分矣
人目差
兩目賅存不惟相助以為明相代以備患亦能彼此互用
以察物之遠近蓋各以其心(目睛最中之一點為心)受外物之象
其過心之兩直線至物體則相遇為兩腰兩睛心自相
距為底成三角形因以其比例之大小别物距目之遠
近是謂目差緣此可推天上之視差以小喻大其理一
也若物大遠於人目則底線極小兩腰極長是過睛心
之兩徑線與平行無異正如地球比恒星天之高特以
一點為底視差無所繇生矣
如圖兩目之心為甲為乙目所視之物為丙若甲乙線
可比於甲丙線(可比者不甚遠則有比例)
則兩戊己徑線漸相就如己
而相遇於丙若物更相近為
丁則兩徑速相就為辛庚(甲乙丙及甲乙丁兩三角形皆等邊又同一底線則丁角)
(大於丙角而丁甲乙角必小於丙甲乙角)而兩目之光線皆從己歛向於庚
自覺所視之物變遠為近矣若物與目相去甚遠則無
比例者因兩徑絶難相就絶難相遇故也今借此理明
視差之公理如本圖設丁物之前有横堵為壬癸令甲
目獨視丁物則所見若在壬令乙目獨視丁則所見反
在癸而丁前丁後兩交角形必相似即丁物亦不遠於
壬不遠於癸蓋視之目分兩線為交角即能分本物之
遠近也若不能分兩線即不能分遠近
地半徑差
目視星欲辨六曜(月五星也)在恒星之内勢不能也則當借地
體之大補目力之不及法用地半徑為底以推測量所
指之界即可得七政遠近上下各居本天之實處如圖
甲乙兩目相距為底則二寸耳今以兩地相距數千里
或數里當之以為底如甲為順天府乙為廣州府丁為
太隂兩人同測之一在甲一在乙因此大底之遠近比
於各距太隂之兩腰得大小之比例則甲丁及乙丁兩
直線必覺彼此相就以趨於丁
矣再使壬癸為列宿天之兩恒
星(或壬癸為太陽之全體壬當其南周癸當其北周)測
者一從甲見太隂丁若在壬以夲體合於一星之體(或太)
(隂之南周齊太陽之南周)一從乙測太隂反在癸轉就北以合於他
星(或太陽之北周)若甲乙兩測之距愈相遠即所見丁月兩指
之極高亦愈相遠(一偏南一偏北東西亦同)而人在甲能見太隂掩
日為日食人在乙即不可得見矣以此壬癸當宗動天
上之弧正所謂視差與前言目見之小視差其理一也
第兩人相距千里萬里同時並測太隂其勢甚難故立
别法代之(詳見本書第六卷下文略言之)假令人正居地心推其所得
太隂距天頂應若干度分又同時居地面者實測太隂
距天頂得若干度分兩度之差即所謂視差也如圖甲
乙丙為地球丁為天頂甲戊丁直線所至也若太隂在
此線左右為己從甲地心測月見之
當在庚自地面乙測之乃在辛則先
推定丁甲庚角或所當之丁庚弧後
推丁乙辛角或所當之丁辛弧(乙距甲與乙距丁無比例甲乙至小故)以
兩角或兩弧相減得視差之弧庚辛
問一星距天頂測其宗動天上所指度分在地心測之
則距近在地面測之則距遠若論角則地面之乙角大
於地心之甲角何以證之其故何也曰因其一遠一近
如圖太隂在本天其距頂之弧為己戊己戊之距地心
甲與其距地面乙遠近之差則目所能識也所能分也
(因地之半徑與月本天之半徑有比例故)則目之在甲與
在乙所受己戊弧之象實不能無大
小為己戊弧等而兩角之大小不等
(目受物象皆以角形見交食第一卷)相近者必大遠者必小也角既有大
有小所相當之弧不得不有大小則辛之距天頂視庚
之距天頂不得不遠矣又論辛庚視差實為辛甲庚角
所定何用辛己庚或甲己乙角乎曰甲乙線與甲庚線
無比例(小大絶遠故)而甲乙與甲己則有比例即甲己與甲
庚亦無比例也既甲乙與甲己同為微末不以入算則
用辛己庚角代辛甲庚角無以異矣若
論角則丁乙辛角與丁辛弧相當(因甲乙與)
(乙丁無大小之比例)又丁乙己角與乙甲己及甲
己乙兩角并等(見幾何第一卷十六題)則兩角并亦與丁辛弧相
當矣今丁庚弧既與丁甲庚角相當則餘弧庚辛必與
餘角甲己乙或辛己庚相當也
視差以天頂為限第二六章
人目在地面或在地心仰視天所得日月道相參直者止
有一不同者無數過兩目之垂線止一至頂之線此外
分離處處各異
三視差
視會與實會無異者惟有正當天頂之一點過此以地半
徑以日月距地之遠測太陽及太隂實有三等視差其
法以地半徑為一邊以太陽太隂各距地之遠為一邊
以二曜高度為一邊成三角形用以得高庳差一也又
偏南而變緯度得南北差二也以黃道九十度限偏左
偏右而變緯度得東西差三也因東西視差故太陽與
太隂會有先後遲速之變二曜之會在黃平象限度東
即未得實會而先得視會若在黃平象限西則先得實
會而後得視會所謂中前宜減中後宜加者也因南北
視差故太隂距度有廣狹食分有大小之變如人在夏
至之北測太隂得南北視差即以加於太隂實距南度
以減於實距北度又東西南北兩視差皆以黃平象限
為主蓋正當九十度限絶無東西差而反得最大南北
差距九十度漸遠南北差漸小東西差漸大至最遠乃
全與高庳差為一也(三差恒合為句股形高庳其弦南北其股東西其句至極南則弦與)
(股合至極東極西則弦與句合也)
論日月視高差
太陽出地平上漸升至天頂得九十度在夏至則離赤道
北二十三度半為丁辛如北極出地四十
度即赤道離地平五十度加丁辛二十三
度半得七十三度半此日在午正之高也
今太陽未至子午圈别作一高弧從甲過
太陽垂至地平上為甲乙丙弧其乙丙既太陽未及午
正之圈即其高不至七十三度也兩曜去天頂有高庳
與恒星有遠近時時處處不同故其視差大小亦各不
同惟曜在天頂則無差若下幾度則少差愈庳愈差庳
至於地平則得其極大差矣今先論太隂如圖甲為地
心乙為地面丙為天頂丁己為太隂
本天丙戊為恒星天若人在地心甲
視太隂正在地平己直至戊在參宿
第三星下人在地面乙視太隂己直
至壬在參宿第一星下是壬戊不同度至一度六分
為太隂之極大視高差若太隂高至庚至辛視差漸減
如在丁直視至丙人在甲與在乙悉無交角無差分矣
太隂距地心最近者為乙地面至其本體得為地半徑
者五十六个(後言一个者皆一地半徑省文也)若太陽甚遠於地自地
面至日輪得一千餘个其差更小日
出地平之最大差止三分漸高漸小
矣凡推日食恒以太陽之視差減太
隂之視差得兩曜之視差假如甲乙
為地球丙丁為日月本天皆如前於最上之天(或指宗動或指)
(恒星其理同也)得戊庚為太隂視差得己庚為太陽視差相減
得戊己為兩曜之高庳視差
求太陽高庳差
凡地半徑與星距地心之遠此兩直線若能為大小之比
例者即人在地面所測與星所在之實度分不一是為
視差若星距地甚遠其距遠之線極大地半徑極小兩
線絶不能為比例即人所測與地心所出兩直線所指
之度不能分即不能為視差故求星之距地遠近恒以
視差為證以視差之多寡不等推其距地遠近亦不等
如測恒星無視差可證其距地最遠測填星微有之僅
得數秒而測太隂所得過一度因知七政之最遠者為
填星最近者為太隂而太陽得視差三分當在其中央
矣太陽太隂之距地遠近如前以月食求之其法更易
今以其遠近及地半徑反推其視差定為高庳差表如
圖甲乙為地半徑甲戊為太陽距地心之遠任在本天
最高或最庳或高庳之間皆有小異今設在高庳之間
者如日初出在丙則甲乙丙三角形内乙甲丙為直角
甲角直線為甲乙者一千一百四十
二个(此中數也)推得甲丙乙角三分為太
陽之最大高庳差若太陽在丁其丙
丁高弧三十度則以餘弧之乙甲丁
角推得高庳差二分三十六秒為甲丁乙角若丙丁高
弧六十度則甲丁乙為一分三十秒依高度推高差皆
凖此至天頂戊即無差
求太隂高庳差
太隂之距地既近視差既大即其在本輪之最高最庳次
輪之最遠最近視差大小亦皆變易其在本輪最高次
輪最遠(一限)則距地依歌白泥算六十八个二十一分以
六十度高弧推之得視差二十五分二十八秒若在本
輪最高次輪最近(二限)距地六十五个三十分以同前
高度推視差二十六分三十八秒若在本輪最庳次輪
最近(三限)其距地五十五个八分以同高弧推得視差
三十一分四十二秒若本輪最庳次輪最遠(四限)距地五
十二个一十七分以同高度推得三十三分二十八秒
是為同六十度弧之最大視差若他高度其法同此所
推視差各異矣又太隂在小輪高庳遠近時時變易視
差随之無能不變欲考其幾何如圖甲為太隂本輪之
心從地心壬出直線過甲至辛指最高於乙最庳於丙
是為次輪心一在最高
一在最庳而己丁及庚
戊兩弧皆設六十度引
乙丁及丙戊直線得甲乙丁及甲丙戊兩三角形今先求
次輪在本輪最高遠近之間各度生何視差借太隂
歷指所定以地半徑量諸輪之半徑得甲己為五个一
十一分甲壬為六十个一十八分而己辛止得二个五
十一分則甲乙丁三角形内得乙丁為一个二十五分
(地半徑為个个六十分)甲乙為六个三十六分丁乙甲角六十度
推得甲丁線六个七分以并壬甲總得六十六个二
十五分大於壬己線五十五徑分有竒是名剰分今更
設比例分論之如壬己為六十比分即己辛得二比分
三十七秒而剰徑分五十五當化為四十六比秒又己
辛當六十比分依法推得一十八分正(六十與一十八若二分三十七)
(秒與四十六秒)為次輪上六十度己丁所求高差應減於最近
己高差也次論甲丙戊三角形其兩線甲丙戊角及剰
分同前但壬庚線得五十五个八分亦以當六十比
分即庚癸得三比分七秒而剰徑為五十五比秒又
庚癸當六十比分亦推得一十八分(六十與一十八若三分七秒與五)
(十五秒)是為次輪上六十度庚戊所求高差應加於最近
庚高差也蓋依前所定四限丁六十度在一辛二己遠
近之間高於己得視差少於己故剰分推視差以減於
己得太隂在己正高庳差戊六十度在三庚四癸遠近
之間庳於庚得視差多於庚故剰分所推視差以加於
庚得太隂在戊正高庳差也其餘次輪之遠近度求視
差皆凖此
太隂在朔高庳視差
本書二卷論太隂交會時恒居次輪之最近所謂第二第
三限在前圖為己為庚也因太隂食日加時恒不在本
輪之最高最庳而月行次輪周恒倍於本輪周故朔望
時太隂恒在次輪之最近最近所行之周名本輪之内
圈是大於次輪小於本輪以己庚相距之線為徑今欲
求内圈之上下左右各度得何高庳視差如圖己丙庚
内圈己為高最遠庚為庳最近乙距地心甲為地半徑
六十个一十八分(設歌白泥之數以為)
(法)己丙弧六十度乙丙得五
个一十一分與甲乙六十个
十八分同類之徑分也以甲乙丙三角形推太隂在丙
距二限已六十度得甲丙線六十三个四分因得甲
己六十五个三十分剰得二个二十八分今設己庚
為六十比分即推得一十四比分(六十與一十四若己庚十个二十二)
(分與剰徑二个二十八分)為剰分以推太隂在丙之視差加於在己
之視差得太隂之真視差
假如太隂距天頂四十二度在本輪七十二度在次輪
六十度總論其變視差以距頂倍之度查本表得太
隂在遠近之第二限有高庳差三十五分三十一秒以
較第一限贏一分二十九秒今距第二限六十度依
前法推得一十八分而六十分與一分二十九秒若一
十八分與二十七秒則於二限高庳差減二十七秒餘
三十五分四秒是一二限間次輪行六十度之高庳
差也又第三限較第四限之視差不及者二分一十九
秒而六十與二分一十九秒若一十八分與四十二秒
以四十二秒加於第三
限之四十二分一十九
秒為四十三分一秒
是三四限間六十度之高庳視差今太隂行本輪七十
二度又在二三限之間法以丁戊上兩視差相減餘七
分五十七秒於時太隂自行得二十比例分則六十與
七分五十七秒若二十與二分三十九秒以二分三十
九秒加於前推一二限間次輪六十度之視差三十五
分四秒得太隂居高庳遠近之間本輪七十二度距
天頂四十二度次輪六十度之真視差三十七分四
十三秒凡以距天頂餘度求四限間之視差法皆凖此
其在二三限日食所用有立成視差表依諸高度及距
地遠近簡之
測日月求高庳視差
借月食推太陽太隂距地心遠近而求視差以三角形推
算為常法欲從天行求之則測日月高度以比其實緯
度兩度之較為高庳差也隆慶六年壬申有客星見王
良北西史第谷以視差求其距地之遠立數法試之其
一候其至子午圈同恒星在極高度測其相距遠俟行
半周在極庳度復測之得遠近之差以推定其高庳差
其一用北極出地度考之從極上極下測一恒星得其
高庳差度半之以加於下測之度或減於上測之度若
未得北極出地之高度即有視差其一南北相距兩地
同測一星以較於北極或於恒星彼此得度有差則有
視差其一測星之高度依法以加以減不正得其赤道
上之本緯度則視差所移易也今測日月其距極甚遠
又有出有入非如北極恒星常見不隠二曜亦不能同
時並測即諸法不可盡用備述此者明測候之理且以
需他用耳
假如萬歷十一年秋八月太隂黃經度從冬至起得一
十五度四十分黃道緯距北二度四十二分第谷測
其子午高得上周一十三度三十八分其半徑一十五
分蒙氣八分皆以減於高度餘實高度一十三度一十
五分因太隂在赤道南以減本地赤道高度得太隂赤
道緯度二十度五十分第以前黃道經緯推本方
之實赤道緯僅一十九度五十七分則以相減得五十
四分為太隂一十三度一十五分之高庳視差也又萬
歷十五年六月太隂黃經度從冬至起得七度五十
分黃緯五度有竒推其赤道實緯度一十八度五分
測其上周高一十五度二十分下周一十四度四十
六分得徑三十四分太隂心高一十五度三分内減
蒙氣六分餘與赤道高相減得一十九度八分為太
隂赤道距度較實推贏一度三分是為本方之高庳
視差也從兩視徑觀之可見徑大者近於最庳小者近
於最高故所測高度略同所推視差大相遠矣又萬歷
十四年九月測太隂高四十五度其視徑三十四分於
時離鶉火宫十一度一十分而本度距地平正當黃
道九十度限不必用赤道緯度以求視差祗以黃道實
緯度四度四十五分減視緯度距南五度三十分得
四十五分為太隂高四十五度之高庳視差也
以四方分視差第三五章
視高差無定方惟日躔月離所在從天頂下垂線過曜至
地平為直角其過曜處分視實之高庳而已至黃道經
緯度亦依視高而有變易則因日月視度從黃道偏南
北或偏東西或正或斜随所在得其横直視差為南北
東西差
三視差總圖
前論視高差為過天頂大圈之弧止向地平随方取之今
論南北差是過黃極大圈之弧為黃道兩平行圈所限
也其一過實度其一過視度東西差則黃道之弧為過
黃極兩大圈所限也亦一過實度一過視度三視差弧
獨黃道正南北或正東西則合為
一弧外此必成三角形以法推每
邊之度分也如圖甲乙為地半徑
丙為太隂丙丁為月本天戊己庚
為黃道壬己癸為過天頂象限從
地心出直線過太隂為甲丙至宗
動天指其實度為辛若從地面出乙丙線指其視度為
午則辛午弧為太隂高庳視差午申弧與黃道平行過
太隂視度於午未辛酉弧亦與黃道平行過太隂實度
於辛則兩平行弧間午未或辛亥為太隂南北視差又
亥辛及午未為過黃道極大圈之弧則亥午在其中為
太隂東西視差合三視差得午未辛或亥辛午三角形
今依本圖設日食在黃平象限西太隂以實行在子正
對太陽在己人在乙尚未見食必太隂過東至丙乙丙
己參相直則見食是為視會是實會在先視會在後也
若食在黃平象限東即反是如次圖更易見設乙甲丁
為地平戊為天頂甲辛己為黃道丙為
其極太陽或太隂在己為實度但人不
在地心在地面如庚視太隂在壬則己
壬為高差從丙至己至壬作丙己丙壬
兩弧線即得甲己線交黃道於辛而辛
己為東西差辛壬為南北差
高弧正交黃道南北東西差
以高弧與黃道相交之角分南北東西差可得其幾何蓋
兩弧相交以直角則高弧正為距度弧不偏東西即絶
無東西差而高庳差徑為南北差若黃道自為高弧而
太隂在交處無距度則高差徑為東西差而絶無南北
差若太隂有距度則黃道不同於高弧太隂不免有東
西差亦並有南北差如圖甲戊為黃
道即為高弧與地平為直角甲為天
頂太隂在丁則其高差丁戊即為東
西差若太隂距南或北作大圈過黃道之兩極為乙丙
其距度為丁乙丁丙得甲乙甲丙弧與甲丁弧必不等
又不交於乙丙弧之極故甲乙丁甲丙丁不能為直角
而並得南北東西差且太隂愈近天頂乙丙兩角愈銳
南北差愈多太隂愈遠於天頂兩角漸大殆如直角而
南北差漸少
高弧斜交黃道南北東西差
太隂有距度求視差甚難其理甚繁其在交無距度者稍
易稍簡故先之設黃道為甲乙丙其斜交之高弧為丁
乙戊太隂無距度在乙其視高差為乙戊得南北差為
丙戊東西差為乙丙成乙丙戊三角形其形有丙戊為
過黃道兩極之弧則乙丙戊為直角有丙乙戊角其相
當弧甲丁過高下圈及黃道極之弧也
有乙戊視高差法以曲線三角形之理
推乙丙丙戊兩視差之弧但此三角形
小其三邊皆為大圈之弧可用直線法推之再設太隂
不正在交有距度或南或北如圖丁乙為過地平兩極
之高弧甲乙丙為黃道太隂距南在戊距北在己其黃
經度在乙從天頂得丁戊為太隂距
南高弧丁己為太隂距北高弧因實
度在戊在己視度在庚在壬得戊庚
及己壬為太隂視高差又得庚癸壬辛弧其至癸至辛
指太隂視經度與黃道為直角今以實經緯及北極出
地度算南北東西差
假如以北極高得乙丁過頂弧又有乙戊為太隂距度
弧有甲乙丁為高弧交黃道之角加甲乙戊直角得丁
乙戊角可推丁戊弧及丁戊乙角若太隂距北有丁乙
己為高弧交黃道角之餘角亦可推丁己弧及丁己乙
角又查丁戊丁己視高差表得戊庚及己壬而太隂距
南乙子戊三角形内有子乙戊直角有乙子戊高弧交
黃道之角有戊乙距度弧可推子乙及子戊弧則子癸
庚三角形内有子庚弧有庚子癸角有子癸庚為直角
可推庚癸視距度去減乙戊實距度得南北差亦可推
子癸黃道弧減子乙得乙癸東西差其太隂距北則乙
癸己三角形内有距度乙己有乙己
癸角有乙直角可推乙癸及己癸弧
及乙癸己角去減己壬視高差得壬
癸弧又壬辛癸為直角可推辛癸及壬辛於乙己距度
去減壬辛視距度餘為南北差乙癸減辛癸餘乙辛為
東西差
如上說細論視差於理為盡若恒時推步别有捷法力
省大半盖丁乙己角可當丁戊乙角甲乙丁角可當乙
癸己角丁乙弧亦可當丁戊及丁己弧故也若本地距
黃道遠依此算即不得有差惟黃道在天頂太隂之大
距五度又在本天最庳則差至六分不得用此若太陽
將食即太隂居食限之内距度不過一度半依省法算
所差者不過一分四十五秒欲并無差仍用原法
太隂無距度以視高差求南北東西差
依圖乙壬戊為子午圈乙甲丙為地平壬為天頂丁甲戊
為黃道壬己為高弧太隂在辛則辛己為視高差自黃
極癸出癸辛癸己兩大圈弧限辛庚
為東西差庚己為南北差此三角形
有己庚辛為直角辛己為高差更得
高弧交黃道之角庚辛己則視高差
辛己之正弦與南北差庚己之正弦
若全數與庚辛己角之正弦
假如高弧交黃道之角庚辛己得六十四度三十五分
一十五秒其正弦九三二四視高
差弦辛己得五十八分三十六秒正
弦一七四算得正弦一五三九查
其弧得五十二分五十四秒為太隂
南北差庚己此用正弦法也或用加減算求南北差則
以辛己高差減庚辛己角餘六十三度三十六分三十
九秒得餘弦四四四四六又相加得六十五度三十三
分五十一秒其餘弦四一三六八兩餘弦相減餘三
七八半之得一五三九為南北差之正弦也或用線求
東西差則全數與庚己南北差之割線若辛己高差之
餘弦與庚辛東西差之餘弦或用角求東西差則庚辛
己曲線三角形甚小可用直線三角形法其高差之正
弦與東西差之正弦若全數與高弧交黃道角之餘弦
假如用線推南北差五十二分五十四秒得割線一
一一八五視高差五十八分三十六秒其餘弦九
九九八五四七推得九九九九七三一為餘弦得二十
五分一十秒為庚辛東西差再以角求東西差則庚辛
己角之餘弦四二九一三高差之正弦一七四算得
七三一為正弧亦查得二十五分八秒為東西差或
用加減算則高弧交黃道角之餘二十五度二十四分
四十五秒減高差餘二十四度二十六分九秒其餘
弦九二四二加高差得二十六度二十三分二十一
秒其餘弦八九五八兩餘弦相減餘二四六二半之
得正弦七三一查得二十五分八秒為庚辛東西差
太隂有距度以高差求南北東西差
前題算有距視差法簡矣又有簡於此者但依太隂時距
南時距北分兩圖解之如圖甲己丙為子午圈甲乙丙
為地平乙丁為黃道天頂在己太隂
在子則己癸為高弧子癸為高差又
辛當北極北極圈為戊庚負黃道極
戊自戊出大圈之弧戊壬過丑指太
隂實經度而丑子為實距度又出一
大圈弧戊癸至太隂視度癸從癸作垂線至壬得壬子
癸三角形而子壬為南北差壬癸為東西差(丑壬寅癸兩弧小故)
(壬癸可當丑寅)欲求其幾何先依第一法從天頂己連赤道極
黃道極為己戊辛三角形形有兩極相距之弧辛戊有
北極出地之餘弧己辛有極至交圈
交於子午圈之己辛戊角可推黃極
距天頂之線己戊次己戊子三角形
有黃極距天頂之弧己戊有太隂出
地高之餘弧己子又有戊子在第一
圖為象限戊丑加太隂實距度丑子之總弧在第二圖
為太隂實距度丑子之餘弧可推己子戊角次子癸壬
三角形有高差弧子癸有壬子癸角有子壬癸直角可
推子壬弧是為太隂南北視差又本三角形以子癸高
差子壬南此差推壬癸東西差
假如第谷測太隂在玄枵宫初度五十六分距南四度
三十八分日在申正五十分得太隂高弧九度二十
分得高差五十四分二十秒其夲方北極出地五
十五度五十四分三十秒即升度為三百一十二度
四十三分去減鶉首初之升度餘為極至圈交於子午
圈之己辛戊角而己辛及辛戊兩弧皆不及九十度則
己辛戊為銳角法全數與第一弧之正弦若第二弧之
正弦與他數(名先得之數)又全數與先得之數若兩弧所包
角之正矢與他數(名後得之數)而後得之數恒加於兩弧較
差之正矢得第三弧之正矢如前圖
依第谷測己辛戊三角形求己戊弧
則兩道大距弧辛戊(第一弧)之正弦三
九九一五其夲方極高餘己辛弧(第二)
(弧)之正弦五六五二求先得之數
為二二三七三又己辛戊角(兩弧所包角)四十二度四十三
分得正矢二六五二八求後得之數為五九三五以加
兩弧較差之正矢一六九六得七六三一為己戊弧(第三)
(弧)之正矢查得二十二度三十一分四十一秒以求己
子戊角則己戊子三角形内全數與第一旁線之餘割
線若夲角旁次線之餘割線與他數(名先得之數)又兩旁線
較差之正矢與對夲角線之正矢相減餘為他數(名後得之)
(數)而全數與先得之數若後得之數與本角之正矢如
前圖己子(角旁次線)為太隂距天頂弧八十度四十分
餘割線一一三四二戊子(第一旁線)為太隂距南加象限
共九十四度三十八分餘割線一三二八算得一
一六七四為先得之數其較弧較差一十三度五十
八分得正矢二九五六減己戊弧之正矢七六三一得
四六七四為後得之數依法算得四七五四為己子戊
角之正矢查得一十七度四十四分一十五秒以求子
壬弧則全數與子癸高差弧之切線若壬子癸角之餘
弦(壬子癸與己子戊兩交角等)與子壬弧之切線而子癸弧之切線
一五九四壬子癸角之餘弦九五二四八算得壬子弧
之切線一五一八查得五十二分一十秒為太隂南
北差之子壬弧以求東西差則全數與子癸弧之餘弦
九九九八七五一若子壬弧之正割線一一一
五一與壬癸弧之正割線算得九九九九九二為壬
癸弧之正切線查得一十五分一十秒為太隂東西
視差壬癸或寅丑
又次法甲乙地平甲丙黃道戊癸高弧丁黃道極皆同
前此圖加戊辛為太隂實經度出地
平高之餘弧而戊辛己三角形内又
有太隂實高度之餘弧戊己有太隂
實距度己辛以此三邊徑推戊己辛
角為高弧交太隂緯弧之角其餘角
(前圖)或交角(後圖)為壬己庚角
假如依前算戊己八十度四十分得餘割線一
一三四二太隂距南辛己四度三十八
分餘割線一二三七九四七算得一二
五四五六為先得之數以本兩弧之
較差七十六度二分得正矢七五八
六四戊辛弧七十六度一十五分三十秒得正矢七
六二四五以相減得二八一為後得之數又算得四七
六為戊己辛角之正矢查得一十七度四十五分
日食掩地面幾何
太陽有全食或周邊無光而晝晦星見者有全食而周顯
金環者又有食不全而此地見食之分多彼地見食之
分寡者今欲求見全食之地幾何廣見金環幾何遠自
見全食之地至盡不見食之地幾何更求相距幾何地
即見食漸差一分此四者大概依視差推算種種具有
法焉
全食不見光之地面
依第谷測定蒙氣之高距地面上約有九里欲求全食時
得人所共見里數若干即以蒙氣高與太隂視徑及太
陽光氣内曲之角定之蓋交會時太隂當日目之中掩
太陽光其視徑必大於太陽視徑而人目所周之地平
自無光矣但日光從最通明處射地而来一遇次通明
之蒙氣即曲而斜照(見本歷指第一卷)必依氣之高低漸漸聚
合廣狹不等如氣太高則光不至地面而聚合可無滿
景氣太低則光一曲即至地月景反覺開展不止恒測
之界今設氣高九里以絶日光必月景近地占千餘里
必太隂視徑大於太陽視徑四分有餘乃可論食在天
頂也若食在下度則月徑可小景或反大圖中蒙氣高
為甲丁求甲乙丙以定甲丙不受光氣
之拓界乙丁乙丙皆地半徑約一萬二
千里則乙丁與全數若甲乙與甲乙丙
角之割線算得一六查本表得一度五十九
分為甲乙丙角又全數與本角之切線若丙乙線與甲
丙線得里數為五百一十九即太隂在頂滿景之半徑
也而全徑則一千三十八里蓋食距地平高三十度
即太隂視徑大於太陽視徑止一分必滿景徑得千餘
里視徑加大里數亦多然蒙氣差表未譯故止以地半
徑差别求之
法日月兩半徑相減以差數加太陽視差即於表中本
高度前後查太隂高下視差與得數等即以高度差前
後各得滿景半徑若視差與得數不等即以中比例法
求相應之高弧加於高度差如太陽行最高得視半徑
一十五分太隂行最庳得視半徑一十七分二十秒
差數為二分二十秒試以食在天頂(廣東廣西等處夏至時是)下
二度為八十八以本度查太陽視差表得六秒加兩半
徑差數得二分二十六秒於太隂視差表中以八十八
度查二分一十四秒所不及者為一十二秒依比例算
得一十一分宜加於二度即更下去頂愈遠也故天頂
正下為滿景之心前下二度一十一分景缺即初見光
其界限約五百四十六里後下高弧等得里數亦等共
得一千九十二即同食甚時同見食掩地面之廣也
欲論先後時刻自初見滿景至復見生光則日月並随
宗動天行之度化為里數所得見滿景必不止數千里
矣若太陽行最高太隂在高庳之正中其差數加太陽
視差共一分二十秒算食甚時得滿景二度二十八
分為里數六百一十七又太陽及太隂皆在最庳得總
差數一分五十三秒算食甚時得八百四十二里為滿
景至於兩徑相等或太隂不甚大於太陽即無滿景因
蒙氣曲光内射故也
試食甚在下度距地平七十度太隂在最庳得視差
二十一分四十六秒更下二度得視差二十三分四十
九秒差二分三秒至兩半徑差數餘一十七秒加太
陽在最高從七十至下二度強所變視差度七秒總
得二十四秒即以比例算應高弧二十四分總得二度
二十四分化為里得六百即地平上自中往後見滿景
之地也若往前設地平高七十二太隂視差一十九分
四十秒較於太隂高七十度之視差差二分六秒
至兩半徑差餘一十四秒加太陽變視差七秒(上下加求太隂)
(從太陽視差故)總得二十一秒因以比例算得二十分加於七
十二度化為里得五百八十三即往前之滿景前後相
加總得一千一百八十三里乃食甚同見滿景之地也
依本法推算食甚距天頂愈遠得滿景愈大而自其中
心論前後兩半徑必随高下度不等如食甚距地平高
四十度在前得三度二十三分為八百四十六里(景之)
(前應高度多查表求後景之後應高度少查表求前)在後得三度三十八分為九
百八里總七度一分為一千七百五十四里若食
高二十度必前行一千四百八十三里即五度五十
六分後行二千二百八里即八度五十分總三千
六百九十一里為滿景因視差近地平變少必度多即
得變數與兩徑差數等徑差少(或太陽在最庳或太隂距最庳略遠)即高
度進退亦少里數亦減矣
見金環之地面
太陽在最高其視徑較太隂在最高之視徑略小較在中
或最庳愈小無比故全食之食甚不顯餘光而周無金
環明矣其在中距與太隂在最高之視徑等雖因蒙氣
可顯金環然以大小之故不能畢露且蒙氣所生大小
随時随處不一則亦無從可定耳自中距以下太陽視
徑漸大較太隂在最高至最庳即大三十秒矣設食
甚在天頂因周大一十五秒得四圍去中心遠四分度
之一而可見金環者約有六十二里乃全徑則一百二
十五里為此時所同見至先後可見之地者又不止此
若食甚距天頂愈遠得金環愈大假如距四十度(高弧五十)
(度)依前一十五秒應得二十分全徑則四十餘分以三
十度高弧應得全徑一度二十度高弧應得一度半一
十度應得四度化為里約一千里何也因視差近地
平變少得度多故也若論蒙氣愈加得金環愈大因此
第谷居北方設月朔半徑大於望半徑亦此意也
總見食之地面
求滿景及金環俱以日月視徑為主如太隂大於太陽則
生滿景太陽反大即為金環此一定之理也今欲得滿
與缺之景幾何或從見滿景地面(食既是)至漸不見景地
面(復圓是)即以兩曜最高最庳之行求之蓋日月皆在最
高見食地面少皆在最庳見食地面反多(因正在高庳故倘相距漸)
(遠其食景大小亦漸變易)一在高一在庳則見食多寡均矣論天頂
全食法加日月兩半徑以總數查表所得數或等或小
加此兩數之差更加太陽視差復得總數復查表其旁
所得高度即自景中心至不見食之界也(總數不正合高度用中比)
(例法求之)假如日月皆在最高加其半徑總得三十分一
十五秒查表太隂距地最遠之方所對六十高度得三
十分六秒較兩半徑總數差九秒太陽視差一
分二十七秒三數併加共得三十一分四十二秒在高
度五十九及五十八間(自頂往下故)以中比例推得四十六
分乃自天頂至周界得三十一度四十六分為總見食
地面之半徑而全徑則六十三度三十二分化為里共
得一萬五千八百八十三使日月皆在最庫兩半徑數
并得三十二分五十秒查表本方内得相對高度五
十九依前法推得不止五十八度即見食之界距頂三
十二度五十分共六十五度四十分為里一萬六千
四百一十七若太陽在最高太隂在最庳總得六十四
度一十八分即一萬六千零七十五里使太隂在最高
太陽在最庳算得六十四度五十二分為里一萬六千
二百一十七
若論全食在下度食愈低其景愈大但地面不全受景
則人目在地面同見食之廣不全依高低度何云食愈
低其景愈大視日月兩輪大小約等以中心與目正對
皆居一直線上雖相距實遠目視之若同為一輪同在
一度今欲見其兩心相離不正在一線則自此地至彼
地勢若横行然蓋高度全食前後左右皆於日月為横
行愈高愈横得景亦少若全食在下度或前或後(以高弧及)
(同見為主前後非東西南北可定必随日月所居方併過目圈為是)多為對行而非横行
愈下愈對必行之多始得其體之離惟多行故遲出景
外所以食在下度愈低得景愈廣矣何云不全受景見
日食即因日月目併居一直線上(此論以體相對雖心不正在一直線會合)
(亦無妨)今全食在高度或前或後行凡日月目直線可對
者自正以心相對惟去離漸遠至以邊相對則以見食
至復圓為止若全食在下度目少進即見食漸高至兩
曜以邊居直線上亦能盡見其復圓使目退行少許見
食漸低兩曜先至地平不及以邊居線上因而體雖尚
對而所餘食分為目所不見矣縱使更退亦不得見復
圓故地面所受之景乃地景(日巳沒故)非日食之景耳推下
度全食之景法日月兩半徑并與食甚高度太隂之視
差順表相減餘數加太陽視差總數復查表得數等其
旁所遇高度即為前行見食之界若不等以中比例求
相應之高度與表兩半徑并加太隂視差更加太陽自
食甚高度至夲總數相應高度所變視差而末所得總
數必應高度即後行見食之界如日月皆在最高兩半
徑并得三十分一十五秒設食甚高八十度太隂
視差在此為一十分二十九秒兩分數相減餘一十
九分四十六秒約應高度七十一得太陽視差五十六
秒以加總得二十分四十二秒乃又應高弧六十九
度五十五分即前行至日月過頂二十度五分而
見食地面共為三十度五分若後行兩分數宜加
得四十分四十四秒約應高弧四十七度太陽視差
自八十至此變一分二十九秒以加總得四十二分一
十三秒應四十五度一十六分即日月高相離之界共
為三十四度四十四分乃後行見食地面之徑也設食
甚高為六十度依本法算得前行見界距三十度
九分過天頂較前徑略長後行則景長無比必行六
十度始見下地平其未見復圓者八十餘秒而前後地
面見景為九十餘度設食甚高四十度必前行三十四
度一十四分後行四十度乃下地平尚見食五分八十
餘秒總見景者七十四度設高二十度往前得四十三
度二十分往後行二十度止得見復光約一分總度六
十三度有餘愈下愈見少即此可知同見食之廣不全
依高低度因地面不全受景故也
若日月皆在最庳得半徑并最大數為三十二分五十
秒設高八十度必前行三十一度後行三十六度共
六十七度所同見食較前略廣設高六十度即前行
三十一度後行六十度未可見復圓蓋所少為一分二
十秒耳大概依餘日月半徑及餘高度求同見食之地
面皆倣此算而以度數更求里數論先後見食則以總
食之時及時氣兩視差細求之可也
見食進退一分應地面幾何
太陽任在本輪高庳距天頂遠近及在四方偏正俱分一
十平分而見食地面則依高弧取前後以定其徑蓋徑
之大小依高度前後不能為同即前所云較食在下度
與食在高度自得更大乃論滿景之公公論也今又設
為全食如前行即太陽從下生光漸至上復圓若後行
即從上生光至下復圓總進退間止在一十分内欲算
法於度數之分所應任取之徑分加太陽視差及日月
各半徑不等之分秒總數查表其旁所對高度即本徑
分之景界化為里得見本食之地面矣假如日月皆在
最高食甚在天頂設生光為一徑分(食退是)求所應之度
即十徑分與三十分(太陽全徑度數之分)若一徑分與三度數
之分以本三分入表查太陽視差九秒更有日月兩半
徑不等之一十五秒總得三分二十四秒應三度一十
三分即去頂生光之界共八百零四里若生光得太陽
半徑即五徑分當一十五度數之分加太陽視差四十
五秒及兩半徑不等之一十五秒共得一十六分應一
十五度二十四分距頂之界試以復圓即三十分查
太陽視差一分二十七秒加半徑不等之秒總得三十
一分四十二秒應三十一度四十六分乃與前求總景
之數正合若食若在下度如高六十度求一徑分相
應之高弧即以三度數之分如本六十高度太隂視差
得三十三分六秒約對五十七高度因至此太陽變
視差八秒宜加且更加兩半徑不等之秒總得三十三
分二十九秒應五十六度一十分即自食甚至一徑
分生光得三度五十分較前算自頂退一徑分多得三
十七分為一百五十餘里若求五徑分應幾何即於六
十度太隂視差加一十五分得四十五分六秒對四
十一度查太陽變視差四十四秒加兩半徑不等之秒
總得四十六分五秒應四十度四十五秒自食甚
至半徑生光得一十九度一十五分較前多三度五十
一分若日月在本圈别度得視徑大小較最高不同必
先求徑分所應度數之分幾何然後依本法算而進食
之分與生光之分亦同一理也
日食掩地面總圖
甲為太陽乙為太隂丙為目三者於食甚時皆居一直
線上以心相正對也設太陽視徑小於太隂視徑為丁
戊即地面得滿景為壬辛必自中心丙至壬至辛乃可
見丁戊日輪之邊耳設太陽視徑大於太隂視徑為庚
癸而目在中心丙以丙巳丙子直線見太陽庚癸邊必
周得金環倘退至壬或進至辛即不見之矣論滿景總
為丑卯自中心丙進前至卯即以卯丁直線見日輪復
圓退後至丑即以丑戊直線亦見復圓徑之大小在高
度低度其理一也
新法算書卷六十八
