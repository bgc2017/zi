新法算書卷二十六明徐光啟等撰
日躔表卷二
日躔表加減算
算加減表說
假如太陽距最高三十度求加減度法(全圖見日躔歷指今用半圖)
如圖日距最高甲為三十度至
乙丙戊兩心差為三五八四折
半於辛為一七九二作丙乙辛
辛乙戊線乙丙辛形有丙辛
一七九二有乙丙全數十萬有
丙辛乙角三十度從丙作丙丁
垂線於辛乙分元形為二一為丙丁辛一為丙丁
乙兩三角形
丙丁辛直角形有丙辛邊一七九二有辛角三十度辛為
心丙為界作弧以辛丙為全丙
丁為辛角之正弦辛丁為餘弦
法全數十萬(内)與丙辛一七
九二外若辛角正弦五
(内)與丙丁八九六外全與丙
辛若辛角餘弦八六六三與
辛丁一五五一
次以乙為心丙為界作弧乙丙為全丙丁為乙角之正
弦丁乙為乙角之餘弦查表得乙角三十分四十六秒
乙丁邊九九九九六乙丁丁辛并之得一一五四七
為乙辛邊乙辛戊形有辛戊一七九二有乙辛邊一
一五四七又有乙辛戊角三十度之餘為一百五十
度
乙辛引長作戊丁垂線成辛丁戊直角形
夫形有辛戊邊一七九二有戊辛丁角為鈍角之餘三
十度辛為心戊為界作弧定
戊丁八九六為辛角之正弦辛
丁一五五一為餘弦法全與辛
戊若辛角之正弦與丁戊或
餘弦與丁辛次以乙辛辛丁
并之得一三九八
乙丁戊三角形有乙丁邊一三九八有丁戊邊八
九六求乙角與乙戊邊乙為心丁為界作弧定丁戊
為乙角之切線法乙丁一三九八與全若丁戊
八九六與乙角之切線八六九查表得二十九分五十
三秒兩角并之共得一度分三十九秒為甲乙距最
高三十度之加減均數如表
假如太陽距高衝三十度求加減度法
乙丙辛形有丙辛一七九二有乙
丙全數乙辛引長作丙丁垂線成
丙丁辛直角形
夫形有丁辛丙角三十度為丙辛
乙之餘有丙辛邊求丙丁丁辛辛為
心丙為界作弧定丙丁為辛角之正弦辛丁為其餘
法全與丙辛若辛角之正弦與丙丁八
九六餘弦與丁辛一五五一
丙丁乙大形有丙乙為全數十萬丙丁
八九六求丁乙邊及乙角
乙為心丙為界作弧定丙丁為乙角之
正弦因丙乙為全數以丙丁查正弦表
得三十分四十六秒為辛乙丙角又取
其餘弦為九九九九六乙丁丁乙内減
丁辛一五五一餘九八四四五為辛乙
辛戊乙形有辛戊一七九二有辛乙九八四四五及戊辛
乙角三十度求辛乙戊角
從戊作戊丁垂線分元形為兩直
角形
辛戊丁形有辛戊及辛角以辛為
心戊為界作弧定戊丁為辛角之
正弦辛丁為其餘
法全與辛戊若辛角之正弦與戊
丁八九六餘弦與辛丁一五五一
辛乙内減丁辛得九六八九四為丁乙
丁戊乙形有戊丁八九六有丁乙九六八九四求乙角
乙為心丁為界作弧定戊丁為乙角之切線法丁乙
與全若丁戊與乙角之切線算得九二五查切線表得
三十一分四十四秒為戊乙辛角戊乙辛辛乙丙兩角
并之得一度二十分三十秒為太陽距高衝三十度之
加減均數如表
太陽周歲細行變時表說
太陽之行度有二一曰平行即一日為五十九分八秒
有奇一曰自行(自行亦名視行又名實行細行)自行有大有小極大者
為六十一分二十秒極小者為五十七分六秒(見周日細行表)
置太陽細行表法取自行之極大者六十一分二十秒逓
減半分迄五十七分六秒而止共十類成表(如六十一分六十分)
(三十秒等)
算法以二十四時化微為實以細行分秒化微為法而一
得日行六十分對時之數各半之再半又以約法收之
微收為秒秒收為分分收為時故設表有日行分其對
又有時分秒微也
查表法凡有太陽所行之分數命變時則以本日細行分
數取本表又以所行之分數向右行日行分下求其相
當數之對即得其時分也若元數尚有秒則命右行分
為秒其所得亦為分秒微亦如之
假如崇禎戊辰年算冬至得距子正為三十三分四十四
秒二十微命變時查冬至表右行求三十三其時為十
二時五十四分四十六秒五十七微又查四十四秒得
十七分一十三秒三微再查二十微得七秒四十九微
并之共得十三時十二分七秒四十九微
若所設日細行與表上方日行不合則用其相近數若欲
得細數則取其多寡兩數用中比例法然所差不能過
秒其數極微故不細錄
又如戊辰年算立夏得距子正三十八分五十六秒五十
七微命變時因立夏日距冬至為一百三十五日用一
百三十一日表向右行查三十八分得十五時四十三
分二十六秒五十三微又查五十六秒得二十三分十
秒二十一微再查五十七微得二十三秒三十五微并
之共得十六時七分秒四十九微
反之以時求分則於本日細行表中行求所設之時得右
行之相對數為分若中行無設時用近小數取其分又
以設時及近小兩數較之再查中行數右行得秒又用
近小數再求之得微并之得行之分秒微
假如有時積一十四時二十九分五秒一十二微而求
太陽之平行分則於本表(無本表則相近表為五十九分可用)中行取近
小數即十四時十四分十四秒十四微其右行有三十
五分又以設數與近小數較之為十四分五十秒五十
八微以十四分查中行之相近數右行有三十六秒又
有時之十二秒查得三十微并之得三十五分三十六
秒三十微
日差表說
測太陽行度以春分為本因春分時無分平日用日(太陽兩行)
(略同)故從春分起算立日差表
日差所以然者其故有二一太陽平視兩行差一兩道正
球升度差然求四正日差其故僅一蓋四正時兩道正
球升度無差故免日差之一根
夏至求日差則兩行差為一度五十分(夏至在最高前約六度則從春分至)
(夏至為八十四度除分秒不算求均數得十三分以二度三分全均數或春分均數内減之餘一度五十分)
乃黃道上從春分至夏至兩行之差因時刻用赤道度
則求春分左右黃道一度五十分得赤道同升一度三
十八分(均數大差在春分故用春分左右升度)變時(赤道一度為時之四分度之一分為時之)
(四秒)得六分三十六秒約半分如表平行小視行大故表
用加號加於平時得視時
秋分則從春分起算兩行差為四度六分變時得十六分
二十四秒(不及三十秒故不算)如表平行小視行大故亦用加號
冬至未到最高衝(兩行無差之限)相距亦約六度均數為十三分
宜與二度三分全差加之得二度十六分查赤道升度
得二度五分變時得八分二十秒(不滿三十秒故不算若欲微數秒亦)
(可用)號曰加
立夏均數(從最高起算)為三十六分赤道上為三十三分減去
春分兩道升度差十三分餘二十分(兩行之日差第一根也)
又黃道四十五度(立夏點)得赤道同升為四十二度二十
九分其較為二度三十一秒(赤道升度小則用日為大平日為小宜加又平行大)
(則用日小亦宜加)以兩故之兩數并之得二度五十分變時為
十一分十六秒其號為加
立春均數其兩行差為三十五分(從最低起算)赤道上為三十
三分(平春分兩道差為十三分今不算蓋春秋分兩數相均)又立春赤道上
得四十七度二十九分(從冬至起算)其盈黃道數為二度二
十九分而與升度日差兩數相減(平行大視行小其差宜加於平日赤道數)
(大黃道小宜減則兩數為異類也因均法相減當從實數之號)得一度五十六分變
時為七分四十四秒約算八分其號為減
各節氣算表如上若用古世兩行大差或黃赤兩道各大
距度(從古各法距度不同)或最高距夏至多寡直再算作立成
首直行為十二宫次行為節氣首横行為宫度
用法
置所算太陽經宫度及節氣(所算經度皆平日度)視所置首直行宫
節與首横行度數横直相遇得差數查本號與平時加
減之得用日時
如癸酉年冬至算得十二時三十一分半查本表冬至得
八分號為加加之得三十九分為用時
若以某用日時刻求太陽經度先約得日躔宫度入表得
數反用其號加減之得平時可算太陽之平經度(其假如見)
(日躔歷指)
清蒙地半徑表用法
清蒙氣說見日躔歷指第三其用表法先測得日軌高
若干度查表得本度下之清蒙分秒以減日軌高得日
躔地平上之實高
如日軌高十六度查表十六度下得清蒙七分以減十
六度餘十五度五十三分為日躔地平上之實高
地半徑說見日躔歷指第八其用表法先測得日軌高
若干度次視本日最高三距如夏至左右三宫屬最高
春秋分各左右三宫屬中距冬至左右三宫屬最高衝
于日高度下查本距日之地半徑分秒以加日軌高得
日躔地平上之視高
如夏至測得日軌高十六度屬最高查表十六度下得
地半徑差二分四十七秒以加日軌高得十六度二分四
十七秒内減清蒙差七分餘十五度五十五分四十七
秒為日躔地平上之視高
其法以此差率減所測視高度分得實高度分
新法算書卷二十六
