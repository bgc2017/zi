新法算書卷二十八明徐光啟等撰
月離歷指卷一
步七政次月離者何也曰其故有六月與日視體
相若雖偕恒星五緯同借日光而獨能繼照古今
以之配日稱為二曜則尊於諸星一也太陽以定
春夏秋冬而成歲太陰以定晦朔弦望而成月歲
與月錯綜損益歷法興焉以知天時以授民事二
也日食于定朔月食于定望恒用日躔月離諸行
以求食分加時日食之繁倍于月食其三視差皆
從月生三也太陽五緯恒星漸次高遠差數漸微
大小高下難可遽得惟月去人最近差數為大易
見易測故測候諸曜皆用月差較量繇顯入微悉
能推見四也日與星不並見欲測太陽躔度距某
星幾何無法可得古法於晝時測日月之距至夜
測月星之距并之得日星之距五也大圜之中百
昌庶物生長之緣有二日以暄之月以潤之諸風
雲雨露霜雪等皆係于月其在物也各有盈虚消
息亦係月之虧復進退其與太陽經緯諸星或會
或衝或三合四合六合各有順逆承制之理測候
推算之法醫家藉此以工治療農家藉此以爰稼
穡商賈藉此以行舟泛海六也(上五則有關歷學者書中略已論述)
(後一則各有本學兹不備著)有此諸端故推步之法宜求密合
而欲求密合政復未易如日躔之行止有三種月
離則有七種參錯之中欲求齊一非明理無以立
法非立法無以致用其曲折繁細十倍日躔矣乃
勝國至今此學湮廢星官家徒𫝊舊法若求其立
法之原與乖違之故即無片言隻字可資考證好
學者偶一測驗偶一致思便欲輕言改作不復究
本來之條貫求目前之徵實計後世之變遷譬如
勺水于河曷嘗遡源于星海窮委于歸墟者哉今
據西法譯該歷指四卷闡理著數似覺井然歷表
四卷條畫分明以步月離經緯度比于舊法可省
工力三分之二以步交食可省四分之三其為密
近似復勝之且令數百年後據兹義指得以改憲
求合焉謹論列如左
月離各種行度第一
月離行度與日躔異日躔恒依黃道其行度三而已隨宗
動天西行一也自行二也最高行三也若月離則有七
種行度如左
一曰隨行隨行者自東而西依宗動天一日一周七政恒
星共繇之其起算之界為子正初點或午正初點與太
陽同
二曰平行(一名本行)平行者月之本天自西而東日平行一十
三度有竒二十七日有竒而行天一周其界有二一以
太陽為界從合朔起算每日去離太陽若干度分以命
太隂之本行度分累積之一以宫次節氣為界(宫次如降婁大)
(梁等節氣如春分秋分等)從各初點起算每日去離若干以命太隂
之本行度分累積之此行謂之交周滿一周為交終其
初交曰正交其次交曰中交其行各及半曰正半交曰
中半交其兩界命兩種行度分異名同理詳下方
三曰自行(一名本輪舊名小輪也因小輪非一故改名之)自行者太隂之行不平
不順有時疾有時遲既爾紛紜無憑布度古歷因想近
月四周有一本輪太隂既隨本天循交道(即白道)東行(右旋)
又依此輪自東而西(左旋)一日行十三度有竒二十七日
有竒而行輪一周此亦平行也而與交道平行參錯不
一所以下土視之時疾時遲矣因其疾遲以别于交道
之行故彼名平行此名自行也既曰周行本輪則疾時
與交行相合遲時與交行相背亦宜如五緯之法有逆
行度分此獨言遲不言逆者月行甚疾但見其遲不見
其逆也此周謂之轉周滿一周為轉終分四象限首限
曰正轉二限曰正半轉亦曰本輪之最高三限曰中轉
四限曰中半轉亦曰本輪之最庳曰最高衝(或省日高衝)行
最高極遲行最庳極疾也(最高最庳之一周又名不同心圈其與本輪異名同理詳)
(見下方)
四曰次輪次輪者太隂之最高既依白道行則月離最高
時其距地心之遠近宜等迨測之則時時不等古歷又
想本輪之周復有一次輪循本輪左旋月在次輪之上
循周右旋也此法古歷所未有以意命之其行次輪一
周名為次轉終也四分之則為小四象第一名正初象
第二名正半象第三名中初象第四名中半象也
五曰交行交行者從測候見太隂行白道(古法月有九行殊謬元授時歷)
(廢不用獨言白道交周是也一名月道)出入黃道約五度有竒不行黃道
中線(何名黃道中線七政恒星皆循黃道行而六曜皆有出入如太白最遠出入約六度故黃道左右廣)
(十二度名為黃道帶而太陽獨行其最中故名中線也黃道一名躔道)而兩交於中線兩
交之點一名正交(亦曰羅㬋)一名中交(亦曰計都)兩交之行自東
而西與他行異亦名羅計行度也
六曰又次輪古來無有也萬歷間西史第谷測候極密得
太隂行兩小輪(其一本輪其一次輪)其各兩半時(兩小輪各有正半中半)之
兩均數與實測之度分往往未合故知次輪而外當有
又次一輪此之為數微眇難分其於歷法未關損益故
無暇及也
七曰面輪面輪者太隂既依本輪又依次輪各周行即月
面宜恒向次輪心下土所見時時旋轉須當不一若之
何終古恒如是故當復有本行使面恒下向也此亦未
關疎密不復備著
測月平行度第二
測月之法於七政為最難其故有六
其一月天最小距地甚近即地球與其本天有小大之比
例乃測器之心不居地心而居地面則所得月軌高乃
地面之視高非地心之實高也(此在日躔歷指謂之地半徑差)
其二有地球與月天之比例乃可推地半徑差既得地半
徑差乃以加所測之高定其實高不先得此無緣得彼
其三凡得各曜之高必減清蒙之高以定實高各曜之蒙
差高下不等測月者未知距地若干即無差數可減所
測高則非實高
其四月體恒虧缺不全若用太陽法令其光過窺表即虚
淡難見光體不圓亦無從得其中心之光若目察窺表
見月體不全無從測其心
其五若測以地平經緯儀或黃赤道經緯儀縱得其經緯
度分又以三視差故測得之數無一合者(三視差見交食歷指)
其六依測日星法以恒星測驗推算而得其經緯度似可
用亦因三視差故無一合者
然則何如按西歷古今法則月離度分必於月食時簡知
之晉史姜岌亦以月食衝簡知太陽所在不知考太陽
之躔度易考太隂之離度難而姜倒用之兩率皆疎矣
今法於月食時推太陽之經度其對衝即太隂之經度
(考大陽經度法見日躔表一卷)若日食則不可用何故日食時因于視
差是生中食實食視食(中食者兩平行所得平朔也實食者加減平朔而得地月日三)
(心參直定朔也視食者加減定朔而得其加時先後此地此時人目所見也)隨地隨時都無
定率故
右法任用一月食皆足簡知行度若求月平行率則用前
後兩會食取中積平分之其法與日平行相似而難易
迥别何者月或全食或不全食或食于南或食于北或
于遲限食或于疾限食各各不等顧須求其相等一不
等即所得非真率也然兩食猶為未足宜精擇所宜用
之四會食參互稽求以定月歷今詳論其法如左
夫月不平行古今治歷者之公言也欲求平行之率必用
擇食之法欲明擇食之理先解不平行之理其徵有二
其一初日測太隂過子午圈註定時刻(定時法測星第一水漏自鳴鐘等器)
(次之)次日測過子午定時刻如之第三第四日復測皆如
之次取各日所註時刻較之必一一不等知其非平行
若平行者宜一一等也如一周三百六十平度初日行
一百刻次日亦行一周而得一百刻有竒或九十九刻
有竒多寡不等其歷時多者必行遲也歷時寡者必行
疾也
其二取月食三事各以其中積時相減必有多寡知其非
平行如西測食略所記天啓三年癸亥九月望月食
食甚在戌初初刻五分(日九十六刻刻十五分下倣此)日躔夀星宫
一十四度四十一分月離降婁宫度分同又記天啓
四年甲子二月望月食食甚在丑初三刻三分日躔
降婁宫一十四度二十九分月離夀星同又記本年
八月望月食食甚在寅初二刻四分三十九秒日躔
夀星宫三度五十五分五十三秒月離降婁同推得
先兩食中積時為一百七十八日二十六刻十三分太
陽行一百八十度一十二分一十一秒太隂行滿六交
會置中積(一百七十八日二十七刻一分)六為法而一得二十九日
六十八刻七分四十三秒五十微為一會望策後
兩食中積時為一百七十六日七刻一十二分三十
九秒太陽行一百六十九度二十七分四秒太隂行
滿六交會置中積六而一得二十九日三十一刻二
分一十三秒三十微為一會望策右前後兩會望
策不等差三十七刻餘前六會積分多必行遲後六會
積分少必行疾又前兩食間太陽行經度與後兩食間
不等其較一十度四十六分七秒而積分之較僅二
百二十刻八十七分八十秒經度積時多寡不等
足徵非平行也
右二則皆不平行之徵也所以然者其緣又有三三緣者
其二在月其一不在月不在月者日躔經度是也前論
以月食簡知月離經度謂食甚時二曜經度正相對也
然日躔自有贏縮自非恒平何能定月離之平何者日
躔有最高最庳其去地也時近時遠是生地景(一名闇虚)時
大時小時長時短若日躔最高其景則長則大月之過
景加時則多日躔最庳其景則短則小月之過景加時
則少此第一差之緣也二在月者一為月轉遲疾也月
行遲限則過景時多月行疾限則過景時少此第二差
之緣也一為月轉最高最庳也在最高月體小又入于
小景則過時少在最庳月體大又入于大景則過時多
此第三差之緣也
是故歷家設擇食之法擇者導擇也去其不齊之綠以求
其齊也不齊之緣第一在日躔經度或在贏或在縮則
擇食之第一法宜擇兩食之日躔經度所在等既免此
緣則餘二緣在月之本行本輪日無與也
如圖甲為地球乙日體在最庳從乙發光地景則短丙
日體在最高從丙發光地景則長月循戊丁本輪行如
在丁近地過丁小景又在戊遠地過戊小景而此二小
景等則何從知月在其最高戊乎或者其最庳丁乎惟
先知日躔所在在其最庳景宜短或不至戊或至戊宜
更小所見小景者丁也而月離在其最庳也日在其最
高景宜長過月之最庳宜作己庚大景而所見小景者
戊也則月離在其最高也故兩食之太陽高庳等則景
大小等可免第一差之緣也夫景之末地之心太陽之
心三者恒相對也地景之行度分即太陽之行度分太
陽之高庳兩食不等即行度之遲疾不等而景之行度
遲疾亦不等若高庳等則兩行之遲疾皆等
是故前後兩會望皆全食又兩食之黃道同度(差自分秒以上)
(至一二度無害)即兩景之大小等兩過景之加時等又得其月
離之距地心等即其本輪之轉分所至亦等(轉分之所至等者距)
(地之遠近等也然月在本輪之最高庳則其遠其近一而已若在正轉中轉則距地之遠近雖等而在左在右)
(未定也法見下文理本論或用不同心圈其則一)
其擇食之第二法即兩食之月距地心等也若同在本輪
之最高或最庳不論左右若欲定其左右則以恒星經
度測之若兩食之經度等加時等即其或在左或在右
亦等既得月轉分之所在等即可測食前月體之徑
若徑等即其距地必等(測月體有本法本論見後篇)可免第二三差
之緣也
如上言欲求月平行率必用各率均齊之前後兩食欲得
此前後食必考於古之𫝊記今考二十一史各天文志
大都有年月日而無時刻分秒經緯度數將于何取之
不得已借西歷會通用之又考古至百千年以上若用
朝代年號紛綸不齊若用甲子細碎無紀故近古有虚
立積年略如章蔀紀元法以十九年為一章二十八章
為一袠十五袠為一總一總者四百二十章七千九
百八十年也每年為三百六十五日四分日之一每
四年加一日為三百六十六日(說見歷指一卷)今用此推算通
以歷代紀年則為法超簡仍不妨符合矣崇禎元年為
總期六千三百四十一年
總期之四千二百八十六年為周考王十四年癸丑西史
默冬推定十九年而太隂滿自行本輪之周復與太陽
同度(每年三百六十五日四分日之一為月二百三十五)是為章歲漢史所謂月
行之終復會于端也西歷謂之金數用以求月之日(求月)
(之日者於太陽月之某日求太隂之日數法以十九數及通閏數測之别有本論)崇禎元年為
章歲之第十四通閏得二十四日也(西數)雖然尚未能確
見分齊如漢人以章月平分推太隂各日平行為十三
度十九分度之七後世譏其疎漏因而代代改率然不
於千數百年間詳考天行得其決定均齊之數未免揣
摩影響西史依巴谷用實法考驗定為三百四十五平
年又八十二日四刻(平年者古法三百六十五日無餘分)或一十二萬六
千七日四刻實兩交食各率齊同之距也于時交
會轉終皆復其始(交會者太隂距太陽之行或太隂距節氣之行滿一周為定望也轉終者)
(太隂之本輪自行度亦滿周而復其故處也)計其中積凡為交會者四千二
百六十七為轉終者四千五百七十三
以中積分(一十二萬六千七日四刻)為實交會數(四千二百六十七)為法而
一得會望策二十九日三十一分五十秒八微二
十纖(古西法以六十分為一日)或二十九日五十刻一十四分
三秒(今西法)通率為二十九日六時(日十二時)三刻(每時八刻)
五分九十秒二十七微
求日平行分以天周(三百六十度)為實會望策為法而一得一
十二度一十一分二十六秒四十一微二十纖一十
八芒為太隂一日平行距太陽之度也(日有平日有用日見日躔歷指)
倍之得二日三倍之得三日可列表(如别卷以距太陽平行分合太陽)
(日平行分當加以合羅計日行分當減)
求通閏以平年日為實日行平分為法而一得四千四百
四十九度三十七分二十一秒二十八微二十九纖除
滿十二交會(一年十二月)外餘一百二十九度三十七分有
竒為一平年(三百六十五日)之通閏約得為十日有竒也
中通閏是歲實與十二朔之較西通閏是平年與十二
朔之較(年無小餘)以平年通閏加小餘得中通閏
求刻平行分以日平行為實九十六刻為法而一得一刻
平行分秒(見本表)
求交分(即太隂黃道上之日行度滿一周)置太隂日平行分加太陽日平
行五十九分八秒一十七微一十三纖一十三芒三
十一末(古測之數)得一十三度一十分三十四秒五十八
微三十三纖三十芒三十一末用乘法得十日百日
乃至一年得四千八百九度二十三分三秒一十
九微用除法得一刻一分秒之平行率以滿天周得二
十七日三十刻一十二分五秒是為交中分
求轉分(即太隂本圈之最高行滿一周)置前中積(一十二萬六千七日四刻)為實以
轉數(四千五百七十三)為法而一得二十七日五十二刻一十
一分五十秒為轉終分又以天周(三百六十度)為實轉終
分為法而一得一日之轉分一十三度三分五十三
秒五十六微一十七纖五十一芒五十九末用乘法得
十日百日乃至一年得四千七百六十八度或約十三
轉外餘八十八度四十三分七秒四十五微用除法
得一刻一分秒之轉率可立表
測月平行次論第三
法用太隂四會食其擇法欲前兩會之中積平行度中積
日其比例與後兩會之比例等又第一與第二月行本
輪同勢(勢者遲疾最高庳等同者俱在小輪一象限内)第三與第四亦然又第
一與第二之中積實行度等第三與第四亦然若是則
前兩會後兩會兩中積間月在本輪必各滿自行之周
(如是均齊乃得實平行度分)
解曰如圖已為地心丙丁乙戊為小輪乙為最高丙為
最高衝(即最庳)己丁己戊為兩切線(凡月在戊在丁其變行之勢亦借名為留)
(段蓋月行甚速留時絶少僅一瞬耳)
(然遲疾之間度分難測故借名為留)
(段也)
從乙丙分小輪為四象限各象有變形之勢(如在最高乙為極遲)
(最庳丙為極疾丁戊為留詳見下方)假令簡得第一會時月在辛第二會
在同象限(同在乙丁象限内如同類之行)如庚第三會在他象限如壬
第四在同象限(同在乙戊象限内為同類之行)如癸即不可用何者上
法言所求同行同類同時者必庚所至亦在辛癸所至
亦在壬若如圖庚與辛癸與壬各去離若干雖以同時
故同行辛庚弧(前兩會之差)與壬癸弧(後兩會之差)必等然一弧
之均數用加一弧之均數用減其時(平行)與行(視行)不得相
等(兩弧等者其自行雖等而視行不等)故法言庚會必仍在辛癸會必仍
在壬而後為月滿自行之全周
系凡簡會食不當在戊與丁兩切線之上蓋目在己巳
丁巳戊兩視線切圈其所切之處難辨其高下之準分
也(視法曰凡斜望圓圈圈作一直線又曰視線切圓圈之兩旁人目謬見曲線為直線其謬直線中間有上)
(行下行者雖動而目視之若不動)
此古法依巴谷等所共用其書不全所用四會食之行
度時日等各率皆無𫝊故略舉其正法如右方
測正中交行度第四
正中交者黃白二道之兩交也正交亦曰羅㬋亦曰天首
亦曰隂歷初陽歷末西歷謂之龍頭中交亦曰計都亦
曰天尾亦曰陽歷初隂歷末西歷謂之龍尾月行及于
黃道曰交月本圈之自行度曰轉而轉終分多於交終
分故轉滿一周交終未及恒居其後交不及轉之度即
兩交退行之度故謂兩交為逆行也(自東而西)測法亦用交
食而考古無𫝊不能得其真率西史依巴谷如前法用
兩月食擇其前後各率均齊如太隂或同在隂歷同在
陽歷太陽之自行同度去兩交之兩點或前或後同限
食分等加時等即太隂之轉分所至等因以定兩交行
天若干周而復于故處其原測之中積為交會五千四
百五十八兩交行天周為五千九百二十三
置中積會數(五千四百五十八)以會望策(二十九日五十刻一十四分三秒)乘
之得一十六萬一千一百七十七日五十八分(西古六十分為)
(一日)五十八秒三微二十五纖為中積日次以中積會
數乘天周(三百六十度)得二百一十三萬二千二百八十
度為實以中積日為法而一得一十三度一十三分四
十五秒三十九微四十八纖五十六芒三十七末是太
隂距交一日行度
次于兩交日行度去減太隂黃道上行度(即平行分日十三度一十分三)
(十四秒五十九微)得兩交逆行日三分一十一秒每年行一十
九度一十九秒四十三微用乘法得積年度用除法
得時刻度列表(如别卷)
以上諸率皆依巴谷古測所定後多禄某歌白尼及第谷
各加密測仍用試法數端推得合會之數每年不足為
一十四分一十八秒一十微一十九纖應加轉終分
每年盈為五十四微一十二纖應減交行每年盈為一
秒二微四十二纖應減
今新歷表所用率
朔實二十九日五十刻一十四分三秒九微通
得二十九日五十三刻六分九十二秒
轉終二十七日五十三刻五分二十五秒一十四微
通得二十七日五十五刻五十八分四十七秒四十九
微
交終二十七日二十刻五分三十三秒四十八微
通得二十七日二十一刻二十一分九十六秒七十四
微
依上三數本法可得大統所用别率及其異同之數
通論七政本輪異名同理第五
日躔歷指論太陽贏縮疾遲之理設太陽所行之道與地
為不同心圈今論月行亦用不同心圈亦用小輪此二
者異名同理蓋藉以分布度數指記運行隨人所立期
于不爽而止若大象森羅其孰然孰不然或皆不然則
非智計所能測也今略解如左
不同心者一圈之内别函一
圈兩各異心也若圈周之上
任用一點為心别作小圈則
為小輪如圖甲乙圈内别有丙丁圈戊巳不同心又庚
辛壬圈周以辛為心作癸子圈是謂小輪
解曰日躔歷既言不同心(贏縮今古共知言不同心近而易明)月離歷又
言小輪(回回歷已著小輪之目因仍用之)且諸歷中或
復錯出故宜詮釋同異以絶疑端此法
七政所同今借太陽為解他可類推也
按日行夏遲冬疾春分過夏至迄秋分歷時日多秋分
過冬至迄春分歷時日少何故若以不同心圈解之作
甲乙丙丁外圈戊為心分黃道十二宫為天元宫次又
以已為心作庚壬辛癸圈次從降婁夀星各初度相對
作直線必過地心戊而任分庚辛壬癸圈為二必上為
大半下為小半己心在戊心之上故也日平行一歲盡
庚壬辛癸圈即夏半周(夏至左右春分迄秋分)庚壬辛為大分冬
半周(冬至左右秋分迄春分)辛癸庚為小分大分歷時多小分歷
時少日自恒平行人從地心戊視之則為贏縮遲疾矣
若用小輪則如左圖戊為地心甲乙丙丁大圈名負小
輪圈(或日帶小輪)其周上乙點為心作小輪如丁為心己庚
為周也小輪從丁向甲乙丙行一年而復日體亦行小
輪周一年而復(復者復于故處)置日體
在最庳巳小輪心丁循大圈行
四十五度至壬日從己行小輪
四十五度至庚次丁心行大圈
九十度至甲日行小周亦九十
度至寅丁心至癸日至子心至乙日至丑心至午日至
夘心至丙日至辰心至申日至未心回丁日回己日在
小輪周上行成己庚寅子丑夘辰未圈即是不同心之
圈其心為酉而酉戊兩心相距之度即小圈之半徑
又如上一圖用不同心圈午為日從地
心戊本圈心酉各作線至午成戊酉午
三角形如二圖用小輪子為日子癸為
小輪半徑從地心戊作戊子線成戊子
癸三角形其戊酉午形與戊癸子等戊
酉與子癸等子丑弧與午乙等(圈大小不等而)
(度分等)即子癸丑角與乙酉午角等其餘
角午酉戊與子癸戊亦等戊午戊子兩邊等(日距地心之度等故)
則戊酉午與子癸戊兩形等形等則所求之日距地心
若干太陽平行自行之差日體大小之類或用不同心
圈或用小輪其得數同也
測定本輪之大小遠近及其加減差第六
(借西古史多禄某及近世歌白泥之論)
法用三會食測算(此多禄某所用)
第一食總期之四千八百四十六年為漢順帝陽嘉二年
癸酉五月(西歷之月今三月)初六日子正後(順天府時刻)一十八刻
十分月全食日躔大梁宫一十三分一十四分其平
行一十二度二十一分
第二食四千八百四十七年為陽嘉三年甲戌十月(建戌之月)
二十四日子正後(順天府)一十七刻十分月食十二分
之十在黃道南日躔夀星宫二十五度十分其平行
二十六度四十三分
第三食四千八百四十九年為永和元年丙子三月(建寅之月)
(或建夘)初六日子正後三十七刻五分(順天府為在晝不見)月食
十二分之六在黃道南日躔娵訾宫一十四度一十二
分其平行為一十一度一十四分
前二會中積
太陽太隂兩視行皆為一百六十一度五十五分(各減全周)是
為黃道上兩會相距之度
積日為五百三十一日九十三刻若平日為九十三刻
七分
于時月平行距日為一百六十九度三十七分
月自行為一百一十度二十一分(本輪行度)
視平兩行之較得七度四十二分以為加減率(平行大視行小用減)
(法為月自行過小輪或不同心圈之最高在最高逆行故)
後二會中積
太陽太隂兩視行皆為一百三十八度五十五分是為黃
道上兩會相距之度
積日為五百二日二十刻若平日為二十二刻
于時月平行距日為一百三十七度三十三分
月自行為八十一度三十六分
視平兩行之較得一度二十一分以為加減率(平行小視行大用加)
(法為月未至最高)
大圖說外大圈白道也小圈為太隂之本輪第一會月
之視行在子平行(小輪心在丁庚丑線)在丑(視行大必在前)第二會月之
視行在午平行在丑(平行大必在前)第三會月視行在未(小輪上會)
(一會月在甲第二會在乙第三在丙甲乙丙三點以後所用)
小圖說(即前大圖中之小輪分圖)此借古史成法用二小輪(一為本輪一為次輪)
以齊月行似為足矣别有諸家異同之說更僕難罄未
能悉舉
如圖以地心
丁為心作午
未丑子黃道
弧(大圖言白道者度分相若互言之)庚為小輪心依黃道自西而東(右旋)
二十七日有竒而一周天此為交周日行十三度一十
分有竒太隂日平行度也月體在小輪(即本輪)之上從甲
向乙(左旋)二十七日有竒而一周本輪此轉周也日行十
三度三分有竒太隂日轉自行度也(小輪亦分三百六十度與周天等說)
(見本篇第五時所謂月體在小輪之上者乃朔望之也其外非在此見下文)
依上法列平行立成表取小輪心行度推某日太隂在某
宫某度分即丁庚丑線所指黃道度分也又用測法或
會食時推算求太隂所躔宫度得丁乙午丁戊甲子等
線定丑丁午丑丁子等角即兩行之差也以為加減之
率如大圖三會食第一食月在甲去甲一百一十度(兩會)
(自行相距之度)而至乙乙者第二會食之月離度也(甲乙之間平行多視)
(行少則乙在小輪之右又乙行遲段故月在小輪之上弧)推得兩會中積視行平行
之差為七度
四十二分即
黃道上子午
也又去乙八十一度二十一分而至丙(乙丙之間視行與平行差少故)
(丙亦在小輪之右又丙行疾段則在小輪之下)推得兩會兩行之差為一度二
十一分即黃道上午未也次得丙甲弧一百六十八度
三分(丙甲之間自行大平行小丙行疾段在小輪下)月行丙甲弧兩行之差
為六度二十一分(以前午子午未二差相減得未子較為此兩行之較)
又如上圖乙丙丙甲兩弧并即平行少視行多必在最
庳之兩旁(行疾段故)甲乙反之即平行多視行少必在最高
之兩旁(行遲段故)次定己為最高從甲從乙從丙作甲丁乙
丁丙丁各線甲丁割小輪圈于戊次作乙丙丙戊戊乙
三線成乙戊丙形乙戊丁等形
乙戊丁形有乙戊丁角(甲戊乙角之餘甲戊乙者甲乙弧之在界乘圈角也半甲乙弧)
(得五十五度一十分半為甲戊乙角後凡言乘圈角即所乘弧折半推算全圈分一百八十度)一百二
十四度四十九分半又有戊丁乙角(其對弧為黃道弧之子午七度四十)
(二分)即戊乙丁角(以滿一百八十度)必四十七度二十八分半依
三角形用法
以角求邊之
比例(三角形外作切)
(圈即乙角對戊丁弧其弦為戊丁線丁角對乙戊弧其弦為乙戊線戊角對乙丁弧)
(其弦為乙丁線)十萬為全數(全周之半徑)查表(八線表中有法)
得乙戊為二六七九八戊丁為一四七三
九六(半弧度查表求正弦倍正弦得通弦)
戊丙丁形有戊角(甲戊丙角之餘也甲乙乙丙二弧并為一百九十一度五十七分因乘圈)
(半之為甲戊丙角度其餘為丙戊丁角度)八十四度一分半有戊丁丙角(戊丁)
(丙角之弧為兩行之差未子)六度二十一分自得戊丙
丁角依三角求邊之比例得戊丁一九九
九九六戊丙二二一二
先得乙戊戊丁之比例次得戊丁戊丙之比例用變率法
通之(變率者變兩戊丁為同數他率從之也用三率法次戊丁為第一率次戊丙為二率先戊丁為三率)
(求四率得先戊丙即兩比例之數俱同類)得兩戊丁俱一四七三九六戊丙
一六三二戊乙二六七九八
又乙戊丙形有乙戊戊丙兩邊有乙戊丙
角(乙丙弧之半)求乙丙得一七九六乙丙線
者乙丙弧之
弦也乙丙弧
為八十一度
三十六分若設小輪全徑為二十萬分即乙丙弦為一
二六八四用變率法(見前)乙丙之先數得丙戊丙丁為
某數(云某數者先乙丙為一率先戊丙為二率相偕為比例也)乙丙之次數得某數
算得戊丙一一八六三七戊丁一七二六八四既得
戊丙弦求其弧得七十二度四十六分一十秒為戊壬
丙有戊壬丙弧并入丙乙乙甲以減全周餘九十五度
一十六分五十秒為甲戊弧其弦一四七七八六為
甲戊線甲戊弧於全周為小分則圈之心必在甲戊外
置庚心作己庚壬丁線定己為最高壬為最庳
次依幾何原本(三卷三十六題)甲丁戊丁兩線内矩形與己丁壬
丁兩線内矩形等又己丁壬丁矩形及庚壬上方形并
與庚丁上方形等則甲丁丁戊相乘加全數庚壬上方
積以開方得庚丁為一一四八五五六次設庚丁全數
為十萬用變率法得庚己八七六是為月天半徑與
小輪半徑之比例
次從庚心作甲戊之垂線平分甲戊線于辛截甲戊弧于
癸成庚辛丁直角形此形有辛丁(先得丁戊戊甲今庚辛線平分甲戊以辛)
(戊加戊丁得)一一四六五七七又有庚丁一
四八五五六求辛庚丁角得八十六度
三十八分半是在心之庚角所乘癸戊壬弧也以減半
周餘九十三度二十一分半為癸己弧先得甲戊弧為
九十五度一十六分五十秒甲癸半之為四十七度
三十八分三十秒以減癸己餘四十五度四十三分
為甲己是第一會食太隂未至最高之度也以減甲乙
餘六十四度三十八分為己乙是第二會食太隂過最
高之度以己乙并乙丙得一百四十六度一十四分是
第三會食太隂距最高之度
依上算得辛丁庚角三度二十六分黃道子丑弧也為第
一食兩行之差(小輪心指黃道上之丑點本行從丑向子則月在子居前平行在丑居後)應
于平行加丑子度分為視行又甲丁乙角七度四十二
分減去甲丁
丑角餘己丁
乙角四度二
十一分于黃道弧為午丑是第二食兩行之差(乙在最高之後)
(月視行未至丑)應于平行減午丑度分為視行又丙丁乙角先
為一度二十一分以減午丁丑角餘丙丁丑角二度四
十九分于黃道弧為未丑是第三食兩行之差(丙未至最高衝)
應于平行減未丑度分為視行
末第一食月視行離大火宫一十三度一十五分于黃道
弧為子(太陽躔其衝大梁宫度分同)今得兩行之差丑子三度二十
二分減視行率得平行小輪心度丑為在大火宫九度
五十三分第二食視行離降婁宫二十五度六分于
黃道為午兩行差四度二十一分以加視行率得丑為
在降婁宫二十九度三十分第三食視行離鶉尾宫一
十四度一十二分于黃道為未兩行差三度二十二分
以加視行率得丑為在鶉尾宫一十七度四分
一系因上論可得小輪半徑(庚壬)與月天半徑(庚丁)之比例
二系可得兩行之極大差法從地心丁作丁夘線切小
輪于夘因幾
何(三卷三十六題)丁
夘切線上方
形與己丁壬丁兩線矩内形等今先有己丁壬丁兩數
以相乘開方得夘丁既夘丁庚形有三邊以求夘丁庚
角是為兩行之極大差(此差古今測法同得數小異别有圖表見後卷)五度一
分上法用不同心圈得數無異
測本輪大小遠近及加減差後法第七
法同上用三會食(此近世歌白尼法今時通用)
第一食總期之六千二百二十四年為正德六年辛未十
月(西歷之月今九月)初七日子正後二十八刻(順天府時刻下同)月全
食太陽躔夀星宫二十二度二十五分平行為二十四
度一十三分
第二食六千二百三十五年為嘉靖元年壬午九月初六
日子正後三十一刻月全食太陽躔鶉尾宫二十二度
一十二分平行為二十三度四十九分(今作八月)
第三食六千二百三十六年為嘉靖二年癸未八月二十
六日子正後四十二刻一十分月食太陽躔鶉尾一十
一度二十一分平行一十三度二分(今作八月)
前兩會食黃道上相距之中積視行度(減全周)為三百二十
九度四十七分中積日為三千九百八十七日平時三
刻一十分于時交周上中積平行度(減全周)為三百三十
四度四十七分本輪自行(減全周)為二百五十度三十
六分因自行度是生平行視行之差五度以為加減率
(中積之視行大平行小故月在小輪之右)
後兩會食黃道上相距之中積視行度為三百四十九度
九分中積日為三百五十四日平時十二刻九分
于時交周上中積平行度為三百四十六度一十分本
輪自行為三百一十六度四十三分因自行度是生兩
行之差二度五十九分以為加減率(中積之平行大視行小因差少月仍)
(在小輪之右)
第一食月在甲從甲數前二會之自行中積二百五十度
三十六分至乙即乙為小輪周上第二食月離所在而
乙甲餘弧必一百九度二十四分甲丁乙角之弧為
午子五度是人目所見黃道上兩行之差
又從乙(第二會月離所在)過戊申數三百一十六度四十三分至
丙即第三會月離所在而丙乙弧必五十三度三十七
分丙丁乙角之弧為午未二度五十九分是黃道上兩
行之差
又乙丁甲角去減丙丁乙角餘甲丁丙角為子未二度
一分為黃道上兩行之差
次并甲乙乙丙弧得一百六十二度四十一分以減全周
餘一百九十七度一十九分為丙己甲弧是周之大半
即周之心在其弦内次作丁庚丑線定己為最高從甲
從乙從丙作甲丁乙丁丙丁各線丙丁線割小輪圈於
戊次作乙甲甲戊戊乙三線成甲乙戊形
乙戊丁形有戊丁乙角(二度五十九分)又有乙戊丁角(丙戊乙角乘丙乙弧)
(二十六度三十八分半其餘以滿一百八十度為乙戊丁角一百五十三度二十一分半)即戊乙丁
角(第三為二)十三
度三十九分
三十秒以
求各腰(倍角之數求其弦即對邊之數)得乙戊邊為一四二戊丁為
八二四
次甲戊丁形有甲丁戊角(未子二度一分)有甲戊丁角(甲戊丙角乘甲己丙)
(弧一百九十七度一十九分半之得八十八度三十九分半甲戊丙角也其餘為甲戊丁角九十一度二十)
(分半)即有戊甲丁角有三角求其邊若戊丁為八二四
則甲戊為七二
次甲戊乙形有戊乙(一四二)戊甲(七二)兩邊有乙戊甲角(乘甲)
(己乙弧二百五十度三十六分半之為一百二十五度一十八分)求甲乙得一二二七
若小輪之半徑庚壬為全數即因甲己乙弧之度推得甲
乙弦又用變率法推乙戊戊甲戊丁各線與庚壬全數
為同比例之數算得甲乙為一六三二三戊丁為一
六七五一戊乙為一三八五三有戊乙弦即得戊乙弧
為八十七度四十一分以并乙丙弧得一百四十度
五十八分求其弦得一八八五為丙戊以并戊丁得
一二五六二
次依幾何原
本(三卷三十六題)丙
丁丁戊兩線
内矩形與己丁丁壬兩線内矩形等又己丁丁壬矩形
及庚壬方并與庚丁方等則以丙丁丁戊矩形一三四
八一三九一二庚壬方(庚壬全數為一萬)一萬萬并為積
開方得庚丁方之邊為一一六二二六次設庚丁全數
為十萬變庚壬為八六四是為月天半徑與小輪半
徑之比例與前古法所得小異
次從庚心作丙戊之垂線平分丙戊線于辛截丙戊弧于
癸成庚辛丁直角形此形有庚丁(一一六二二六)有辛丁(先得戊丁)
(一六七五一又有丙戊一八八五二半之為辛戊九四二六以并戊丁為一一六一七七)求庚丁
辛角得一度三十九分為未丑又求辛庚丁角得八十
八度二十一分為癸壬弧并丙癸(先得戊乙丙弧一百四十度五十八分其)
(半為丙癸七十度二十九分)得一百五十八度五十分其餘(以滿半周)
為丙己二十一度一十分是第三食月距小輪最高之
自行度第二食月在乙乙己弧七十四度二十七分為
其距最高之自行第一食月在甲甲乙己一百八十三
度五十一分
為其距最高
之自行
又己丁丙角為未丑一度三十九分月在平行之後則第
三食平行内應減未丑丙丁乙角為午未二度五十九
分月在平行之後則第二食平行内應減午未兩角并
得午丑四度三十八分為第一食應減之數而甲丁乙
角先得五度因月在小輪下弧則為應減之數一加一
減相準餘壬丁甲角為丑子弧度二十二分則第一
食平行内應加丑子
末第一食月視行經度離降婁宫二十二度二十五分減
丑子弧二十五分(視行内應減平行内應加)得平行為在降婁宮二
十二度三分第二食月視行離娵訾宫二十二度一
十二分加午丑弧四度三十八分得平行為在娵訾二
十六度五十分第三食日視行離娵訾宫一十一度
二十一分加己丁丙角一度三十九分得平行為在娵
訾宫一十三度皆食時之經度也
因上二論以推加減立成表如後卷
試舊推平行率各術疎密第八
依前法用太隂加減差表定前後兩會食之中積時可得
太隂之平行率又用上論求兩食之本輪自行度若此
兩率之距本輪最高或最庳等則所定平行率為確合
如前本篇第六所用第二會食為總積之四千八百四十
七年係漢順帝陽嘉二年(多禄某所用)其各率見本章又
第七所用第二會食為總積之六千二百三十五年係
正德六年(歌白尼所用)其各率見本章其中積率為平年(三百)
(六十五日)一千三百八十八年三百二日一十四刻四
分其間交會滿一萬七千一百六十六周其自行本輪
亦滿全周則為確合今依上古法推(依巴谷在周顯王時)減全周
外餘三百五十九度四十八分七秒(轉周不及交會一十一分五十)
(三秒)依中古法推(多禄某在陽嘉年)減周外餘三百五十九度三
十七分四十九秒(轉不及會二十二分一十一秒)依近世法推(歌白尼在正德)
(年)減周外餘四分則知近世之法視古為密蓋測驗推
步一二千年積功力積智巧所定諸法漸次加精故也
定太隂平行自行之歷元第九
歷元者於某地之某年月日時刻定某曜躔本天之某度
分為推步之根本上遡既往下迄將來靡不準此或加
或減以得隨時所躔各度分也
今擬定崇禎元年戊辰天正冬至後子正初刻為歷元其
地則
京師順天府定為歷元之本所歷元則上下推步略同古
法論地則自唐至元有測驗北極出地之法是為地之
緯度若其東西經度從古未有也今立法以本府為根
其南北北極出地三十九度五十五分有竒九服皆隨
地測驗東西則以本府為初度初分九服依此為準或
加或減推算各地本時本曜之各所求度分别有本法
本論(如後卷)
右北極出地度通為四十度四十九分有竒中西二
率悉與古法不合蓋前人未悟地半徑差蒙氣差於兩
至所測之高應加應減故也說見日躔歷指
用歷元前一月食之歲月日時及歷元之歲月日時取其
中積日求太隂之平行若干度分減朔策(一交會之全周)餘度
分為歷元之平行度分則朔應也又考月食時得自行
若干度分亦算中積時之自行若干度分兩數并得為
歷元之自行度分則轉應也
新法算書卷二十八
