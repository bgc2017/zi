歷算全書卷十一
宣城梅文鼎撰
環中黍尺卷五之六
加減捷法
用加減則乘除省矣今惟用初數則次數亦省又耑
求矢度省餘弦則角之銳鈍得矢自知邊之大小加
較即顯無諸擬議之煩故稱捷法
如法角旁兩弧度相加為總相減為存視總弧過象
限以總存兩餘弦相加不過象限則相減並折半為初
數
若總弧過兩象限與過象限法同(其餘弦仍相加)過三象限與
在象限内同(其餘弦仍相減)若存弧亦過象限則反其加減(總弧)
(過象限或過半周宜相加今反以相減若總弧過于三象限宜相減今反以相加)並以兩餘弦
同在一半徑相減不然則加也
總存兩餘弦同在一半徑當相減折半圖
乙丁丙三角形
丁為鈍角
丙卯為總弧其正弦卯
戊餘弦戊己庚丙為
存弧其正弦庚壬餘弦壬巳兩餘弦同在丙已半徑
宜相減(壬巳餘弦内減戊巳成戊壬)折半為初數丑壬(即甲庚亦即未酉)
總存兩餘弦分在兩半徑當相加折半圖
乙丁丙形丁為銳角
庚丙為總弧其正弧庚
壬餘弦壬巳卯丙為
存弧其正弦卯戊餘弦
戊已徑兩餘弦分在丙巳子巳兩半徑宜相加(以戊巳加壬巳)
(成壬戊)折半為初數丑戊(即甲酉亦即未卯)
三邊求角初數恒為法以兩矢較乘半徑為實法為初
數與兩矢較若半徑與角之矢也
一初數(即角旁兩正弦相乘半徑除之之數今以加減得之)
二兩矢較(或兩俱正矢或兩俱大矢或存弧用正矢對弧用大矢)
三半徑
四角之矢(正矢角銳大矢角鈍)
角求對邊則以初數乘角之矢為實半徑為法法為半
徑與角之矢若初數與兩矢較也
一半徑
二角之矢(或正矢或大矢)
三初數
四兩矢較(並以較加存弧矢為對弧矢加滿半徑以上為大矢其對弧大不滿半徑為正矢其對弧小)
乙丁丙形三邊求丁角
小邊乙丁(正弦卯辛)大邊丙丁(正弦壬丙)初數卯癸(兩正弦相乘半徑除之也)
今改用加減
兩餘弦相減(餘房戊)折半得
丑戊即初數卯癸(與先所得同)
一系總弧過半周而存弧亦過象限則餘弦相減
法為卯癸初數與兩矢較牛乙若卯辛正弦(距等半徑)與乙
庚(距等大矢)亦即若寅巳半徑與角之大矢酉子
一初數卯癸(即丑戊)
二兩矢較牛乙(即房甲)
三半徑寅巳
四角之大矢酉子
若先有丁鈍角而求乙丙對邊則反用其率
一半徑寅巳
二角之大矢酉子
三初數卯癸
四兩矢較牛乙
以所得兩矢較加存弧大矢房丙得大矢甲丙
乙丁丙形
三邊求丁角
小邊乙丁(正弦乙辛)大邊丙丁(正弦戊壬)
初數戊癸
今用加減
兩餘弦相減(餘辰甲)折半得辰
丑即初數戊癸
對弧(乙丙)大矢斗乙
存弧大矢甲乙(兩矢較斗甲)
法為初數戊癸與兩矢較斗甲若戊壬正弦(距等半徑)與丙
庚(距等大矢)亦即若寅巳半徑與角之大矢酉子
一初數戊癸(即丑甲)
二兩矢較斗甲
三半徑寅巳
四角之大矢酉子
論曰此移小邊于外周如法求之所得並同其故何也
先有之角及角旁二邊並同則諸數悉同矣然則句股
之形不同何也曰前圖是用乙丁小弧之正弦為徑分
大矢之比例則所用句股是丁丙大弧之正弦此圖是
用丁丙大弧正弦為徑分大矢比例則所用句股是乙
丁小弧正弦故句股形異也然句股形既異而所得初
數何以復同曰此三率之精意也初數原為兩正弦相
乘半徑除之之數前圖用大弧正弦偕半徑為句與弦
而小弧正弦用為大矢分徑之比例是以大弧正弦為
二率而小弧正弦為三率也今改用小弧弦為二率大
弧弦為三率而首率之半徑不變則四率所得之初數
亦不變也又何疑焉
一系角旁二弧可任以一弧之正弦為全徑上分大
小矢之比例其餘一弧之正弦即用為句股比例不拘
大小同異其所得初數並同
又論曰以句股比例言之則戊庚通弦為弦(即距等圈全徑)戊
女倍初數為句(即總存兩餘弦相加減之數)一也戊壬正弦為弦則
戊癸初數為句二也丙庚為弦(通弦之大分即距等大矢)則斗甲兩
矢較為句(即丙房)三也丙壬為弦(正弦之分綫即距等餘弦)則斗丑為
句(對弧餘弦内減次數丑巳得斗丑亦即丙牛)四也戊丙為弦(正弦之分綫即距等小矢)
則午戊為句五也
以全與分之比例言之則戊庚為距等全徑與寅子全
徑相當一也戊壬正弦為距等半徑當寅巳半徑二也
丙庚如距等大矢當酉子大矢三也丙壬如距等餘弦
當酉巳餘弦四也戊丙如距等小矢當寅酉正矢五也
一系初數恒與角旁一弧之正弦為句股比例其正
弦恒為弦初數恒為句而其全與分之比例俱等又即
與員半徑上全與分之比例俱等若倍初數即與全員
徑上大小矢之比例等
一系角旁兩弧任以一弧之正弦為徑上全與分之
比例初數皆能與之等
若先有丁鈍角求對邊乙丙則更其率
一半徑巳子
二丁角大矢酉子
三初數丑甲
四兩矢較斗甲
以四率斗甲加存弧大矢乙甲成斗乙為對弧大矢内
減巳乙半徑得斗巳為對弧餘弦撿表得未丙弧度以
減半周得對弧丙乙度
乙丁丙形三邊求丁角
乙丁邊(九十五度)丁丙邊(一百一十二度)乙丙對弧(一百一十九度)
總弧丙未二百七度餘弦辛巳八九一一
存弧丙戊一十七度餘弦壬巳九五六三
兩餘弦相加辛壬一八四七三一
初數卯亥(即半辛壬丑辛)九二三六五
對弧大矢癸丙一四八四八一
存弧正矢壬丙四三七
兩矢較癸壬一四四一一一
法曰卯亥(即丑辛)與癸壬若
未亥與乙戊亦必若庚巳
與甲子
一初數卯亥九二三六五
二兩矢較癸壬一四四一一一
三半徑庚巳一
四角之矢申子一五六二二
四率大于半徑為大矢其角鈍法當以半徑一
減之餘五六二二為鈍角餘弦撿表得餘
弦度五十五度五十六分以減半周為丁角度
依法求到丁鈍角一百二十四度四分
論曰試作辰戊綫與倍初數辛壬平行而等又引未辛
(總弧正弦)至辰成未辰戊句股形又引牛乙癸(對弧正弦)至寅作
亥丑綫引至斗各成句股形而相似則其比例等
一未辰戊大句股以辰戊倍初數為句未戊通弦為弦
一乙寅戊次句股以寅戊兩矢較為句乙戊(距等大矢)為弦
一(未卯亥亥斗戊)兩小句股並以(卯亥斗戊)初數為句(未亥亥戊)正弦為弦
辰戊倍初數與寅戊兩矢較若未戊通弦與乙戊距等
大矢是以大句股比小句股也
卯亥初數與癸壬兩矢較若未亥正弦與乙戊距等大
矢是以小句股比大句股也用亥斗戊形比乙寅戊
其理更著
又未戊通弦上全與分之比例原與全員徑上全與分
之比例等故三者之比例可通為一也
(一大句股截數種小句股故又為全與分之比例)
仍用全圖取乙丁女形求丁銳角
乙丁邊(九十五度)女丁邊(六十八度)女乙對弧(六十一度)
總弧女戊(一百六十三度)餘弦(壬巳)九五六三
存弧女未(二十七度)餘弦(辛巳)八九一一
兩餘弦并(辛壬)一八四七三一初數卯亥九二三五六
一初數卯亥九二三六五
二兩矢較癸辛四六二
三半徑巳庚一
四角之矢申庚四三九七七(以減半徑得丁角餘弦入表得丁角度)
依法求得丁銳角五十五度五十六分
辛丁乙形
三邊求丁角
辛丁邊五十度一十分乙丁邊六十
總弧卯辛一百一十度一十分
餘弦庚丙二四四七五
存弧戊辛九度五十分
餘弦子丙九八五三一
餘弦并子庚一三三六
初數子午(即戊癸)六六五三
辛乙對弧八十度
對弧矢辛酉八二六三五
存弧矢辛子一四六九
兩矢較子酉八一一六六
一初數子午六六五三
二兩矢較子酉八一一六六
三半徑壬丙一
四丁角大矢壬甲一二二五(用餘弦入表得丁外角減半周得丁角度)
依法求到丁鈍角一百二度四十四分
論曰此如以日高度求其地平上所加方位也乙為太
陽乙甲其高度其餘度丁乙日距天頂也亥乙赤道北
緯辛乙為距緯之餘即去極緯度也辛壬為極出地度
其餘辛丁極距天頂也所求丁鈍角百二度太距正
北壬之度外角七十七度少距正南巳之度也算得太
陽在正東方過正卯位一十二度太
乙丙辛形有(辛丙三十三度辛乙百卅二度)對弧乙丙(百度八)
求辛角
總弧(丙壬)一百六十五度
餘弦(己戊)九六五九三
存弧(丙庚)九十九度
餘弦(己甲)一五六四三兩餘弦相減餘(戊甲)八九五
初數甲丑四四七五對弧大矢酉丙一三九二
存弧大矢甲丙一一五六四三
兩矢較甲酉一五二五九
一初數甲丑四四七五
二兩矢較甲酉一五二五九
三半徑申巳一
四角之矢未申三五三五二
得辛銳角四十九度二十八分
恒星歲差算例
老人星黃道鶉首宫九度三十五分二十七秒為庚角(康熙)
(甲申年距歷元戊辰七十七算每年星行五十一秒)
(訃行一度五分二十七秒以加戊辰年經度鶉首)
(八度三十分得今數)
黃道南緯七十五度距
黃極一百六十五度為庚
辛邊用巳庚乙三角形
(一角二邊)求對弧巳乙(赤緯)
餘弦較丁甲二六六一
初數甲戊一三三
庚角正矢申酉一三九八
一半徑申丙一大矢内減半徑
二庚角矢申酉一三九八取餘弦檢表得
三初數甲戊一三三三十八度廿三
四兩矢較甲丑一四四分半以減半周
加存弧大矢巳甲一七八二三四得星距北極一百
得對弧大矢巳丑一七八三七八四十一度三十六
分半為對弧巳乙
求到甲申年老人星赤緯在赤道南五十一度三十六分半
(以校歷元戊辰年緯五十一度三十三分及儀象志康熙壬子年緯五十一度三十五分可以略見恒星)
(赤緯歲差之理)
求巳角(赤經)
巳庚角旁弧二十三度三
十一分半
巳乙角旁弧一百四十一
度三十六分半
庚乙對弧一百六十五度
三邊求角
餘弦較子斗四九五七七
初數午斗二四七八八
對弧大矢庚亥一九六五九三
存弧大矢庚斗一四七七六
兩矢較亥斗四九五一七
一初數午斗二四七八八大矢内減半徑得
二兩矢較亥斗四九五一七餘弦檢表得度以
三半徑丙氐一減半周得已角度
四角大矢亢氐一九九七六一一百七十六度二分
置三象限以已角度減之得星距春分九十三度五十八分
求到甲申年老人星赤道經度在鶉首宮三度五十八分
(以校戊辰年赤經九十三度三十九分及儀象志壬子年赤經九十三度五十一分可以見恒星赤經東移之理)
加减捷法補遺
捷法以兩餘弦相加減以兩矢較偹四率其用巳簡
然有闕餘弦無可加減闕矢度無可較者雖非恒用
而時或遇之亦布算者所當知也
一加減變例
凡餘弦必小於半徑常法也然或捴弧適足半周則
餘弦極大即用半徑為捴弧餘弦法以存弧餘弦
加減半徑折半為初數(視存弧不過象限則相加存弧過象限則相减)
又若角旁兩弧同數則無存弧而餘弦反大即用半
徑為存弧餘弦法以捴弧餘弦加减半徑折半為
初數(視捴弦過象限或過半周則相加捴弧在象限内或過三象限則相减)
以上用半徑為餘弦者六
凡加減取初數必用兩餘弦常法也然或搃弧適足
一象限或三象限或存弧適足一象限皆無餘弦
法即用一餘弦折半為初數不湏加減(搃弧無餘弦即單用存弧)
(餘弦存弧無餘弦即單用搃弧餘弦)
又或捴弧(適足象限或三象限)無餘弦而兩弧又同數(準前論即以半徑為存弧餘弦)
或存弧(適足象限)無餘弦而搃弧又適足半周(即以半徑為搃弧餘弦)
二者並以半徑之半為初數不湏加减
以上無加减者六
一兩矢較變例
凡兩矢相較常法也然或其弧滿象限則即以半徑
為矢(對弧滿象限則以半徑為對弧矢與存弧矢相較存弧滿象限亦然亦即以半徑與對弧矢相)
(較)捷法視對弧存弧但有一弧滿象限即命其又
一弧之餘弦為兩矢較不更求矢(對弧滿象限即用存弧餘弦存弧滿)
(象限即用對弧餘弦並即命為兩矢較與上法同)
凡以矢較加存弧矢成對弧矢(正矢則對弧小大矢則對弧大)常法
也然或有相加後適足半徑者其對弧必適足象限
又有四率中無兩矢較者以無存弧矢故也(凖前論角旁兩)
(弧同度無存弧則亦無存弧矢之可較)法即以對弧矢為用不必更求
矢較若角求對邊其所得第四率即對弧矢若三
邊求角其所用苐三率亦對弧矢(餘詳後例)
設角旁兩弧同度總弧在象限以内求對角之邊丙
乙丁形
乙角一百一十度餘弦三四二二乙丙乙丁
並三十度
兩餘弦相減五丙庚
半之為初數二五丙癸
一半徑寅已一
二初數丙癸二五
三(乙角大矢)寅午一三四二二
四(對弧矢)丙甲三三五五(四率本為兩矢較因無存弧矢故即為對弧之矢)
(對弧餘弦)甲巳六六四五
求到對弧丁丙四十八度二十二分
論曰以半徑為存弧餘弦何也弧大者餘弦小弧小者
餘弦大今存弧既相減而至于無則小之至也故其餘
弦亦大之至而成半徑也四率即為對弧矢何也弧
大矢亦大弧小矢亦小既無存弧則亦無矢矣無矢則
無可較故四率即對弧矢也然則其比例奈何曰半
徑寅已與大矢寅午若正弦子丙與距等大矢丁丙亦
即若初數丙癸與對弧矢丙甲
若三邊求角則反其率
一初數二半徑三對弧矢四乙角矢
若捴弧過三象限其法亦同
前圖丁丑丙形
丑角同乙角
其所用四率以得對弧丁丙並同上法
若三邊求角則反其率
一初數二半徑三對弧矢四丑角矢
一系兩邊同度無存弧矢則徑以對弧矢當兩矢較之用
設總弧滿半周而較弧亦過象限求對角之邊
前圖卯丑丁形
丑角七十度餘弦三四二二午已
丑丁一百五十度
丑卯三十度
相減五庚丙
初數二五庚癸
存弧大矢一五庚卯
丑角矢六五七九八午酉
一半徑酉巳一
二初數丙癸(即庚癸)二五
三丑角矢午酉六五七九八
四兩矢較庚甲一六四四九
加存弧大矢庚卯一五
得對弧大矢甲卯一六六四四九
求到對弧卯丁一百三十一度三十八分
設三小邊同數
求角
丙乙丁形
三邊並三十度
求乙角
相減五丙庚
初數二五丙癸
對弧(丁丙)三十度餘弦八六六三甲巳
矢一三三九七丙甲
一初數丙癸二五
二半徑寅己一
三對弧矢丙甲一三三九七
四乙角矢寅午五三五八八
餘弦午巳四六四一二
求到乙角六十二度二十分丁丙二角同
論曰此亦因存弧無矢故以對弧矢為三率也其比例
為初數丙癸與對弧矢丙甲若乙丙正弦丙辰與丙丁
距等矢則亦若寅巳半徑與乙角矢寅午
一系凡三邊等者三角亦等
前圖丁丑丙形二大邊同度一小邊為大邊減半周之餘
三邊求角
其對弧丁丙亦三十度所用四率並同上法所得丑角
六十二度二十分亦同乙角惟餘兩角(丁丙)並一百一十
七度四十分皆為丑角減半周之餘
若先有角求對邊則反其率
又于前圖取丁丑戊形
丑丁一百五十度
丑戊三十度
其對弧戊丁(一百五十度)為丑戊(三十度)減半周之餘故所用四率亦
同但所得矢度為丑外角之矢當以其度減半周得丑角
(一百一十七度四十分)戊角同丑角丁角(六十二度二十分)即丑外角
一系凡二邊同度其餘一邊又為減半周之餘與三邊同
度者同法但知一角即知餘角其一角不同者亦為相同兩角
之外角
設角旁兩弧同數而捴弧適
足一象限求對角之邊
子乙丙形
乙角一百度餘弦一七
三六五
初數五丙辛(即半徑之半)
一半徑壬巳一
二初數丙辛五
三乙角大矢壬丑一一七三六五
四對弧矢丙癸五八六八二
餘弦癸巳四一三一八
求到對弧子丙六十五度三十六分
論曰半半徑為初數何也凖前論半徑即存弧餘弦而
捴弧無餘弦無可相減故即半之為初數問捴弧何
以無餘弦曰弧大者餘弦小捴弧滿象限則大之極也
故無餘弦其比例可得言乎曰壬巳與壬丑若丙甲
與丙子則亦若丙辛與丙癸若所設為子戊丙形
戊角同乙角一百度
(戊子戊丙)同為一百三十五度捴二百七十度(滿三象限)亦
無餘弦亦如上法以半半徑為初數依上四率求到對
戊角之子丙弧六十五度三十六分
若三邊求角則反其率
一初數二半徑三對弧矢四角之矢
設角旁兩弧之捴滿半周而存弧亦滿象限求對角
之弧用前圖子戊卯形
戊角八十度餘弦一七三六五
子戊一百三十五度
卯戊四十五度
餘弦無減半半徑為初數五己辛即庚甲
存弧滿象限半徑為正矢一即卯巳半徑
一半徑辰巳一
二初數己辛五
三戊角矢辰丑八二六三五
四兩矢較己癸四一三一七即對弧卯子餘弦
對弧大矢卯癸一四一三一七(以兩矢較加存弧矢得對弧大矢)
求到對弧卯子一百一十四度二十四分
論曰捴弧以半徑為餘弦何也凡過弧大者餘弦大過
弧滿半周則大之至也故其餘弦亦最大而即為半徑
也然則存弧又能以半徑為矢何也弧大者矢大存
弧既滿象限故其矢亦滿半徑矣
問兩矢較巳癸即對弧之餘弦也何以又得為兩矢較
曰他存弧之矢有大小而不得正為半徑故其與對弧
矢相較亦有大小而不得正為餘弦今矢既為半徑較
必餘弦矣
若三邊求角則反其率
一初數巳辛其比例為巳辛與巳癸若丁甲
二半徑辰巳與丁子則亦若辰巳與辰丑
三兩矢較己癸
四戊角矢辰丑
設對弧滿象限三邊求角
乙丙甲形
對弧乙甲九十度無餘弦
求丙角
相加辰癸一三五六二一
初數午癸六七八一
對弧滿象限矢即半徑已甲一
用捷法即以存弧餘弦癸已為矢較
一初數午癸六七八一
二半徑巳戊一
三矢較巳癸四二二六二即存弧餘弦
四丙角矢庚戊六二九四
求到丙角六十八度一十四分
其比例為初數午癸與餘弦巳癸若正弦壬辛與距等
矢乙辛也亦必若半徑己戊與角之矢庚戊
若先有丙角求對弧則反其率
一半徑(戊巳)二初數(午癸)三丙角矢(戊庚)四兩矢較(巳癸)
以所得四率與存弧矢甲癸(五七七三八)相加適足半徑(成巳甲)命
對弧乙甲適足九十度捷法視所得四率矢較與
存弧餘弦同數即知對弧為象限不必更問存弧之矢
設角旁兩弧同數捴弧過象限
求對角之弧
辛乙丙形
乙角七十三度餘弦二九二三七
相加折半為初數八二一三九癸丙
一半徑己戊一
二初數癸丙八二一三九
三乙角矢甲戊七七六三
四對弧矢丁丙五八一二四
餘弦丁巳四一八七六
求到對弧辛丙六十五度一十五分
若三邊求角則反其率
一初數(癸丙)二半徑(巳戊)三對弧矢(丁丙)四乙角矢(甲戊)
設角旁弧同數捴弧過半周其算並同
前圖辛丑丙形
辛丑丙丑並一百十五度
捴弧丙丑壬二百三十度餘弦六四二七九庚巳
丑角同乙角
其所用四率求對弧及三邊求角並如上法
設捴弧滿半周而存弧不過象限求對弧
前圖辛乙卯形
乙角一百七度餘弦二九二三七甲巳
乙卯一百十五度
乙辛六十五度
相加半之為初數八二一三九癸庚即子辰
一半徑寅巳一
二初數庚癸八二三一九
三乙角大矢寅甲一二九二三七
四兩矢較庚丁一六一五三即辛未
加存弧正矢庚卯三五七二一
得對弧大矢丁卯一四一八七四
求到對弧卯辛一百一十四度四十五分
加减又法(解恒星曆指第四題三率法與加減捷法同理)
弧三角有一角及角旁二邊求對角之弧
法曰以角旁大弧之餘度與小弧相加求其止弦為先
得弦次以角旁兩弧相加視其度若適足九十度即
半先得弦為次得弦(此大弧之餘弧與小弧等)
若角旁兩弧捴大于象限(此大弧之餘弧小于小弧)則以大弧之餘
弧減小弧而求其弦以加先得弦然後半之為次得弦
若兩弧捴不及象限(此大弧之餘弧大于小弧)則以小弧減大弧之
餘弧而求其弦以減先得弦然後半之為次得弦
又以角之矢為後得弦
以後得弦乘次得弦為實半徑為法除之得數為他弦
一率全數
二率次得弦(即初數)
三率後得弦(即角之矢)
四率他弦(即兩矢較)
並以他弦與先得弦相減為所求對角弧之餘弦若他
弦大于先得弦即以先得弦減他弦(不問何弦但以小減大)
(右法不載測量全義而附見歷指人自江南來得小兒以燕家信以此為問謂與環中黍尺有合也乃為摘錄以疏其義)
論曰此亦加減代乘除之一種也加減法以捴弧存弧
之餘弦相加減以取初數此則不用存弧而用存弧之
餘度(以餘度取正弦即存弧之餘弦故也)又不正用存弧之餘度而用大
弧之餘度(以大弧之餘度加小弧即存弧之餘度故也)至其加減又不用捴
弧而用大弧餘度與小弧相減之較弧(以此較弧之正弦即捴弧之餘)
(弦故也)取徑迂迴而理數脗合非兩法相提並論不足以
明其立法之意也舉例如後
乙丙丁形(有乙角及角旁二邊)求對弧丁丙(以加減捷法求得諸數與恒星歷指法相參論之)
(乙丙小弧乙丁大弧)正弦(甲丙辰庚)
(捴存)弧(戊丙庚丙)餘弦(壬巳癸巳)
(餘弦并癸壬初數癸甲)(即辰寅)
(丁丙對弦庚丙存弧)正矢(卯丙癸丙)
(一)(半兩矢較卯癸徑酉巳)
(二三)(角之矢初數)(酉午即辰寅甲癸)
(四末兩矢較加癸卯癸卯即丁子以卯癸丙得丙為對)
(弧矢乃查其度得對弧丁丙)
右加減法也
今改用恒星歷指之法先以酉庚為角旁大弧(乙丁)之
餘弧(乙庚同乙丁大弧度也乙酉同乙午皆象限也乙酉象限内減乙庚猶之乙午内減乙丁也故庚酉)
(即乙丁之餘)又以牛酉當角旁小弧乙丙(乙酉與牛丙皆象限内減同用之丙)
(酉同乙丙)二者相加成牛庚取其正弦戊庚是為先得弦
次視角旁兩弧(乙丙乙丁)之捴(丙戊)大于象限(丙辛)法當以大弧
餘度去減小弧得較(于同小弧之午酉内減同大弧餘度之氐酉其較牛氐與牛房等)
而取其弦(牛氐較與牛房等則氐井弦與房井等而即與危戍等是危戌即牛氐較之弦也)以
加先得弦(以危戍加戌庚成危庚)然後半之(危庚半之于未成未庚)為次得
弦
又以乙角之矢(午酉)為後得弦與次得弦(未庚)相乘為實半
徑為法除之得他弦(亥庚)
未以他弦(亥庚)减先得弦(戌庚)其餘亥戌為對弧(丁丙)之餘弦
(查表得對弧)
論曰牛庚之正弦戍庚與癸巳平行而等即存弧之餘
弦也(牛庚為小弧與大弧餘度之并實即存弧丙庚之餘度故戌庚即同癸巳)次得弦未庚
與甲癸平行而等即初數也(以危戍加戌庚而成危庚猶捴存兩餘弦相加成癸壬也)
(危庚既同癸壬則其半未庚亦同甲癸)他弦庚亥與卯癸平行而等即兩
矢較也末以他弦與先得弦相減而得對弧餘弦猶以
兩矢較與存弧之矢相加而得對弧之矢也(兩矢較即兩餘弦較)
(也故加之得矢者减之即得餘弦)然則此兩法者固異名而同實矣
又論曰加減本法用大弧小弧之捴與較取其餘弦以
相加減今此法則用大弧餘度與小弧之捴與較而
取其正弦以相加減(如牛庚是大弧餘度與小弧之捴牛氐是大弧餘度與小弧之)
(較)用若相反而得數並同者何也曰餘弧與正弧
互為消長其數相待是故大弧之餘度大于小弧
則捴弧不及象限矣大弧之餘度小于小弧則捴弧過
象限矣捴弧過象限宜相加此條是也捴弧不及象
限宜相減後條是也宜加宜減之數無一不同得數
安得而不同(得數謂初數也在此法則為次得弦)
又論曰此法之于加減法猶甲數乙數之于初數次數
也初數次數用餘弦甲數乙數用正弦加減法用餘弦
此法用正弦所以然者皆以角旁之弧半用餘度也(甲數)
(乙數法内一弧用本度一弧用餘度此法小弧用本度大弧用餘度)一加減法乃有四用
其省乘除並同而繁簡殊矣
乙丙丁形
有乙角及角旁二邊
求對弧丁丙
(乙丙小弧乙丁大弧)正弦(申丙辰庚)
(捴存)弧(戊丙庚丙)餘弦(壬巳癸巳)
(餘弦較壬癸初數癸甲)
(丁丙對弧庚丙存弧)正矢(卯丙癸丙)
(一)(兩矢較卯癸半徑酉巳)
(二三)(角大矢初數)(酉午甲癸)
(四)(兩矢較)(卯癸)
(末以卯癸加癸丙成卯丙為對弧矢查其餘弦得對弧丁丙)
右加減法也
今依恒星法改用大弧之餘度(庚酉即午丁)與小弧(牛酉即乙丙)
相加(成牛庚即存弧丙庚之餘度)求其正弦為先得弦(戍庚同巳癸即存弧之餘)
(弦)次視兩弧之捴(戊丙)不及象限法當以小弧減大弧餘
度(取氐酉如酉庚以牛酉減之)得較(氐牛與牛房等)取其正弦(女房即女氐亦即戍危)
以減先得弦(戍危減戌庚餘危庚與癸壬等)然後半之(危庚半之于虚成庚虚與甲癸)
(等)為次得弦又以(乙)鈍角大矢(午酉)為後得弦與次得弦
相乘為實半徑為法除之得他弦(亢庚與卯癸等)末以他弦(亢庚)
減先得弦(戍庚)其餘戍亢(即卯巳)為對弧餘弦查表得對弧
丁丙
一率半徑酉巳
二率次得弦庚虚(即初數甲癸)
三率後得弦午酉(即角大矢)
四率他弦亢庚(即兩矢較卯癸)
乙丙丁形(有丙角及角旁二邊)求對弧丁乙
法以(丁丙)大弧之餘(午丁即酉甲)與小弧(乙丙即戊酉)相加(成甲戊)求
其正弦(庚甲)為先得弦次視兩弧
之總(丑乙)適足象限即半先得弦
為次得弦(癸甲或癸庚)又以角之大矢(午酉)為
後得弦乘之(午酉乘癸甲)半徑(酉巳)除之
得他弦(卯甲即壬未)以減先得弦(甲庚)得
對弧餘弦(卯庚即壬巳)查表度得對弧(丁乙)
解曰此因大弧之餘酉甲與小弧戊酉同數則無加
減故即半先得弦為次得弦也在加減法則為總弧無
餘弦而即半存弧餘弦為初數
丙戊丁形(有戊角及角旁二邊)求對弧丁丙
如法以大邊(丙戊)之餘(卯丙即癸庚)
與小弧(丁戊即癸辛)相加(成辛庚)取
其正弦(庚乙)為先得弦次眎角
旁兩弧之捴(辰丁)大于象限法
當以癸庚減癸辛得較子辛
(即辛井)而取其正弦(子斗即井斗亦即乙)
(甲)以加先得弦(乙庚)而半之(甲庚之半為甲丑)為次得弦又以角
之大矢(卯癸)為後得弦以乘次得弦為實半徑為法除之
得他弦(牛庚)末以他弦(牛庚)與先得弦(庚乙)相減得(牛乙即壬巳)為
對弧之餘弦查餘弦度以減半周得對弧丁丙
解曰此為他弦大于先得弦故反減也在加減法則所
得為對弧大矢與存弧小矢之較而兩矢較即兩餘弦
并也故減存弧餘弦得對弧餘弦
補求經度法
法用角旁兩弧(大弧用餘度小弧用本度)相加得數取正弦為先得
弦又相減得較取正弦以與先得弦相加減(角旁兩弧大于象限)
(則相加若小于象限則相減)而半之為次得弦(若角旁兩弧并之適足一象限則徑以先)
(得弦半之為次得弦不須加減)用為首率次以對角弧之餘弦與先
得弦相加減得他弦為次率(對弧大于象限相加小于象限則相減)半
徑為三率求得角之矢為四率(正矢為銳角大矢為鈍角)
假如丙戊丁形有三邊求戊角(借用前圖)
一次得弦甲丑(乃先得弦甲庚之半)即庚丑
二他弦壬酉(即牛庚乃對弧餘弦加先得弦因對弧大故相加)
三半徑巳癸
四鈍角大矢卯癸(卯癸大矢内減巳癸半徑為餘弦查表得度以減半同為戊鈍角之度)
論曰角求對邊者求緯度也三邊求角者求經度也二
者之分祗在四率中互換無他繆巧歷指注云求緯用
正弦求經用切線殊不可曉及查其後條用例亦無用
切綫之法殆有缺誤歷書中如此者甚多故在善讀耳
加減通法
加減代乘除之法以算三邊求角及二邊一角求對
角之邊皆斜弧三角之難者也其算最難而其法益
簡故凡算例中兩正弦相乘者即可以加減代之則
雖正弧諸法實多所通故謂之通法
法曰凡四率中有以兩正弦相乘為實半徑為法者皆
可以初數取之有以兩餘弦相乘為實半徑為法者
皆可以次數取之有以餘弦與正弦相乘為實半徑
為法者皆可以甲乙數取之
假如正弧形有角有角旁弧而求對角之弧(此如有春分角有黃)
(道而求距度)本法當以角之正弦與角旁弧之正弦相乘為
實半徑為法除之也今以初數取之即命為所求度正
弦
設黃道三十度求黃赤距度
(春分角二十三度三十一分半黃道三十度)
(捴弧存弧)(五十三度三十一分半六度二十八分半)餘弦(五九四四七九九三六二)
用初數為正弦檢表得度(相减三九九一五即初數折半一九九五七)
求到黃赤距度一十一度三十分四十二秒
又設黃道七十五度求黃赤距度
(春分角二十三度三十一分半黃道七十五度)
(捴存)弧(九十八度三十一分半五十一度二十八分半)餘弦(一四八二四六二二八五)
用初數為正弦檢表得度(相加七七一九折半三八五五四)
求到黃赤距度二十二度四十分三十九秒
又如句股方錐法有大距有黃道而求距緯本以大距
正弦黃道餘弦相乘半徑除之也今以甲數取之
設黃道六十度求距緯(句股方錐黃道以距二至起算下同)
(黃赤大距二十三度三十一分半黃道六十度)
(捴弧存弧)(八十三度三十一分半三十六度二十八分半)正弦(九九三六二五五四四七)
用甲數為正弦檢表得度(相减三九九一五為甲數半之一九九五七)
求到距緯一十一度三十分四十二秒
設黃道一十五度求距緯
(黃赤大距二十三度三十一分半黃道一十五度)
(捴存)弧(三十八度三十一分半八度三十一分半)正弦(六二二八五一四八二四)
用甲數為正弦查表得度(相加七七一九為甲數半之三八五五四)
求得距緯二十二度四十分三十九秒
又如次形法本以一正弦與一餘弦相乘半徑除之得
所求之餘弦今以初數取之
設甲丙乙形有甲正角有丙角及甲丙邊
而求乙角本法為半徑與丙角正弦若甲
丙餘弦與乙角餘弦今以初數即命為乙
角餘弦(丙角度度甲丙餘)相(并減)為(捴存)弧各取其
餘弦如法相加減而半之成初數即命為乙角餘弦
本法用正弦與餘弦相乘而亦以初數取之何也曰甲
丙餘弦實次形丁丙正弦也故仍用初數
假如斜弧形作垂弧法本為半徑與角之正弦若角旁
弧之正弦與垂弧之正弦也今以初數即命為垂弧正弦
設丁乙丙形有乙銳角有丁乙邊求作丁甲
垂弧(乙角度乙丁弧)相(并減)為(捴存)弧而取其餘弦
如法相加減而半之成初數即命為丁甲垂
弧正弦
設丁乙丙形乙為鈍角而先有丁乙邊其
法亦同(乙外角丁乙邊)相(并減)為(捴存)弧而各取其
餘弦如上法取初數命為甲丁垂弧正弦
又如弧角比例法本為角之正弦與對角邊之正弦若
又一角之正弦與其對邊之正弦今以初數進五位即
為兩正弦相乘之實可以省乘
設乙甲丙形有丙角甲角有乙甲邊求乙丙邊本以甲角
正弦與乙甲正弦相乘為實丙角正弦為
法除之得乙丙正弦今以甲角度與乙甲
弧相并減為捴存弧如法取初數進五位
為實以丙角正弦除之亦得乙丙正弦(若有)
(乙丙邊求丙角則以乙丙邊正弦為法除之即得丙角之正弦)
又如垂弧捷法本以兩餘弦相乘為實又以餘弦為法
除之而得所求之餘弦今以次數進五位為兩餘弦相
乘之實即可省乘
設甲丁亥鈍角形有亥甲邊有亥丁邊有引長之丁巳
邊而求甲丁邊本法為亥巳邊之餘弦與亥甲邊之餘
弦若丁巳邊之餘弦與甲丁邊之餘弦也今以次數
代乘
(亥甲丁巳)二弧相并為捴弧相減為存弧
而各取其餘弦如法相加減而半之
為次數下加五即同亥甲與丁巳
兩餘弦相乘之實但以亥巳邊之餘
弦為法除之即得甲丁邊之餘弦
進五何也曰初數者兩正弦相乘半徑除之之數故
必進五位即同兩正弦相乘之實矣次數進位之理
倣此論之
補加減捷法
設壬丙甲弧三角形
甲壬邊適足九十度丙甲邊八十三度對弧壬
丙五十九度
求甲角
法曰角旁有一邊
適足九十度則總
存兩餘弦同數當
以餘弦即命為初
數依法求得五
十八度四十四分
為甲角
存矢申丙七四五
矢較戊申四七七五一
一初數九九二五五已申
二矢較四七七五一戊申
三半徑一己癸查表得五十八度四十四分
四(角之矢)四八一九壬癸
餘弦五一八九一壬巳
論曰此即算帶食法也凡算帶食其差角必在地平壬
甲九十度即高弧全數丙甲八十三度月距北極也癸
丙七度黃赤距度也壬丙對弧極距天頂也其餘弦己
戊即極出地正弦所求甲角月出地平時地經赤道差
也
捷法以黃赤距度餘弦與極出地正弦相減餘進五位
為實仍以距度餘弦除之得差角矢
解捷法曰極出地正弦即對弧餘弦黃赤距度餘弦即
存弧餘弦兩餘弦之較即矢較也
又解曰巳乙即己申亦即未丙並小弧甲丙正弦也(即存)
(弧癸丙之餘弦)未丙與戌丙若己癸與壬癸全與分之比例也
又解曰初數是兩正弦相乘半徑除之之數今甲壬邊
之正弦即半徑故省乘除竟以甲丙正弦為初數
又設壬甲辛鈍角形(即用前圖)壬甲邊適足九十度辛
甲邊九十七度對邊辛壬一百二十一度求甲角
依法求得甲鈍角一百二十一度一十六分
對弧辛壬一百卄一度餘弦巳戊五一五四
對弧大矢戊辛一五一五四
存弧矢癸乙同酉辛七四五(亦同丁庚)
兩矢較戊酉同辰辛一五七五九(亦同丁壬)
一初數(丁巳同午辛)九九二五五
二矢較(丁壬同辰辛)一五七五九
三半徑己庚一
四角大矢壬庚一五一八九
餘弦己壬五一八九
查表得五十八度四十四分以去減半周得甲角一
百二十一度一十六分
論曰總弧過象限及過半周宜以餘弦相加折半成初
數今兩餘弦相同而徑用為初數亦折半之理也
嚮作加減法補遺自謂巳盡其變不知仍有此法故特
記之
因算帶食得此其用捷法更竒甚矣學問之無窮也
壬甲丙銳角形壬甲邊適足九十度丙甲邊六十七度
對弧壬丙五十度求甲角
依法求得甲角四十五度四十二分
五(即為初數)
壬丙對弧五十度餘弦六
四二七九巳戊
對弧矢三五七二一戊丙
存弧矢七九五乙癸(即申丙)
矢較二七七七一申戊
一初數九二五申巳
二矢較二七七一申戊
三半徑一己癸
四角之矢三一六九壬癸
餘弦六九八三一壬巳
查表得四十五度四十二分
因前圖丙癸度小故復作此以明之
算甲餘角
又於本圖取辛甲壬鈍角形壬甲九十度辛甲一
百一十三度壬丙五十度求甲鈍角依法求到
甲鈍角度一百三十四度一十八分
壬辛對弧一百三十度餘弦巳戊六四二七九
大矢辛戊一六四二七九
存弧矢申丙(即乙癸)七九五(亦即酉辛)
矢較酉戊一五六三二九
一初數九二五酉巳(即丁巳)二矢較一五(六三二九)酉戊
三半徑一庚巳四(角大矢)一六(九八三)庚壬
餘弦六九(八三)
查表得四十五度四十二分以減半周得甲鈍角一
百三十四度一十八分
論曰試作庚亥線與辛丙徑平行又引對弧坎戊正弦
至亥成庚亥壬句股形即庚乾巳亦同角之小句股形
而庚亥同酉戊兩矢較也庚乾同酉巳初數也則初數
(庚乾小股)與兩矢較(庚亥大股)若半徑(庚巳小弦)與角之大矢(庚壬大弦)
凡角旁弧適足九十度則總存兩餘弧同數法即以餘
弦命為初數
日月食帶食出入地平用此算其地經赤道差甚捷
補甲數乙數法
丁辛乙斜弧三角形
辛丁弧五十度一十分辛乙弧八十度丁乙
對弧六十度又若辛乙弧八十度
求辛角辛丁(餘弧)三十九度(五十)分
辛乙(餘弧)一十度總弧一百十九度(五十)分
辛丁弧五十度一十分較弧四十度一十分
兩正弦總(一五一二四九)半之為甲數(七五六二四)
兩正弦較(二二二四七)半之為乙數(一一一二三)
丁乙對弧餘弦(五)内減乙數餘(三八)
(八七七)為二率
一甲數七五六二四
二三八八七七
三半徑一
四(辛角餘弦)五一四八
查表得五十九度四分為辛角
若前形有辛角而求丁乙對弧
一半徑一
二(辛角餘弦)五一四八
三甲數七五六二四
四三八八七七
以加乙數一一一二三
成對弧餘弦五
查表得六十度
此因角旁餘弧小於正弧故乙數亦小於甲數而以所
得四率加乙數為對弧餘弦
丙乙丁形乙鈍角一百一十度(乙丙乙丁)二弧並三十度
求丁丙對弧
乙丙餘弧六十度
乙丁弧三十度
總弧九十度正弦一
較弧三十度正弦五
相加一五
半之為乙數七五
相減五
半之為甲數二五
一半徑一
二(乙角餘弦)三四二二
三甲數二五
四八五五
以減乙數七五
得對弧餘弦六六四五
查表得四十八度二十一分
此因角旁乙丙餘弧大於乙丁正弧故乙數大於甲數
而以所得四率反減乙數為對弧餘弦
前例轉求乙鈍角(乙丙乙丁)二弧並三十度丁丙對
弧四十八度二十一分
求乙角
一甲數二五二(對弧餘弦减乙數之餘)八五五
三半徑一四鈍角餘弦三四二二
查表得七十度以減半周得一百一十度為乙角
總論曰甲數乙數原以角旁兩弧之正弦錯乘而得今
改用加減故角旁兩弧一用正一用餘然有時餘弧大
於正弧者角旁兩弧之合數必過象限也有時餘弧小
於正弧者角旁兩弧之合必不及象限也若角旁兩弧
之合適足象限則餘弧必與正弧等而無較弧
又設子乙丙形乙鈍角一百度(乙丙乙子)二弧並四十
五度
求對角
乙丙餘弧四十五度
乙子弧四十五度
(半之為甲數)五則無可加亦
(亦為乙數)五無可減故皆
用總弧正弦
折半為甲數
亦為乙數
一半徑一
二(鈍角餘弦)一七三六五
三甲數五
四八六八二
加乙數共五八六八二(命為對弧矢)
得對弧(餘弦)四一三一八
查表得對弧子丙六十五度三十六分
若前例三邊求乙角
乃置對弧六十五度三十六分之餘弦四一三一八
求其矢得五八六八二
丙減乙數五
仍餘八六八二為二率
一甲數五
二八六八二
三半徑一
四(鈍角餘弦)一七三六四
查表得八十度以減半周得一百度為乙角之度
補先數後數法
前式丙乙丁形乙角一百一十度(乙丙乙丁)並三十度
求丁丙對弧
一半徑方一
二正弦方二五
三乙角(大矢)一三四二二
四兩矢較三三五五
對弧餘弦六六四五
查表亦得四十八度二十一分
此因角旁兩弧同度則無較弧之矢故徑以所得矢較
命為對弧之矢
前式子乙丙形乙角一百度(乙丙乙子)二弧並四十五度
求對弧
一半徑方一
二正弦方五
三角大矢一一七三六五
四矢較五八六八二(因無較弧矢故即為對弧矢)
對弧餘弦四一三一八
查表亦得對弧子丙六十五度三十六分
若先有對弧子丙而求乙角
一正弦方五
二半徑方一
三對弧矢五八六八二(因無較弧矢故即以對弧矢為矢較)
四角大矢一一七三六五
餘弦一七三六五
查表得八十度以減半周得乙鈍角一百度
又設乙角六十度
角旁(乙丙乙子)二弧並四十五度求子丙對弧
一半徑方一
二正弦方五
三銳角矢五
四矢較二五(無較弧即用為對弧矢)
對弧餘弦七五
查表得對弧五十三度八分
歷算全書卷十一
